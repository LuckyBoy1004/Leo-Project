{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bc/Desktop/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/bc/Desktop/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/bc/Desktop/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/bc/Desktop/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import{useFirebase}from\"../../../assets/base-context\";import ShowEvent from'./ShowEvent';import{Table}from'../Table';export var Events=function Events(){var firebaseContext=useFirebase();var firestore=firebaseContext.firestore();var refEvents=firestore.collection(\"events\");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),events=_useState2[0],setEvents=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(\"list\"),_useState6=_slicedToArray(_useState5,2),step=_useState6[0],setStep=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),currentEvent=_useState8[0],setCurrentEvent=_useState8[1];useEffect(function(){getData().then(function(){setLoading(false);});},[step]);function getData(){return _getData.apply(this,arguments);}function _getData(){_getData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var query,results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return refEvents.get();case 2:query=_context.sent;results=[];query.forEach(function(doc){// Cette variable nous permet d'attendre que les data soit chargées avant de continuer, car on avait un souci avec la date\nvar data=doc.data();var timstamp=data&&data.date&&data.date.toDate();results.push(_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id,date:timstamp.toLocaleDateString(\"fr-FR\",{year:\"numeric\",month:\"numeric\",day:\"numeric\"}),action:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setStep(\"show\"),setCurrentEvent(doc.id);},children:\"Voir\"})}));});setEvents(results);case 6:case\"end\":return _context.stop();}}},_callee);}));return _getData.apply(this,arguments);}function handleDeleteEvent(){return _handleDeleteEvent.apply(this,arguments);}function _handleDeleteEvent(){_handleDeleteEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return refEvents.doc(currentEvent).delete().then(function(){setStep(\"list\");});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _handleDeleteEvent.apply(this,arguments);}return!loading&&/*#__PURE__*/_jsx(\"div\",{title:\"Liste des events\",children:step===\"list\"?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Table,{data:events,type:\"events\"})}):step===\"show\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setStep(\"list\");},className:\"buttonAdminTransparent\",children:\"Revenir \\xE0 la liste des \\xE9v\\xE8nements\"}),/*#__PURE__*/_jsx(ShowEvent,{handleDeleteEvent:handleDeleteEvent,currentEvent:currentEvent})]})});};","map":{"version":3,"sources":["/Users/bc/Desktop/Nivid/src/components/Admin/event/Events.js"],"names":["React","useEffect","useState","useFirebase","ShowEvent","Table","Events","firebaseContext","firestore","refEvents","collection","events","setEvents","loading","setLoading","step","setStep","currentEvent","setCurrentEvent","getData","then","get","query","results","forEach","doc","data","timstamp","date","toDate","push","id","toLocaleDateString","year","month","day","action","handleDeleteEvent","delete"],"mappings":"4oBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,WAAT,KAA4B,8BAA5B,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,OAASC,KAAT,KAAsB,UAAtB,CAEA,MAAO,IAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CAExB,GAAMC,CAAAA,eAAe,CAAGJ,WAAW,EAAnC,CACA,GAAMK,CAAAA,SAAS,CAAGD,eAAe,CAACC,SAAhB,EAAlB,CAGA,GAAMC,CAAAA,SAAS,CAAGD,SAAS,CAACE,UAAV,CAAqB,QAArB,CAAlB,CANwB,cAOIR,QAAQ,CAAC,EAAD,CAPZ,wCAOjBS,MAPiB,eAOTC,SAPS,8BAQMV,QAAQ,CAAC,IAAD,CARd,yCAQjBW,OARiB,eAQRC,UARQ,8BASAZ,QAAQ,CAAC,MAAD,CATR,yCASjBa,IATiB,eASXC,OATW,8BAUgBd,QAAQ,CAAC,EAAD,CAVxB,yCAUjBe,YAViB,eAUHC,eAVG,eAYxBjB,SAAS,CAAC,UAAM,CACZkB,OAAO,GAAGC,IAAV,CAAe,UAAM,CACjBN,UAAU,CAAC,KAAD,CAAV,CACH,CAFD,EAGH,CAJQ,CAIN,CAACC,IAAD,CAJM,CAAT,CAZwB,QAkBTI,CAAAA,OAlBS,+HAkBxB,2KACwBV,CAAAA,SAAS,CAACY,GAAV,EADxB,QACUC,KADV,eAEUC,OAFV,CAEoB,EAFpB,CAIID,KAAK,CAACE,OAAN,CAAc,SAAAC,GAAG,CAAI,CACjB;AACA,GAAMC,CAAAA,IAAI,CAAGD,GAAG,CAACC,IAAJ,EAAb,CACA,GAAMC,CAAAA,QAAQ,CAAID,IAAI,EAAIA,IAAI,CAACE,IAAd,EAAuBF,IAAI,CAACE,IAAL,CAAUC,MAAV,EAAxC,CACAN,OAAO,CAACO,IAAR,gCACOL,GAAG,CAACC,IAAJ,EADP,MAEIK,EAAE,CAAEN,GAAG,CAACM,EAFZ,CAGIH,IAAI,CAAED,QAAQ,CAACK,kBAAT,CAA4B,OAA5B,CAAqC,CAAEC,IAAI,CAAE,SAAR,CAAmBC,KAAK,CAAE,SAA1B,CAAqCC,GAAG,CAAE,SAA1C,CAArC,CAHV,CAIIC,MAAM,cAAE,eAAQ,OAAO,CAAE,yBAAOpB,CAAAA,OAAO,CAAC,MAAD,CAAP,CAAiBE,eAAe,CAACO,GAAG,CAACM,EAAL,CAAvC,EAAjB,kBAJZ,IAKH,CATD,EAUAnB,SAAS,CAACW,OAAD,CAAT,CAdJ,sDAlBwB,kDAmCTc,CAAAA,iBAnCS,6JAmCxB,+JACU5B,CAAAA,SAAS,CAACgB,GAAV,CAAcR,YAAd,EAA4BqB,MAA5B,GAAqClB,IAArC,CAA0C,UAAM,CAClDJ,OAAO,CAAC,MAAD,CAAP,CACH,CAFK,CADV,yDAnCwB,oDA0CxB,MAAO,CAACH,OAAD,eACH,YAAK,KAAK,CAAC,kBAAX,UAEQE,IAAI,GAAK,MAAT,cACI,kCACI,KAAC,KAAD,EAAO,IAAI,CAAEJ,MAAb,CAAqB,IAAI,CAAC,QAA1B,EADJ,EADJ,CAIMI,IAAI,GAAK,MAAT,eACE,oCACA,eAAQ,OAAO,CAAE,yBAAMC,CAAAA,OAAO,CAAC,MAAD,CAAb,EAAjB,CAAwC,SAAS,CAAC,wBAAlD,wDADA,cAEI,KAAC,SAAD,EAAW,iBAAiB,CAAEqB,iBAA9B,CAAiD,YAAY,CAAEpB,YAA/D,EAFJ,GAPhB,EADJ,CAeH,CAzDM","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useFirebase } from \"../../../assets/base-context\";\r\nimport ShowEvent from './ShowEvent'\r\nimport { Table } from '../Table'\r\n\r\nexport const Events = () => {\r\n\r\n    const firebaseContext = useFirebase()\r\n    const firestore = firebaseContext.firestore()\r\n\r\n\r\n    const refEvents = firestore.collection(\"events\");\r\n    const [events, setEvents] = useState([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [step, setStep] = useState(\"list\")\r\n    const [currentEvent, setCurrentEvent] = useState(\"\")\r\n\r\n    useEffect(() => {\r\n        getData().then(() => {\r\n            setLoading(false)\r\n        })\r\n    }, [step])\r\n\r\n    async function getData() {\r\n        const query = await refEvents.get();\r\n        const results = []\r\n\r\n        query.forEach(doc => {\r\n            // Cette variable nous permet d'attendre que les data soit chargées avant de continuer, car on avait un souci avec la date\r\n            const data = doc.data()\r\n            const timstamp = (data && data.date) && data.date.toDate()\r\n            results.push({  \r\n                ...doc.data(),\r\n                id: doc.id, \r\n                date: timstamp.toLocaleDateString(\"fr-FR\", { year: \"numeric\", month: \"numeric\", day: \"numeric\" }),  \r\n                action: <button onClick={() => (setStep(\"show\"), setCurrentEvent(doc.id))}>Voir</button> })\r\n        })\r\n        setEvents(results)\r\n    }\r\n    \r\n    async function handleDeleteEvent() {\r\n        await refEvents.doc(currentEvent).delete().then(() => {\r\n            setStep(\"list\")\r\n        })\r\n    }\r\n\r\n\r\n    return !loading && (\r\n        <div title=\"Liste des events\">\r\n            {\r\n                step === \"list\" ?\r\n                    <div>\r\n                        <Table data={events} type=\"events\" />\r\n                    </div>\r\n                    : step === \"show\" &&\r\n                        <div>\r\n                        <button onClick={() => setStep(\"list\")} className=\"buttonAdminTransparent\">Revenir à la liste des évènements</button>\r\n                            <ShowEvent handleDeleteEvent={handleDeleteEvent} currentEvent={currentEvent} />\r\n                        </div>\r\n            }\r\n        </div>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}