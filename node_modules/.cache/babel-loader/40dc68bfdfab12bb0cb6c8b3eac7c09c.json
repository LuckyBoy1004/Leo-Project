{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Home\\\\Desktop\\\\Boulot\\\\Nivid\\\\src\\\\pages\\\\Prest_Step4.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport \"../styles/Prest_.css\";\nimport { useHistory } from 'react-router-dom';\nimport { useAuth } from \"../context/userContext\"; // context\n\nimport { ButtonSmall, ButtonLarge } from '../components/utilities/Buttons';\nimport Layout from '../components/utilities/Layout';\nimport Title from '../components/utilities/Title';\nimport SubTitle from '../components/utilities/SubTitle';\nimport ReactLoading from 'react-loading';\nimport { FaCheckCircle } from 'react-icons/fa';\nimport { useFirebase } from \"../assets/base-context\";\nimport { CSSTransition } from 'react-transition-group';\n\nconst Prest_Step4 = () => {\n  _s();\n\n  const firebaseContext = useFirebase();\n  const auth = firebaseContext.auth();\n  const storage = firebaseContext.storage();\n  const initialDocuments = {\n    kbis: \"\",\n    ci: \"\",\n    assurance: \"\",\n    sepa: \"\",\n    rib: \"\"\n  };\n  const [error, setError] = useState({\n    type: \"\",\n    message: \"\"\n  });\n  const [buttonLoading, setButtonLoading] = useState(false);\n  const [documents, setDocuments] = useState(initialDocuments);\n  const [isMounted, setIsMounted] = useState(false);\n  const {\n    seller,\n    setCurrentStepProcess,\n    addSellerDocuments,\n    getSellerDocumentsFromDB,\n    setSellerStatus\n  } = useAuth(); // context\n\n  const history = useHistory();\n  seller.status !== \"subscribing\" && history.push('/mon-compte-partenaire');\n  setCurrentStepProcess(4);\n  useEffect(() => {\n    function getCurrentDocumentsFromDB() {\n      getSellerDocumentsFromDB().then(data => {\n        if (data === null) {\n          setDocuments(initialDocuments);\n        } else {\n          setDocuments(data);\n        }\n      });\n    }\n\n    getCurrentDocumentsFromDB();\n    setIsMounted(true);\n  }, []);\n\n  function handleInputChange(e, docType) {\n    const type = e.target.files[0].type;\n    const size = e.target.files[0].size;\n\n    if (type !== \"image/png\" && type !== \"image/jpeg\" && type !== \"image/jpg\") {\n      setError({\n        type: docType,\n        message: \"Votre fichier n'est ni une image jpeg, jpg ou PNG.\"\n      });\n    } else if (size > 2000000) {\n      setError({\n        type: docType,\n        message: \"Votre image fait plus de 2Mo.\"\n      });\n    } else {\n      e.target.files[0].docType = docType;\n      docType === \"sepa\" ? setDocuments({ ...documents,\n        sepa: e.target.files[0]\n      }) : docType === \"rib\" && setDocuments({ ...documents,\n        rib: e.target.files[0]\n      });\n      setError({\n        type: \"\",\n        message: \"\"\n      });\n    }\n  }\n\n  async function handleSendForm() {\n    setButtonLoading(true);\n\n    if (documents.rib.name) {\n      let documentsUrlArray = { ...documents\n      };\n\n      for (const doc in documents) {\n        if (documents[doc].lastModified) {\n          const token = `${documents[doc].docType}-${Math.random().toString(36).substr(2, 19)}`;\n          const url = await handleUploadFile(documents[doc], token);\n          documentsUrlArray[documents[doc].docType] = {\n            url: url,\n            token: token,\n            name: documents[doc].name\n          };\n        }\n      }\n\n      await addSellerDocuments(documentsUrlArray);\n      handleSendAll();\n    } else {\n      setError({\n        type: \"final\",\n        message: \"Pour finaliser votre inscription, le Rib est obligatoire.\"\n      });\n      setButtonLoading(false);\n    }\n  }\n\n  async function handleSendAll() {\n    if (seller.description && seller.description.length > 0) {\n      if (seller.image_path && seller.image_path.url && seller.image_path.url.length > 0) {\n        if (seller.services.length > 0) {\n          if (documents.kbis.name && documents.kbis.status !== \"rejected\") {\n            if (documents.ci.name && documents.ci.status !== \"rejected\") {\n              if (documents.assurance.name && documents.assurance.status !== \"rejected\") {\n                if (documents.rib.name && documents.rib.status !== \"rejected\") {\n                  await setSellerStatus(auth.currentUser.uid, \"pending\");\n                  history.push('/mon-compte-partenaire/confirmation');\n                } else {\n                  setError({\n                    type: \"final\",\n                    message: \"Pour finaliser votre inscription, le RIB est obligatoire.\"\n                  });\n                }\n              } else {\n                setError({\n                  type: \"final\",\n                  message: \"Pour finaliser votre inscription, l'assurance de responsabilité civile est obligatoire.\"\n                });\n              }\n            } else {\n              setError({\n                type: \"final\",\n                message: \"Pour finaliser votre inscription, la carte d'identité du gérant est obligatoire.\"\n              });\n            }\n          } else {\n            setError({\n              type: \"final\",\n              message: \"Pour finaliser votre inscription, le Kbis est obligatoire.\"\n            });\n          }\n        } else {\n          setError({\n            type: \"final\",\n            message: \"Pour finaliser votre inscription, vous devez avoir ajouté au moins 1 service.\"\n          });\n        }\n      } else {\n        setError({\n          type: \"final\",\n          message: \"Pour finaliser votre inscription, merci d'ajouter une photo principale pour votre boutique.\"\n        });\n      }\n    } else {\n      setError({\n        type: \"final\",\n        message: \"Pour finaliser votre inscription, vous devez renseigner une description de votre boutique, à l'étape Prestations\"\n      });\n    }\n\n    setButtonLoading(false);\n  }\n\n  function handleUploadFile(image, token) {\n    return new Promise((resolve, reject) => {\n      const upload = storage.ref(`sellers/${token}`).put(image);\n      upload.on(\"state_changed\", snapshot => {}, error => {\n        console.log(error);\n      }, () => {\n        storage.ref(\"sellers\").child(token).getDownloadURL().then(url => {\n          resolve(url);\n        }).catch(error => {\n          console.error(error);\n          reject(error);\n        });\n      });\n    });\n  }\n\n  function handleDownloadSEPA() {\n    const element = document.createElement(\"a\");\n    const file = new Blob([document.getElementById('inputDownload').value], {\n      type: 'text/plain;charset=utf-8'\n    });\n    element.href = URL.createObjectURL(file);\n    element.download = \"SEPA.txt\";\n    document.body.appendChild(element);\n    element.click();\n  }\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: /*#__PURE__*/_jsxDEV(CSSTransition, {\n      in: isMounted,\n      timeout: 300,\n      classNames: \"pageTransition\",\n      unmountOnExit: true,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"layoutDocumentPrest\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step4-Header\",\n          children: [/*#__PURE__*/_jsxDEV(SubTitle, {\n            value: \"V\\xE9rification documents\",\n            type: \"big\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Sur cette page vous allez devoir nous transmettre vos documents, pour que nous puissions v\\xE9rifier votre activit\\xE9.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Merci de bien v\\xE9rifier les documents que vous enverrez, il ne peut y avoir de modifications sur ces documents l\\xE0.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step4-Section1\",\n          children: [/*#__PURE__*/_jsxDEV(Title, {\n            value: \"Pr\\xE9l\\xE8vement SEPA \\xE0 remplir\",\n            type: \"h2\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 25\n          }, this), error.type === \"sepa\" && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"errorMessage\",\n            children: error.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 51\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Vous pourrez transf\\xE9rer ce document plus tard sur votre espace ou d\\xE9s maintenant.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"fileSepa\",\n            className: \"input-file\",\n            type: \"file\",\n            onChange: e => handleInputChange(e, \"sepa\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 25\n          }, this), documents.sepa.status && documents.sepa.status === \"validated\" ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"validMessage\",\n            children: [/*#__PURE__*/_jsxDEV(FaCheckCircle, {\n              style: {\n                marginRight: \"5px\"\n              },\n              size: \"25\",\n              color: \"rgb(120, 213, 152)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 61\n            }, this), \"Votre document a \\xE9t\\xE9 accept\\xE9\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [documents.sepa.status && documents.sepa.status === \"rejected\" && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"errorMessage\",\n              children: \"Votre document a \\xE9t\\xE9 refus\\xE9.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"inputDownload\",\n              children: /*#__PURE__*/_jsxDEV(ButtonSmall, {\n                onClick: () => handleDownloadSEPA(),\n                color: \"orange\",\n                value: \"T\\xE9l\\xE9charger le document\",\n                marginTop: \"20px\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(ButtonSmall, {\n              onClick: () => document.getElementById('fileSepa').click(),\n              color: \"blue\",\n              value: \"Charger le document\",\n              marginTop: \"20px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 37\n            }, this), documents.sepa && documents.sepa.status !== \"rejected\" && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"fileNameOnRight\",\n              children: documents.sepa.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 98\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step4-Section2\",\n          children: [/*#__PURE__*/_jsxDEV(Title, {\n            value: \"RIB bancaire\",\n            type: \"h2\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 25\n          }, this), error.type === \"rib\" && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"errorMessage\",\n            children: error.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 50\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Evitez les photos flous ou trop sombres.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"fileRib\",\n            className: \"input-file\",\n            type: \"file\",\n            onChange: e => handleInputChange(e, \"rib\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"fileConditions\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"2Mo max\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Type de fichiers accept\\xE9s : jpeg, jpg, PNG\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 25\n          }, this), documents.rib.status && documents.rib.status === \"validated\" ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"validMessage\",\n            children: [/*#__PURE__*/_jsxDEV(FaCheckCircle, {\n              style: {\n                marginRight: \"5px\"\n              },\n              size: \"25\",\n              color: \"rgb(120, 213, 152)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 61\n            }, this), \"Votre document a \\xE9t\\xE9 accept\\xE9\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [documents.rib.status && documents.rib.status === \"rejected\" && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"errorMessage\",\n              children: \"Votre document a \\xE9t\\xE9 refus\\xE9.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(ButtonSmall, {\n              onClick: () => document.getElementById('fileRib').click(),\n              color: \"blue\",\n              value: \"Charger le document\",\n              marginTop: \"15px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 37\n            }, this), documents.rib && documents.rib.status !== \"rejected\" && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"fileNameOnRight\",\n              children: documents.rib.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 96\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"divider\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step4-Section3\",\n          children: [/*#__PURE__*/_jsxDEV(Title, {\n            value: \"Si vous avez termin\\xE9 & bien v\\xE9rifi\\xE9 que vos documents sont correctements enregistr\\xE9s, vous pouvez finaliser votre dossier d'inscription\",\n            type: \"h2\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"En cochant cette case vous acceptez les \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"conditions g\\xE9n\\xE9rales de ventes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 68\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(ButtonLarge, {\n            onClick: () => handleSendForm(),\n            color: \"orange\",\n            value: buttonLoading ? /*#__PURE__*/_jsxDEV(ReactLoading, {\n              className: \"loadingSpinnerButton\",\n              type: \"spin\",\n              color: \"white\",\n              height: 23,\n              width: 23\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 52\n            }, this) : \"Finaliser mon inscription\",\n            width: \"400px\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }, this), error.type === \"final\" && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"PrestErrorMessage\",\n          children: error.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 48\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Prest_Step4, \"ZZowmz5tp3SveJFJS/l3EUSvTM8=\", false, function () {\n  return [useFirebase, useAuth, useHistory];\n});\n\n_c = Prest_Step4;\nexport default Prest_Step4;\n\nvar _c;\n\n$RefreshReg$(_c, \"Prest_Step4\");","map":{"version":3,"sources":["C:/Users/Home/Desktop/Boulot/Nivid/src/pages/Prest_Step4.js"],"names":["React","useState","useEffect","useHistory","useAuth","ButtonSmall","ButtonLarge","Layout","Title","SubTitle","ReactLoading","FaCheckCircle","useFirebase","CSSTransition","Prest_Step4","firebaseContext","auth","storage","initialDocuments","kbis","ci","assurance","sepa","rib","error","setError","type","message","buttonLoading","setButtonLoading","documents","setDocuments","isMounted","setIsMounted","seller","setCurrentStepProcess","addSellerDocuments","getSellerDocumentsFromDB","setSellerStatus","history","status","push","getCurrentDocumentsFromDB","then","data","handleInputChange","e","docType","target","files","size","handleSendForm","name","documentsUrlArray","doc","lastModified","token","Math","random","toString","substr","url","handleUploadFile","handleSendAll","description","length","image_path","services","currentUser","uid","image","Promise","resolve","reject","upload","ref","put","on","snapshot","console","log","child","getDownloadURL","catch","handleDownloadSEPA","element","document","createElement","file","Blob","getElementById","value","href","URL","createObjectURL","download","body","appendChild","click","marginRight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"../styles/Prest_.css\"\r\nimport { useHistory } from 'react-router-dom'\r\nimport { useAuth } from \"../context/userContext\"; // context\r\n\r\nimport { ButtonSmall, ButtonLarge } from '../components/utilities/Buttons'\r\nimport Layout from '../components/utilities/Layout'\r\nimport Title from '../components/utilities/Title'\r\nimport SubTitle from '../components/utilities/SubTitle'\r\nimport ReactLoading from 'react-loading';\r\nimport { FaCheckCircle } from 'react-icons/fa';\r\nimport { useFirebase } from \"../assets/base-context\";\r\n\r\nimport { CSSTransition } from 'react-transition-group'\r\n\r\nconst Prest_Step4 = () => {\r\n    \r\n    const firebaseContext = useFirebase()\r\n    const auth = firebaseContext.auth()\r\n    const storage = firebaseContext.storage()\r\n\r\n    const initialDocuments = {\r\n        kbis: \"\",\r\n        ci: \"\",\r\n        assurance: \"\",\r\n        sepa: \"\",\r\n        rib: \"\"\r\n    }\r\n\r\n    const [error, setError] = useState({ type: \"\", message: \"\" });\r\n    const [buttonLoading, setButtonLoading] = useState(false)\r\n\r\n    const [documents, setDocuments] = useState(initialDocuments)\r\n\r\n    const [isMounted, setIsMounted] = useState(false);\r\n\r\n    const { seller, setCurrentStepProcess, addSellerDocuments, getSellerDocumentsFromDB, setSellerStatus } = useAuth() // context\r\n    const history = useHistory()\r\n\r\n    seller.status !== \"subscribing\" && history.push('/mon-compte-partenaire')\r\n\r\n    setCurrentStepProcess(4)\r\n\r\n    useEffect(() => {\r\n        function getCurrentDocumentsFromDB() {\r\n            getSellerDocumentsFromDB().then(data => {\r\n                if (data === null) {\r\n                    setDocuments(initialDocuments)\r\n                }\r\n                else {\r\n                    setDocuments(data)\r\n                }\r\n            })\r\n        }\r\n        getCurrentDocumentsFromDB()\r\n        setIsMounted(true)\r\n    }, [])\r\n\r\n    function handleInputChange(e, docType) {\r\n        const type = e.target.files[0].type\r\n        const size = e.target.files[0].size\r\n        if (type !== \"image/png\" && type !== \"image/jpeg\" && type !== \"image/jpg\") {\r\n            setError({ type: docType, message: \"Votre fichier n'est ni une image jpeg, jpg ou PNG.\" })\r\n        }\r\n        else if (size > 2000000) {\r\n            setError({ type: docType, message: \"Votre image fait plus de 2Mo.\" })\r\n        }\r\n        else {\r\n            e.target.files[0].docType = docType\r\n            docType === \"sepa\" ? setDocuments({ ...documents, sepa: e.target.files[0] })\r\n                : docType === \"rib\" && setDocuments({ ...documents, rib: e.target.files[0] })\r\n            setError({ type: \"\", message: \"\" })\r\n        }\r\n    }\r\n\r\n    async function handleSendForm() {\r\n        setButtonLoading(true)\r\n        if (documents.rib.name) {\r\n            let documentsUrlArray = { ...documents }\r\n\r\n            for (const doc in documents) {\r\n                if (documents[doc].lastModified) {\r\n                    const token = `${documents[doc].docType}-${Math.random().toString(36).substr(2, 19)}`\r\n                    const url = await handleUploadFile(documents[doc], token)\r\n                    documentsUrlArray[documents[doc].docType] = { url: url, token: token, name: documents[doc].name }\r\n                }\r\n            }\r\n            await addSellerDocuments(documentsUrlArray)\r\n            handleSendAll()\r\n        }\r\n        else {\r\n            setError({ type: \"final\", message: \"Pour finaliser votre inscription, le Rib est obligatoire.\" })\r\n            setButtonLoading(false)\r\n        }\r\n    }\r\n\r\n    async function handleSendAll() {\r\n\r\n        if (seller.description && seller.description.length > 0) {\r\n            if (seller.image_path && seller.image_path.url && seller.image_path.url.length > 0) {\r\n                if (seller.services.length > 0) {\r\n                    if (documents.kbis.name && documents.kbis.status !== \"rejected\") {\r\n                        if (documents.ci.name && documents.ci.status !== \"rejected\") {\r\n                            if (documents.assurance.name && documents.assurance.status !== \"rejected\") {\r\n                                if (documents.rib.name && documents.rib.status !== \"rejected\") {\r\n                                    await setSellerStatus(auth.currentUser.uid, \"pending\")\r\n                                    history.push('/mon-compte-partenaire/confirmation')\r\n                                } else {\r\n                                    setError({ type: \"final\", message: \"Pour finaliser votre inscription, le RIB est obligatoire.\" })\r\n                                }\r\n                            } else {\r\n                                setError({ type: \"final\", message: \"Pour finaliser votre inscription, l'assurance de responsabilité civile est obligatoire.\" })\r\n                            }\r\n                        } else {\r\n                            setError({ type: \"final\", message: \"Pour finaliser votre inscription, la carte d'identité du gérant est obligatoire.\" })\r\n                        }\r\n                    } else {\r\n                        setError({ type: \"final\", message: \"Pour finaliser votre inscription, le Kbis est obligatoire.\" })\r\n                    }\r\n                } else {\r\n                    setError({ type: \"final\", message: \"Pour finaliser votre inscription, vous devez avoir ajouté au moins 1 service.\" })\r\n                }\r\n            } else {\r\n                setError({ type: \"final\", message: \"Pour finaliser votre inscription, merci d'ajouter une photo principale pour votre boutique.\" })\r\n            }\r\n        }\r\n        else {\r\n            setError({ type: \"final\", message: \"Pour finaliser votre inscription, vous devez renseigner une description de votre boutique, à l'étape Prestations\" })\r\n        }\r\n        setButtonLoading(false)\r\n    }\r\n\r\n    function handleUploadFile(image, token) {\r\n\r\n        return new Promise((resolve, reject) => {\r\n\r\n            const upload = storage.ref(`sellers/${token}`).put(image)\r\n            upload.on(\r\n                \"state_changed\", snapshot => { },\r\n                error => {\r\n                    console.log(error)\r\n                }, () => {\r\n                    storage\r\n                        .ref(\"sellers\")\r\n                        .child(token)\r\n                        .getDownloadURL()\r\n                        .then(url => {\r\n                            resolve(url);\r\n                        })\r\n                        .catch(error => {\r\n                            console.error(error)\r\n                            reject(error);\r\n                        })\r\n                }\r\n            )\r\n        })\r\n    }\r\n\r\n    function handleDownloadSEPA() {\r\n\r\n        const element = document.createElement(\"a\");\r\n        const file = new Blob([document.getElementById('inputDownload').value],\r\n            { type: 'text/plain;charset=utf-8' });\r\n        element.href = URL.createObjectURL(file);\r\n        element.download = \"SEPA.txt\";\r\n        document.body.appendChild(element);\r\n        element.click();\r\n    }\r\n\r\n    return (\r\n        <Layout>\r\n            <CSSTransition\r\n                in={isMounted}\r\n                timeout={300}\r\n                classNames=\"pageTransition\"\r\n                unmountOnExit\r\n            >\r\n                <div className=\"layoutDocumentPrest\">\r\n                    <div className=\"Prest-Step4-Header\">\r\n                        <SubTitle value=\"Vérification documents\" type=\"big\" font=\"roboto-medium\" align=\"left\" />\r\n                        <p>Sur cette page vous allez devoir nous transmettre vos documents, pour que nous puissions vérifier votre activité.</p>\r\n                        <p>Merci de bien vérifier les documents que vous enverrez, il ne peut y avoir de modifications sur ces documents là.</p>\r\n                    </div>\r\n\r\n                    <div className=\"Prest-Step4-Section1\">\r\n                        <Title value=\"Prélèvement SEPA à remplir\" type=\"h2\" font=\"roboto-medium\" align=\"left\" />\r\n                        {error.type === \"sepa\" && <p className=\"errorMessage\">{error.message}</p>}\r\n                        <p>Vous pourrez transférer ce document plus tard sur votre espace ou dés maintenant.</p>\r\n                        <input id=\"fileSepa\" className=\"input-file\" type=\"file\" onChange={(e) => handleInputChange(e, \"sepa\")} />\r\n\r\n                        {\r\n                            (documents.sepa.status && documents.sepa.status === \"validated\") ?\r\n                                <p className=\"validMessage\"><FaCheckCircle style={{ marginRight: \"5px\" }} size=\"25\" color=\"rgb(120, 213, 152)\" />Votre document a été accepté</p>\r\n                                :\r\n                                <div>\r\n                                    {(documents.sepa.status && documents.sepa.status === \"rejected\") &&\r\n                                        <p className=\"errorMessage\">Votre document a été refusé.</p>\r\n                                    }\r\n                                    <div id=\"inputDownload\">\r\n                                        <ButtonSmall\r\n                                            onClick={() => handleDownloadSEPA()}\r\n                                            color=\"orange\"\r\n                                            value=\"Télécharger le document\"\r\n                                            marginTop=\"20px\"\r\n                                        />\r\n                                    </div>\r\n                                    <ButtonSmall\r\n                                        onClick={() => document.getElementById('fileSepa').click()}\r\n                                        color=\"blue\"\r\n                                        value=\"Charger le document\"\r\n                                        marginTop=\"20px\"\r\n                                    />\r\n                                    {(documents.sepa && documents.sepa.status !== \"rejected\") && <span className=\"fileNameOnRight\">{documents.sepa.name}</span>}\r\n                                </div>\r\n\r\n                        }\r\n                    </div>\r\n\r\n                    <div className=\"Prest-Step4-Section2\">\r\n                        <Title value=\"RIB bancaire\" type=\"h2\" font=\"roboto-medium\" align=\"left\" />\r\n                        {error.type === \"rib\" && <p className=\"errorMessage\">{error.message}</p>}\r\n                        <p>Evitez les photos flous ou trop sombres.</p>\r\n                        <input id=\"fileRib\" className=\"input-file\" type=\"file\" onChange={(e) => handleInputChange(e, \"rib\")} />\r\n                        <div className=\"fileConditions\">\r\n                            <p>2Mo max</p>\r\n                            <p>Type de fichiers acceptés : jpeg, jpg, PNG</p>\r\n                        </div>\r\n                        {\r\n                            (documents.rib.status && documents.rib.status === \"validated\") ?\r\n                                <p className=\"validMessage\"><FaCheckCircle style={{ marginRight: \"5px\" }} size=\"25\" color=\"rgb(120, 213, 152)\" />Votre document a été accepté</p>\r\n                                :\r\n                                <div>\r\n                                    {(documents.rib.status && documents.rib.status === \"rejected\") &&\r\n                                        <p className=\"errorMessage\">Votre document a été refusé.</p>\r\n                                    }\r\n                                    <ButtonSmall\r\n                                        onClick={() => document.getElementById('fileRib').click()}\r\n                                        color=\"blue\"\r\n                                        value=\"Charger le document\"\r\n                                        marginTop=\"15px\"\r\n                                    />\r\n                                    {(documents.rib && documents.rib.status !== \"rejected\") && <span className=\"fileNameOnRight\">{documents.rib.name}</span>}\r\n                                </div>\r\n                        }\r\n\r\n                    </div>\r\n\r\n\r\n                    <div className=\"divider\"></div>\r\n\r\n                    <div className=\"Prest-Step4-Section3\">\r\n                        <Title value=\"Si vous avez terminé & bien vérifié que vos documents sont correctements enregistrés, vous pouvez finaliser votre dossier d'inscription\" type=\"h2\" font=\"roboto-medium\" align=\"left\" />\r\n                        <p>En cochant cette case vous acceptez les <span>conditions générales de ventes</span></p>\r\n                        <ButtonLarge\r\n                            onClick={() => handleSendForm()}\r\n                            color=\"orange\"\r\n                            value={buttonLoading ? <ReactLoading className=\"loadingSpinnerButton\" type=\"spin\" color=\"white\" height={23} width={23} /> : \"Finaliser mon inscription\"}\r\n                            width=\"400px\"\r\n                        />\r\n                    </div>\r\n                    {error.type === \"final\" && <p className=\"PrestErrorMessage\">{error.message}</p>}\r\n                </div>\r\n            </CSSTransition>\r\n        </Layout>\r\n    )\r\n}\r\nexport default Prest_Step4;\r\n"]},"metadata":{},"sourceType":"module"}