{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bonnieclyde/Desktop/Copie de Nivid (1)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/bonnieclyde/Desktop/Copie de Nivid (1)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/bonnieclyde/Desktop/Copie de Nivid (1)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/bonnieclyde/Desktop/Copie de Nivid (1)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/bonnieclyde/Desktop/Copie de Nivid (1)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{createContext,useState,useEffect,useContext}from\"react\";import firebase from\"firebase/app\";import{useFirebase}from\"../assets/base-context\";import publicIp from\"public-ip\";import Stripe from\"stripe\";import functions from\"firebase/firebase-functions\";import{inputAdornmentClasses}from\"@mui/material\";var SibApiV3Sdk=require(\"sib-api-v3-sdk\");var defaultClient=SibApiV3Sdk.ApiClient.instance;var myAPIKey=process.env.REACT_APP_SENDINBLUE_APIKEY;var apiKey=defaultClient.authentications[\"api-key\"];apiKey.apiKey=myAPIKey;var partnerKey=defaultClient.authentications[\"partner-key\"];partnerKey.apiKey=process.env.REACT_APP_SENDINBLUE_APIKEY;var apiInstance=new SibApiV3Sdk.ContactsApi();var createContact=new SibApiV3Sdk.CreateContact();var apiInstanceSend=new SibApiV3Sdk.TransactionalEmailsApi();var sendSmtpEmail=new SibApiV3Sdk.SendSmtpEmail();// Ce fichier comporte toutes les fonctions d'appels et de traitement bdd, et du context global.\n// Il englobe l'app dans App.js\nexport var UserContext=/*#__PURE__*/createContext();export function useAuth(){return useContext(UserContext);}export var UserProvider=function UserProvider(_ref){var children=_ref.children;var firebaseContext=useFirebase();var auth=firebaseContext.auth();var provider=firebaseContext.provider();var storage=firebaseContext.storage();var firestore=firebaseContext.firestore();var datePlusYear=new Date();datePlusYear.setFullYear(datePlusYear.getFullYear()+1);var initialEvent={name:\"\",date:datePlusYear,startAt:0,endAt:86360,people:50,placeSize:250,place:\"\",latLng:[],budget:50,budgetLeft:0,status:null,id:null,choosedServices:[]};var initialSeller={companyName:\"\",adress:\"\",siret:\"\",website:\"\",firstName:\"\",lastName:\"\",phone:\"\",description:\"\",category:\"\",subcategory:\"\",image_path:\"\"};var _useState=useState(),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(initialSeller),_useState4=_slicedToArray(_useState3,2),seller=_useState4[0],setSeller=_useState4[1];var _useState5=useState(initialEvent),_useState6=_slicedToArray(_useState5,2),event=_useState6[0],setEvent=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),currentStepProcess=_useState10[0],setCurrentStepProcess=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),loadingButtonAddToCard=_useState12[0],setLoadingButtonAddToCard=_useState12[1];var refUsers=firestore.collection(\"users\");var refEvents=firestore.collection(\"events\");var refSellers=firestore.collection(\"sellers\");var refSales=firestore.collection(\"sales\");var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),homeSellersDisplay=_useState14[0],setHomeSellersDisplay=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isCardWidgetOpen=_useState16[0],setIsCardWidgetOpen=_useState16[1];var createStripeCheckout=user?firebase.functions().httpsCallable(\"createStripeCheckout\"):null;var createStripeSubscribe=firebase.functions().httpsCallable(\"createStripeSubscribe\");var stripe=user||seller?window.Stripe(\"pk_test_51InLbZBwyEuW61Pj3yTYQlp31JobhK9vIKh32GColDUhXcdtzaKhWF5mVRDa9SGw7HujSuEDPCwvh40GEuo6uJxA00iqmaUXQp\"):null;var checkStripeReturn=user||seller?firebase.functions().httpsCallable(\"checkStripeReturn\"):null;useEffect(function(){auth.onAuthStateChanged(function(data){return handleAuthChanged(data);});},[]);function handleAuthChanged(_x){return _handleAuthChanged.apply(this,arguments);}function _handleAuthChanged(){_handleAuthChanged=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var isSeller,isUser,sellerData,sellerServices,eventData,_sellerData,_eventData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!data){_context.next=57;break;}_context.next=3;return isThisUserSeller(data.uid);case 3:isSeller=_context.sent;_context.next=6;return isThisUserUser(data.uid);case 6:isUser=_context.sent;if(!(isSeller&&!isUser)){_context.next=19;break;}_context.next=10;return getSellerDataFromDB(data.uid);case 10:sellerData=_context.sent;_context.next=13;return getServicesOfCurrentSellerFromDB();case 13:sellerServices=_context.sent;setSeller(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},initialSeller),data),sellerData),{},{services:sellerServices}));setUser();setLoading(false);_context.next=55;break;case 19:if(!(isUser&&!isSeller)){_context.next=39;break;}if(!(data.emailVerified===false)){_context.next=25;break;}setUser();setSeller();setLoading(false);return _context.abrupt(\"return\");case 25:setUser(data);setSeller();_context.next=29;return getEvent(data.uid);case 29:eventData=_context.sent;if(!(eventData&&eventData!==null)){_context.next=35;break;}_context.next=33;return getChoosedServices(eventData);case 33:_context.next=36;break;case 35:setEvent(initialEvent);case 36:setLoading(false);_context.next=55;break;case 39:if(!(isSeller&&isUser)){_context.next=55;break;}_context.next=42;return getSellerDataFromDB(data.uid);case 42:_sellerData=_context.sent;setSeller(_objectSpread(_objectSpread(_objectSpread({},initialSeller),data),_sellerData));setUser(data);_context.next=47;return getEvent(data.uid);case 47:_eventData=_context.sent;if(!(_eventData&&_eventData!==null)){_context.next=53;break;}_context.next=51;return getChoosedServices(_eventData);case 51:_context.next=54;break;case 53:setEvent(initialEvent);case 54:setLoading(false);case 55:_context.next=60;break;case 57:setSeller();setUser();setLoading(false);case 60:case\"end\":return _context.stop();}}},_callee);}));return _handleAuthChanged.apply(this,arguments);}function getSellerDataFromDB(_x2){return _getSellerDataFromDB.apply(this,arguments);}function _getSellerDataFromDB(){_getSellerDataFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var query,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return refSellers.doc(id).get();case 2:query=_context2.sent;result=query.data();return _context2.abrupt(\"return\",result);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _getSellerDataFromDB.apply(this,arguments);}function isThisUserSeller(_x3){return _isThisUserSeller.apply(this,arguments);}function _isThisUserSeller(){_isThisUserSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var doc;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return refSellers.doc(id).get();case 2:doc=_context3.sent;if(!doc.exists){_context3.next=5;break;}return _context3.abrupt(\"return\",true);case 5:return _context3.abrupt(\"return\",false);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return _isThisUserSeller.apply(this,arguments);}function isThisUserUser(_x4){return _isThisUserUser.apply(this,arguments);}function _isThisUserUser(){_isThisUserUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){var doc;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return refUsers.doc(id).get();case 2:doc=_context4.sent;if(!doc.exists){_context4.next=5;break;}return _context4.abrupt(\"return\",true);case 5:return _context4.abrupt(\"return\",false);case 6:case\"end\":return _context4.stop();}}},_callee4);}));return _isThisUserUser.apply(this,arguments);}function getEvent(_x5){return _getEvent.apply(this,arguments);}function _getEvent(){_getEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(uid){var getEvent,item;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return refEvents.where(\"user\",\"==\",uid).get();case 2:getEvent=_context5.sent;if(!(getEvent.docs.length>0)){_context5.next=9;break;}item={};getEvent.docs.forEach(function(doc){var data=doc.data();if(data.status&&data.status!==\"passed\"){item=_objectSpread({},data);item.date=data.date.toMillis();item.id=doc.id;}});return _context5.abrupt(\"return\",item&&item.status&&item.status!==\"passed\"?item:null);case 9:return _context5.abrupt(\"return\",null);case 10:case\"end\":return _context5.stop();}}},_callee5);}));return _getEvent.apply(this,arguments);}function addEvent(_x6){return _addEvent.apply(this,arguments);}function _addEvent(){_addEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(item){var myEvent,myNewEvent;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:myEvent=_objectSpread({},item);delete myEvent.id;if(!(item.status!==\"creating\")){_context6.next=6;break;}_context6.next=5;return createEvent(myEvent);case 5:myNewEvent=_context6.sent;case 6:if(!(item.status===\"creating\")){_context6.next=10;break;}_context6.next=9;return updateEvent(item,myEvent);case 9:myNewEvent=_context6.sent;case 10:_context6.next=12;return getChoosedServices(myNewEvent);case 12:case\"end\":return _context6.stop();}}},_callee6);}));return _addEvent.apply(this,arguments);}function createEvent(_x7){return _createEvent.apply(this,arguments);}function _createEvent(){_createEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(myEvent){var req,res,identifier,updateContact,docRef;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return refUsers.doc(myEvent.user).get();case 2:req=_context7.sent;res=req.data();identifier=res.email;updateContact={attributes:{NOTIF_DATE:new Date(myEvent.date),EVENTID:event.id}};apiInstance.updateContact(identifier,updateContact).then(function(){},function(error){console.error(error);});myEvent.status=\"creating\";_context7.next=10;return refEvents.add(_objectSpread(_objectSpread({},myEvent),{},{date:new Date(myEvent.date)}));case 10:docRef=_context7.sent;myEvent.id=docRef.id;return _context7.abrupt(\"return\",myEvent);case 13:case\"end\":return _context7.stop();}}},_callee7);}));return _createEvent.apply(this,arguments);}function updateEvent(_x8,_x9){return _updateEvent.apply(this,arguments);}function _updateEvent(){_updateEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(item,myEvent){var getServices;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!(item.place!==event.place)){_context9.next=5;break;}_context9.next=3;return refEvents.doc(item.id).collection(\"services\").get();case 3:getServices=_context9.sent;getServices.docs.forEach(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(doc){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return refEvents.doc(item.id).collection(\"services\").doc(doc.id).delete();case 2:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x117){return _ref2.apply(this,arguments);};}());case 5:_context9.next=7;return refEvents.doc(item.id).update(_objectSpread(_objectSpread({},myEvent),{},{date:new Date(myEvent.date)}));case 7:myEvent.id=item.id;return _context9.abrupt(\"return\",myEvent);case 9:case\"end\":return _context9.stop();}}},_callee9);}));return _updateEvent.apply(this,arguments);}function getBudgetLeft(_x10,_x11){return _getBudgetLeft.apply(this,arguments);}function _getBudgetLeft(){_getBudgetLeft=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(budget,choosedServices){var totalPrice,result;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:totalPrice=0;choosedServices.forEach(function(item){if(item.variations&&item.variations.length>0){totalPrice+=item.variations.filter(function(vari){return vari.name===item.variation;})[0].price*item.quantity;}else totalPrice+=item.price*item.quantity;});result=budget-totalPrice;return _context10.abrupt(\"return\",result);case 4:case\"end\":return _context10.stop();}}},_callee10);}));return _getBudgetLeft.apply(this,arguments);}function getChoosedServices(_x12){return _getChoosedServices.apply(this,arguments);}function _getChoosedServices(){_getChoosedServices=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(item){var choosedServices,services,queryPrice,neWObject;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:choosedServices=[];_context11.next=3;return refEvents.doc(item.id).collection(\"services\").get();case 3:services=_context11.sent;services.forEach(function(doc){choosedServices.push(_objectSpread(_objectSpread({},doc.data()),{},{uid:doc.id}));});_context11.next=7;return getBudgetLeft(item.budget,choosedServices);case 7:queryPrice=_context11.sent;neWObject=_objectSpread(_objectSpread({},item),{},{budgetLeft:queryPrice,choosedServices:choosedServices});return _context11.abrupt(\"return\",setEvent(neWObject));case 10:case\"end\":return _context11.stop();}}},_callee11);}));return _getChoosedServices.apply(this,arguments);}function login(_x13,_x14){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(email,password){return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.next=2;return auth.signInWithEmailAndPassword(email,password).then(function(data){if(data.user.emailVerified===false){setSeller();setUser();return false;}setUser(data.user);return true;});case 2:return _context12.abrupt(\"return\",_context12.sent);case 3:case\"end\":return _context12.stop();}}},_callee12);}));return _login.apply(this,arguments);}function verifyLogin(_x15,_x16){return _verifyLogin.apply(this,arguments);}function _verifyLogin(){_verifyLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(email,password){var data;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return auth.signInWithEmailAndPassword(email,password);case 2:data=_context13.sent;return _context13.abrupt(\"return\",data);case 4:case\"end\":return _context13.stop();}}},_callee13);}));return _verifyLogin.apply(this,arguments);}function subscribe(_x17,_x18,_x19,_x20,_x21,_x22,_x23){return _subscribe.apply(this,arguments);}function _subscribe(){_subscribe=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(email,password,firstName,name,tel,gender,birthDate){return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:return _context15.abrupt(\"return\",auth.createUserWithEmailAndPassword(email,password).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(userData){return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return userData.user.updateProfile({displayName:firstName});case 2:_context14.next=4;return refUsers.doc(userData.user.uid).set({firstName:firstName,name:name,tel:tel,gender:gender,birthDate:birthDate,email:email}).catch(function(error){return console.log(error);});case 4:userData.user.sendEmailVerification();setUser();setSeller();sendInBlue_addContactSubscribe(email,firstName);return _context14.abrupt(\"return\",true);case 9:case\"end\":return _context14.stop();}}},_callee14);}));return function(_x118){return _ref3.apply(this,arguments);};}()).catch(function(error){return error.code;}));case 1:case\"end\":return _context15.stop();}}},_callee15);}));return _subscribe.apply(this,arguments);}function sellerSubscribe(_x24,_x25,_x26,_x27,_x28,_x29,_x30,_x31,_x32,_x33,_x34){return _sellerSubscribe.apply(this,arguments);}function _sellerSubscribe(){_sellerSubscribe=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(companyName,adress,siret,website,firstName,lastName,email,phone,password,latLng,referral){var referralToken;return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:referralToken=Date.now().toString().substr(0,5)+Math.random().toString().substr(2,7);return _context17.abrupt(\"return\",auth.createUserWithEmailAndPassword(email,password).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(userData){return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:_context16.next=2;return userData.user.updateProfile({displayName:firstName});case 2:_context16.next=4;return refSellers.doc(userData.user.uid).set({companyName:companyName,adress:adress,latLng:latLng,siret:siret,website:website,firstName:firstName,lastName:lastName,phone:phone,email:email,image_path:\"\",status:\"subscribing\",referralToken:referralToken,referral:referral}).catch(function(error){return console.log(error);});case 4:if(!(referral.length===12)){_context16.next=8;break;}_context16.next=7;return updateSellerAfterReferralNewSeller(referral,userData.user.uid);case 7:sendInBlue_sendToParrainAboutNewReferral(referral);case 8:sendInBlue_addContactSubscribe(email,firstName,lastName,userData.user.uid);setUser();setSeller({companyName:companyName,adress:adress,latLng:latLng,siret:siret,website:website,firstName:firstName,lastName:lastName,phone:phone,email:email,image_path:\"\",status:\"subscribing\",referralToken:referralToken,referral:referral,uid:userData.user.uid});userData.user.sendEmailVerification();return _context16.abrupt(\"return\",true);case 13:case\"end\":return _context16.stop();}}},_callee16);}));return function(_x119){return _ref4.apply(this,arguments);};}()).catch(function(error){return error.code;}));case 2:case\"end\":return _context17.stop();}}},_callee17);}));return _sellerSubscribe.apply(this,arguments);}function updateSellerAfterReferralNewSeller(_x35,_x36){return _updateSellerAfterReferralNewSeller.apply(this,arguments);}function _updateSellerAfterReferralNewSeller(){_updateSellerAfterReferralNewSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee18(referral,newSellerUid){var docs,docSeller;return _regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_context18.next=2;return refSellers.where(\"referralToken\",\"==\",referral).get();case 2:docs=_context18.sent;docSeller={};docs.forEach(function(doc){docSeller=_objectSpread(_objectSpread({},doc.data()),{},{uid:doc.id});});if(docSeller.uid!==undefined&&docSeller.uid!==null&&docSeller.uid.length>10){refSellers.doc(docSeller.uid).collection(\"referral\").add({newSeller:newSellerUid,date:Date.now()}).catch(function(error){return console.log(error);});}case 6:case\"end\":return _context18.stop();}}},_callee18);}));return _updateSellerAfterReferralNewSeller.apply(this,arguments);}function logout(){return auth.signOut();}function signInWithGoogle(){return _signInWithGoogle.apply(this,arguments);}// Ajouter un service au panier ( BBD et state )\nfunction _signInWithGoogle(){_signInWithGoogle=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee19(){var result,credential,token,user,doc;return _regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:_context19.next=2;return auth.signInWithPopup(provider);case 2:result=_context19.sent;/** @type {firebase.auth.OAuthCredential} */credential=result.credential;// This gives you a Google Access Token. You can use it to access the Google API.\ntoken=credential.accessToken;// The signed-in user info.\nuser=result.user;_context19.next=8;return refUsers.doc(user.uid).get();case 8:doc=_context19.sent;if(!doc.exists){_context19.next=13;break;}setUser(auth.currentUser);_context19.next=16;break;case 13:_context19.next=15;return refUsers.doc(user.uid).set({firstName:user.displayName,email:user.email});case 15:setUser(auth.currentUser);case 16:case\"end\":return _context19.stop();}}},_callee19);}));return _signInWithGoogle.apply(this,arguments);}function addToCard(_x37,_x38,_x39){return _addToCard.apply(this,arguments);}function _addToCard(){_addToCard=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee20(sellerID,item,quantity){var newEvent,refCurrentService,doc,refService,services,service,itemCopy,newService;return _regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:// Checkons si ce service est deja present dans la liste de cette event\nnewEvent=_objectSpread({},event);refCurrentService=refEvents.doc(event.id).collection(\"services\");_context20.next=4;return refCurrentService.where(\"id\",\"==\",item.id).where(\"variation\",\"==\",item.variation).get();case 4:doc=_context20.sent;refService=doc.exists&&doc.data();// Si le service existe dans les service séléctionnés pour cet event, on actualise juste en renseignant la nouvelle quantity ( BBD et state )\nif(!(doc.docs.length>0)){_context20.next=17;break;}_context20.next=9;return refCurrentService.doc(doc.docs[0].id).update({quantity:quantity});case 9://Ici on chope le service concerné dans le state, puis on le modifie pour ajouter la quantity, et on actualise le state\nservices=_toConsumableArray(event.choosedServices);service=services.find(function(service){return service.variation===item.variation&&service.id===item.id;});service.quantity=quantity;newEvent.choosedServices=services;getChoosedServices(newEvent);setLoadingButtonAddToCard(false);_context20.next=26;break;case 17:itemCopy=_objectSpread({},item);itemCopy.quantity=quantity;newService=[];_context20.next=22;return refCurrentService.add(itemCopy);case 22:newService.push(item);newEvent.choosedServices.push(newService[0]);getChoosedServices(newEvent);setLoadingButtonAddToCard(false);case 26:setIsCardWidgetOpen(true);case 27:case\"end\":return _context20.stop();}}},_callee20);}));return _addToCard.apply(this,arguments);}function getServiceQuantityInCard(id){var services=_toConsumableArray(event.choosedServices);var servicefiltered=services.filter(function(service){return service.id===id;});var count=0;if(servicefiltered.length>1)servicefiltered.forEach(function(service){return count+=service.quantity;});else if(servicefiltered.length>0)count+=servicefiltered[0].quantity;return count;}function updateQuantityService(_x40,_x41){return _updateQuantityService.apply(this,arguments);}function _updateQuantityService(){_updateQuantityService=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee21(serviceID,quantity){var eventData;return _regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:if(!(quantity===undefined)){_context21.next=2;break;}return _context21.abrupt(\"return\");case 2:quantity=parseInt(quantity);if(!(quantity!==0)){_context21.next=8;break;}_context21.next=6;return refEvents.doc(event.id).collection(\"services\").doc(serviceID).update({quantity:quantity});case 6:_context21.next=10;break;case 8:_context21.next=10;return refEvents.doc(event.id).collection(\"services\").doc(serviceID).delete();case 10:_context21.next=12;return getEvent(auth.currentUser.uid);case 12:eventData=_context21.sent;_context21.next=15;return getChoosedServices(eventData);case 15:setLoading(false);return _context21.abrupt(\"return\");case 17:case\"end\":return _context21.stop();}}},_callee21);}));return _updateQuantityService.apply(this,arguments);}function formatLabelTimePicker(secs){if(secs===86400)secs=86360;var minutes=Math.floor(secs/60);var hours=Math.floor(minutes/60);minutes=minutes%60;return\"\".concat(hours,\":\").concat((\"0\"+minutes).slice(-2));}function getAuthUserFromHisEmail(_x42){return _getAuthUserFromHisEmail.apply(this,arguments);}function _getAuthUserFromHisEmail(){_getAuthUserFromHisEmail=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee22(email){return _regeneratorRuntime.wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:return _context22.abrupt(\"return\",auth.sendPasswordResetEmail(email).then(function(){return true;}).catch(function(error){if(error.code===\"auth/invalid-email\"){return\"invalid\";}else if(error.code===\"auth/user-not-found\"){return\"notexist\";}}));case 1:case\"end\":return _context22.stop();}}},_callee22);}));return _getAuthUserFromHisEmail.apply(this,arguments);}function updateUserEmail(_x43){return _updateUserEmail.apply(this,arguments);}function _updateUserEmail(){_updateUserEmail=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee23(email){var user;return _regeneratorRuntime.wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:user=auth.currentUser;_context23.next=3;return user.updateEmail(email);case 3:_context23.next=5;return refUsers.doc(user.uid).update({email:email});case 5:_context23.next=7;return user.sendEmailVerification();case 7:return _context23.abrupt(\"return\",true);case 8:case\"end\":return _context23.stop();}}},_callee23);}));return _updateUserEmail.apply(this,arguments);}function getCurrentUserProfil(){return _getCurrentUserProfil.apply(this,arguments);}function _getCurrentUserProfil(){_getCurrentUserProfil=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee24(){var uid,doc;return _regeneratorRuntime.wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:uid=auth.currentUser.uid;_context24.next=3;return refUsers.doc(uid).get();case 3:doc=_context24.sent;return _context24.abrupt(\"return\",doc.exists?doc.data():null);case 5:case\"end\":return _context24.stop();}}},_callee24);}));return _getCurrentUserProfil.apply(this,arguments);}function updateCurrentUserProfil(_x44){return _updateCurrentUserProfil.apply(this,arguments);}function _updateCurrentUserProfil(){_updateCurrentUserProfil=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee25(data){var uid;return _regeneratorRuntime.wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:uid=auth.currentUser.uid;refUsers.doc(uid).update(data);user.updateProfile({displayName:data.firstName});case 3:case\"end\":return _context25.stop();}}},_callee25);}));return _updateCurrentUserProfil.apply(this,arguments);}function setImageSellerDB(_x45,_x46){return _setImageSellerDB.apply(this,arguments);}function _setImageSellerDB(){_setImageSellerDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee26(url,token){return _regeneratorRuntime.wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:_context26.next=2;return refSellers.doc(auth.currentUser.uid).update({image_path:{url:url,token:token}});case 2:case\"end\":return _context26.stop();}}},_callee26);}));return _setImageSellerDB.apply(this,arguments);}function addSellerDescription(_x47,_x48){return _addSellerDescription.apply(this,arguments);}function _addSellerDescription(){_addSellerDescription=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee27(data,imgURL){return _regeneratorRuntime.wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:_context27.next=2;return refSellers.doc(auth.currentUser.uid).update({description:data.description,category:data.category,subcategory:data.subcategory});case 2:setSeller(_objectSpread(_objectSpread({},seller),{},{description:data.description,category:data.category,subcategory:data.subcategory,image_path:imgURL!==null&&imgURL}));case 3:case\"end\":return _context27.stop();}}},_callee27);}));return _addSellerDescription.apply(this,arguments);}function addSellerServices(_x49){return _addSellerServices.apply(this,arguments);}function _addSellerServices(){_addSellerServices=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee29(services){return _regeneratorRuntime.wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:setSeller(_objectSpread(_objectSpread({},seller),{},{services:services}));services.forEach(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee28(service){return _regeneratorRuntime.wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:if(!(service.id.length>2)){_context28.next=4;break;}_context28.next=3;return refSellers.doc(auth.currentUser.uid).collection(\"services\").doc(service.id).update(service);case 3:return _context28.abrupt(\"return\",_context28.sent);case 4:_context28.next=6;return refSellers.doc(auth.currentUser.uid).collection(\"services\").add(service);case 6:return _context28.abrupt(\"return\",_context28.sent);case 7:case\"end\":return _context28.stop();}}},_callee28);}));return function(_x120){return _ref5.apply(this,arguments);};}());case 2:case\"end\":return _context29.stop();}}},_callee29);}));return _addSellerServices.apply(this,arguments);}function addOneSellerService(_x50){return _addOneSellerService.apply(this,arguments);}function _addOneSellerService(){_addOneSellerService=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee30(service){var docRef;return _regeneratorRuntime.wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:if(!(service.id.length>2)){_context30.next=4;break;}_context30.next=3;return refSellers.doc(auth.currentUser.uid).collection(\"services\").doc(service.id).update(service);case 3:return _context30.abrupt(\"return\",_context30.sent);case 4:_context30.next=6;return refSellers.doc(auth.currentUser.uid).collection(\"services\").add(service);case 6:docRef=_context30.sent;return _context30.abrupt(\"return\",docRef.id);case 8:case\"end\":return _context30.stop();}}},_callee30);}));return _addOneSellerService.apply(this,arguments);}function getServicesOfCurrentSellerFromDB(){return _getServicesOfCurrentSellerFromDB.apply(this,arguments);}function _getServicesOfCurrentSellerFromDB(){_getServicesOfCurrentSellerFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee31(){var services,result;return _regeneratorRuntime.wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:_context31.next=2;return refSellers.doc(auth.currentUser.uid).collection(\"services\").get();case 2:services=_context31.sent;result=[];services.docs.forEach(function(doc){var newResult=_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id});result.push(newResult);});return _context31.abrupt(\"return\",result);case 6:case\"end\":return _context31.stop();}}},_callee31);}));return _getServicesOfCurrentSellerFromDB.apply(this,arguments);}function addSellerDocuments(_x51){return _addSellerDocuments.apply(this,arguments);}function _addSellerDocuments(){_addSellerDocuments=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee32(documents){return _regeneratorRuntime.wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:_context32.next=2;return refSellers.doc(auth.currentUser.uid).update({documents:documents});case 2:return _context32.abrupt(\"return\",_context32.sent);case 3:case\"end\":return _context32.stop();}}},_callee32);}));return _addSellerDocuments.apply(this,arguments);}function getSellerDocumentsFromDB(){return _getSellerDocumentsFromDB.apply(this,arguments);}function _getSellerDocumentsFromDB(){_getSellerDocumentsFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee33(){var query,doc,result;return _regeneratorRuntime.wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:_context33.next=2;return refSellers.doc(auth.currentUser.uid).get();case 2:query=_context33.sent;doc=query.data();result=doc.documents&&doc.documents;if(!(result===undefined)){_context33.next=7;break;}return _context33.abrupt(\"return\",null);case 7:return _context33.abrupt(\"return\",result);case 8:case\"end\":return _context33.stop();}}},_callee33);}));return _getSellerDocumentsFromDB.apply(this,arguments);}function setSellerStatus(_x52,_x53){return _setSellerStatus.apply(this,arguments);}function _setSellerStatus(){_setSellerStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee34(sellerId,status){return _regeneratorRuntime.wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:_context34.next=2;return refSellers.doc(sellerId).update({status:status});case 2:return _context34.abrupt(\"return\",setSeller(_objectSpread(_objectSpread({},seller),{},{status:status})));case 3:case\"end\":return _context34.stop();}}},_callee34);}));return _setSellerStatus.apply(this,arguments);}function updateSellerDocumentsStatus(_x54,_x55){return _updateSellerDocumentsStatus.apply(this,arguments);}function _updateSellerDocumentsStatus(){_updateSellerDocumentsStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee35(sellerId,newDocumentsArray){return _regeneratorRuntime.wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:_context35.next=2;return refSellers.doc(sellerId).update({documents:newDocumentsArray});case 2:_context35.t0=newDocumentsArray.status===\"rejected\";if(!_context35.t0){_context35.next=6;break;}_context35.next=6;return refSellers.doc(sellerId).update({status:\"subscribing\"});case 6:case\"end\":return _context35.stop();}}},_callee35);}));return _updateSellerDocumentsStatus.apply(this,arguments);}function getSellersInDbWithUids(_x56){return _getSellersInDbWithUids.apply(this,arguments);}// TODO ICi on a la fonction pour delete la photo de profil qu'on ecrase en a remplaceant, faudra faire la meme avec les autres endroits du site avec uploda de picture\nfunction _getSellersInDbWithUids(){_getSellersInDbWithUids=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee36(ids){var sellers,id,req,result;return _regeneratorRuntime.wrap(function _callee36$(_context36){while(1){switch(_context36.prev=_context36.next){case 0:sellers=[];_context36.t0=_regeneratorRuntime.keys(ids);case 2:if((_context36.t1=_context36.t0()).done){_context36.next=14;break;}id=_context36.t1.value;_context36.next=6;return refSellers.doc(ids[id]).get();case 6:req=_context36.sent;result=req.data();result.uid=req.id;sellers=[].concat(_toConsumableArray(sellers),[result]);if(!(sellers.length===ids.length)){_context36.next=12;break;}return _context36.abrupt(\"return\",sellers);case 12:_context36.next=2;break;case 14:case\"end\":return _context36.stop();}}},_callee36);}));return _getSellersInDbWithUids.apply(this,arguments);}function deleteOldSellerPicture(_x57,_x58){return _deleteOldSellerPicture.apply(this,arguments);}function _deleteOldSellerPicture(){_deleteOldSellerPicture=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee37(tokens,type){return _regeneratorRuntime.wrap(function _callee37$(_context37){while(1){switch(_context37.prev=_context37.next){case 0:tokens.forEach(function(token){var imageRef=type&&type===\"services\"?storage.ref(\"services\").child(token):storage.ref(\"sellers\").child(token);imageRef.delete().catch(function(error){return console.log(error);});});case 1:case\"end\":return _context37.stop();}}},_callee37);}));return _deleteOldSellerPicture.apply(this,arguments);}function addSalesInDB(_x59){return _addSalesInDB.apply(this,arguments);}function _addSalesInDB(){_addSalesInDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee39(sales){return _regeneratorRuntime.wrap(function _callee39$(_context39){while(1){switch(_context39.prev=_context39.next){case 0:return _context39.abrupt(\"return\",sales.map(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee38(sale){return _regeneratorRuntime.wrap(function _callee38$(_context38){while(1){switch(_context38.prev=_context38.next){case 0:_context38.next=2;return refSales.add(sale);case 2:return _context38.abrupt(\"return\",_context38.sent);case 3:case\"end\":return _context38.stop();}}},_callee38);}));return function(_x121){return _ref6.apply(this,arguments);};}()));case 1:case\"end\":return _context39.stop();}}},_callee39);}));return _addSalesInDB.apply(this,arguments);}function getSalesOfEventIdFromDB(_x60){return _getSalesOfEventIdFromDB.apply(this,arguments);}function _getSalesOfEventIdFromDB(){_getSalesOfEventIdFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee40(eventId){var req,salesOfEvent;return _regeneratorRuntime.wrap(function _callee40$(_context40){while(1){switch(_context40.prev=_context40.next){case 0:_context40.next=2;return refSales.where(\"eventID\",\"==\",eventId).get();case 2:req=_context40.sent;salesOfEvent=[];req.forEach(function(doc){return salesOfEvent.push(doc.data());});return _context40.abrupt(\"return\",salesOfEvent);case 6:case\"end\":return _context40.stop();}}},_callee40);}));return _getSalesOfEventIdFromDB.apply(this,arguments);}function getSalesOfSellerIdFromDB(_x61){return _getSalesOfSellerIdFromDB.apply(this,arguments);}function _getSalesOfSellerIdFromDB(){_getSalesOfSellerIdFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee41(sellerId){var req,salesOfSeller;return _regeneratorRuntime.wrap(function _callee41$(_context41){while(1){switch(_context41.prev=_context41.next){case 0:_context41.next=2;return refSales.where(\"sellerID\",\"==\",sellerId).get();case 2:req=_context41.sent;salesOfSeller=[];req.forEach(function(doc){return salesOfSeller.push(doc.data());});return _context41.abrupt(\"return\",salesOfSeller);case 6:case\"end\":return _context41.stop();}}},_callee41);}));return _getSalesOfSellerIdFromDB.apply(this,arguments);}function updateEventStatus(_x62){return _updateEventStatus.apply(this,arguments);}function _updateEventStatus(){_updateEventStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee42(status){return _regeneratorRuntime.wrap(function _callee42$(_context42){while(1){switch(_context42.prev=_context42.next){case 0:_context42.next=2;return refEvents.doc(event.id).update({status:status});case 2:return _context42.abrupt(\"return\",setEvent(_objectSpread(_objectSpread({},event),{},{status:status})));case 3:case\"end\":return _context42.stop();}}},_callee42);}));return _updateEventStatus.apply(this,arguments);}function clearEvent(){return _clearEvent.apply(this,arguments);}function _clearEvent(){_clearEvent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee43(){return _regeneratorRuntime.wrap(function _callee43$(_context43){while(1){switch(_context43.prev=_context43.next){case 0:setEvent(initialEvent);case 1:case\"end\":return _context43.stop();}}},_callee43);}));return _clearEvent.apply(this,arguments);}function getEventOfSaleFromDB(_x63){return _getEventOfSaleFromDB.apply(this,arguments);}function _getEventOfSaleFromDB(){_getEventOfSaleFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee44(eventId){var req,newEvent,reqServices;return _regeneratorRuntime.wrap(function _callee44$(_context44){while(1){switch(_context44.prev=_context44.next){case 0:_context44.next=2;return refEvents.doc(eventId).get();case 2:req=_context44.sent;newEvent=req.data();newEvent.choosedServices=[];_context44.next=7;return refEvents.doc(eventId).collection(\"services\").get();case 7:reqServices=_context44.sent;reqServices.forEach(function(doc){newEvent.choosedServices=[].concat(_toConsumableArray(newEvent.choosedServices),[doc.data()]);});return _context44.abrupt(\"return\",newEvent);case 10:case\"end\":return _context44.stop();}}},_callee44);}));return _getEventOfSaleFromDB.apply(this,arguments);}function formateToDate(timestamp){var date=new Date(timestamp);var year=date.getUTCFullYear();var month=date.getMonth()+1;var day=date.getDate();return\"\".concat(day,\"/\").concat(month<10?\"0\":\"\").concat(month,\"/\").concat(year);}function formateToDateWithWords(timestamp){var date=new Date(timestamp.seconds?timestamp.seconds*1000:timestamp);var year=date.getUTCFullYear();var month=date.getMonth()+1;var day=date.getDate();month=month===1?\"janv\":month===2?\"févr\":month===3?\"mars\":month===4?\"avril\":month===5?\"mai\":month===6?\"juin\":month===7?\"juil\":month===8?\"aout\":month===9?\"sept\":month===10?\"oct\":month===11?\"nov\":month===12&&\"déc\";return\"\".concat(day,\" \").concat(month,\" \").concat(year);}function formateToDateWithFullWords(timestamp){var date=new Date(timestamp);var year=date.getUTCFullYear();var month=date.getMonth()+1;var day=date.getDate();month=month===1?\"janvier\":month===2?\"février\":month===3?\"mars\":month===4?\"avril\":month===5?\"mai\":month===6?\"juin\":month===7?\"juillet\":month===8?\"aout\":month===9?\"septembre\":month===10?\"octobre\":month===11?\"novembre\":month===12&&\"décembre\";return\"\".concat(day,\" \").concat(month,\" \").concat(year);}function updateSaleStatusInDB(_x64,_x65,_x66){return _updateSaleStatusInDB.apply(this,arguments);}function _updateSaleStatusInDB(){_updateSaleStatusInDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee45(saleID,sellerID,status){var req,saleUID,userID,sale,req2,user;return _regeneratorRuntime.wrap(function _callee45$(_context45){while(1){switch(_context45.prev=_context45.next){case 0:_context45.next=2;return refSales.where(\"sellerID\",\"==\",sellerID).where(\"id\",\"==\",saleID).get();case 2:req=_context45.sent;req.forEach(function(doc){sale=doc.data();saleUID=doc.id;userID=sale.userID;});_context45.next=6;return refUsers.doc(userID).get();case 6:req2=_context45.sent;user=req2.data();_context45.next=10;return refSales.doc(saleUID).update({status:status});case 10:sendInBlue_sendNotificationToUserOfSaleStatus(user,seller.companyName,sale);case 11:case\"end\":return _context45.stop();}}},_callee45);}));return _updateSaleStatusInDB.apply(this,arguments);}function updateSaleNote(_x67,_x68){return _updateSaleNote.apply(this,arguments);}function _updateSaleNote(){_updateSaleNote=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee46(saleID,note){var req,saleUID;return _regeneratorRuntime.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:_context46.next=2;return refSales.where(\"sellerID\",\"==\",auth.currentUser.uid).where(\"id\",\"==\",saleID).get();case 2:req=_context46.sent;req.forEach(function(doc){return saleUID=doc.id;});_context46.next=6;return refSales.doc(saleUID).update({note:note});case 6:return _context46.abrupt(\"return\");case 7:case\"end\":return _context46.stop();}}},_callee46);}));return _updateSaleNote.apply(this,arguments);}function dateTodayMinusByDay(day){var date=new Date();date.setHours(date.getHours()-24*day);return date;}function addViewsOfSeller(_x69){return _addViewsOfSeller.apply(this,arguments);}function _addViewsOfSeller(){_addViewsOfSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee48(sellerID){var visitorIP,reqViews,recentViews;return _regeneratorRuntime.wrap(function _callee48$(_context48){while(1){switch(_context48.prev=_context48.next){case 0:_context48.next=2;return publicIp.v4();case 2:visitorIP=_context48.sent;_context48.next=5;return refSellers.doc(sellerID).collection(\"views\").get();case 5:reqViews=_context48.sent;recentViews=[];reqViews.forEach(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee47(doc){var view;return _regeneratorRuntime.wrap(function _callee47$(_context47){while(1){switch(_context47.prev=_context47.next){case 0:view=doc.data();if(view.ip===visitorIP&&view.date.seconds*1000>dateTodayMinusByDay(1)){recentViews=[].concat(_toConsumableArray(recentViews),[view]);}case 2:case\"end\":return _context47.stop();}}},_callee47);}));return function(_x122){return _ref7.apply(this,arguments);};}());if(!(recentViews.length===0)){_context48.next=11;break;}_context48.next=11;return refSellers.doc(sellerID).collection(\"views\").add({date:new Date(Date.now()),ip:visitorIP});case 11:case\"end\":return _context48.stop();}}},_callee48);}));return _addViewsOfSeller.apply(this,arguments);}function getViewsOfSeller(_x70){return _getViewsOfSeller.apply(this,arguments);}function _getViewsOfSeller(){_getViewsOfSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee49(sellerID){var reqViews,res;return _regeneratorRuntime.wrap(function _callee49$(_context49){while(1){switch(_context49.prev=_context49.next){case 0:_context49.next=2;return refSellers.doc(sellerID).collection(\"views\").get();case 2:reqViews=_context49.sent;res=[];reqViews.forEach(function(doc){return res.push(doc.data());});return _context49.abrupt(\"return\",res);case 6:case\"end\":return _context49.stop();}}},_callee49);}));return _getViewsOfSeller.apply(this,arguments);}function isSellerAllowedToModifyAndDeleteService(_x71){return _isSellerAllowedToModifyAndDeleteService.apply(this,arguments);}function _isSellerAllowedToModifyAndDeleteService(){_isSellerAllowedToModifyAndDeleteService=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee50(serviceID){var req,sellerSales,isAllowed;return _regeneratorRuntime.wrap(function _callee50$(_context50){while(1){switch(_context50.prev=_context50.next){case 0:_context50.next=2;return refSales.where(\"sellerID\",\"==\",auth.currentUser.uid).get();case 2:req=_context50.sent;sellerSales=[];req.forEach(function(doc){return sellerSales.push(doc.data());});isAllowed=true;sellerSales.forEach(function(sale){if(sale.status!==\"passed\"&&sale.status!==\"rejected\"){sale.choosedServices.forEach(function(service){if(service.id===serviceID)isAllowed=false;});}});return _context50.abrupt(\"return\",isAllowed);case 8:case\"end\":return _context50.stop();}}},_callee50);}));return _isSellerAllowedToModifyAndDeleteService.apply(this,arguments);}function deleteServiceOfSeller(_x72){return _deleteServiceOfSeller.apply(this,arguments);}function _deleteServiceOfSeller(){_deleteServiceOfSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee51(serviceID){return _regeneratorRuntime.wrap(function _callee51$(_context51){while(1){switch(_context51.prev=_context51.next){case 0:_context51.next=2;return refSellers.doc(auth.currentUser.uid).collection(\"services\").doc(serviceID).delete();case 2:return _context51.abrupt(\"return\",_context51.sent);case 3:case\"end\":return _context51.stop();}}},_callee51);}));return _deleteServiceOfSeller.apply(this,arguments);}function updateSellerProfil(_x73){return _updateSellerProfil.apply(this,arguments);}function _updateSellerProfil(){_updateSellerProfil=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee52(data){return _regeneratorRuntime.wrap(function _callee52$(_context52){while(1){switch(_context52.prev=_context52.next){case 0:_context52.next=2;return auth.currentUser.updateProfile({displayName:data.firstName});case 2:_context52.next=4;return refSellers.doc(auth.currentUser.uid).update({companyName:data.companyName,website:data.website,firstName:data.firstName,lastName:data.lastName,phone:data.phone});case 4:return _context52.abrupt(\"return\",setSeller(_objectSpread(_objectSpread({},seller),{},{companyName:data.companyName,website:data.website,firstName:data.firstName,lastName:data.lastName,phone:data.phone})));case 5:case\"end\":return _context52.stop();}}},_callee52);}));return _updateSellerProfil.apply(this,arguments);}function getSellerReferralCountFromDB(){return _getSellerReferralCountFromDB.apply(this,arguments);}function _getSellerReferralCountFromDB(){_getSellerReferralCountFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee53(){var res,newArray,finalArray,_i,_newArray,item,req,_res;return _regeneratorRuntime.wrap(function _callee53$(_context53){while(1){switch(_context53.prev=_context53.next){case 0:_context53.next=2;return refSellers.doc(auth.currentUser.uid).collection(\"referral\").get();case 2:res=_context53.sent;newArray=[];res.forEach(function(doc){return newArray.push(doc.data());});finalArray=[];_i=0,_newArray=newArray;case 7:if(!(_i<_newArray.length)){_context53.next=17;break;}item=_newArray[_i];_context53.next=11;return refSellers.doc(item.newSeller).get();case 11:req=_context53.sent;_res=req.data();if(_res.status===\"opened\")finalArray=[].concat(_toConsumableArray(finalArray),[_res]);case 14:_i++;_context53.next=7;break;case 17:return _context53.abrupt(\"return\",finalArray.length);case 18:case\"end\":return _context53.stop();}}},_callee53);}));return _getSellerReferralCountFromDB.apply(this,arguments);}function getEventFromUid(_x74){return _getEventFromUid.apply(this,arguments);}function _getEventFromUid(){_getEventFromUid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee54(uid){var req;return _regeneratorRuntime.wrap(function _callee54$(_context54){while(1){switch(_context54.prev=_context54.next){case 0:_context54.next=2;return refEvents.doc(uid).get();case 2:req=_context54.sent;return _context54.abrupt(\"return\",req.data());case 4:case\"end\":return _context54.stop();}}},_callee54);}));return _getEventFromUid.apply(this,arguments);}function getReviewsOfSellerUid(_x75){return _getReviewsOfSellerUid.apply(this,arguments);}function _getReviewsOfSellerUid(){_getReviewsOfSellerUid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee55(uid){var req,reviews;return _regeneratorRuntime.wrap(function _callee55$(_context55){while(1){switch(_context55.prev=_context55.next){case 0:_context55.next=2;return refSellers.doc(uid).collection(\"reviews\").get();case 2:req=_context55.sent;reviews=[];req.forEach(function(doc){return reviews.push(doc.data());});return _context55.abrupt(\"return\",reviews);case 6:case\"end\":return _context55.stop();}}},_callee55);}));return _getReviewsOfSellerUid.apply(this,arguments);}function addReviewOfSellerUid(_x76,_x77,_x78,_x79,_x80){return _addReviewOfSellerUid.apply(this,arguments);}function _addReviewOfSellerUid(){_addReviewOfSellerUid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee56(sellerUID,eventID,note,comment,name){return _regeneratorRuntime.wrap(function _callee56$(_context56){while(1){switch(_context56.prev=_context56.next){case 0:_context56.next=2;return refSellers.doc(sellerUID).collection(\"reviews\").add({eventID:eventID,note:note,comment:comment,name:name,date:new Date(),eventDate:event.date}).then(function(res){setTotalNoteOfSeller(sellerUID);return true;}).catch(function(error){return console.log(error);});case 2:return _context56.abrupt(\"return\",_context56.sent);case 3:case\"end\":return _context56.stop();}}},_callee56);}));return _addReviewOfSellerUid.apply(this,arguments);}function setTotalNoteOfSeller(_x81){return _setTotalNoteOfSeller.apply(this,arguments);}function _setTotalNoteOfSeller(){_setTotalNoteOfSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee57(sellerUID){var reqReviews,reviewsCount,totalNote,sellerNote;return _regeneratorRuntime.wrap(function _callee57$(_context57){while(1){switch(_context57.prev=_context57.next){case 0:_context57.next=2;return refSellers.doc(sellerUID).collection(\"reviews\").get();case 2:reqReviews=_context57.sent;reviewsCount=reqReviews.docs.length;totalNote=0;reqReviews.forEach(function(doc){var data=doc.data();totalNote+=data.note;});sellerNote=totalNote/reviewsCount;sellerNote=sellerNote.toFixed();_context57.next=10;return refSellers.doc(sellerUID).update({note:sellerNote});case 10:return _context57.abrupt(\"return\",true);case 11:case\"end\":return _context57.stop();}}},_callee57);}));return _setTotalNoteOfSeller.apply(this,arguments);}function getSellerPosition(_x82){return _getSellerPosition.apply(this,arguments);}function _getSellerPosition(){_getSellerPosition=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee58(sellerUID){var reqSellers,sellersWithNote,index;return _regeneratorRuntime.wrap(function _callee58$(_context58){while(1){switch(_context58.prev=_context58.next){case 0:_context58.next=2;return refSellers.get();case 2:reqSellers=_context58.sent;sellersWithNote=[];reqSellers.forEach(function(doc){var data=doc.data();if(data.note===undefined)return;var seller={note:data.note,id:doc.id};sellersWithNote.push(seller);});sellersWithNote.sort(function(a,b){if(a.note>b.note)return-1;if(a.note<b.note)return 1;return 0;});index=sellersWithNote.findIndex(function(item){return item.id===sellerUID;});return _context58.abrupt(\"return\",index+1);case 8:case\"end\":return _context58.stop();}}},_callee58);}));return _getSellerPosition.apply(this,arguments);}function getSellersCount(){return _getSellersCount.apply(this,arguments);}function _getSellersCount(){_getSellersCount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee59(){var req;return _regeneratorRuntime.wrap(function _callee59$(_context59){while(1){switch(_context59.prev=_context59.next){case 0:_context59.next=2;return refSellers.get();case 2:req=_context59.sent;return _context59.abrupt(\"return\",req.docs.length);case 4:case\"end\":return _context59.stop();}}},_callee59);}));return _getSellersCount.apply(this,arguments);}function sendInBlue_addContactSubscribe(_x83,_x84,_x85,_x86){return _sendInBlue_addContactSubscribe.apply(this,arguments);}function _sendInBlue_addContactSubscribe(){_sendInBlue_addContactSubscribe=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee60(email,firstName,lastName,uid){return _regeneratorRuntime.wrap(function _callee60$(_context60){while(1){switch(_context60.prev=_context60.next){case 0:createContact={email:email,listIds:[4],attributes:{PRENOM:firstName,NOM:lastName&&lastName,UID:uid?uid:0}};apiInstance.createContact(createContact).then(function(data){console.log(\"API called successfully.\");},function(error){console.error(error);});case 2:case\"end\":return _context60.stop();}}},_callee60);}));return _sendInBlue_addContactSubscribe.apply(this,arguments);}function sendInBlue_sendRecapToUserAfterPayment(_x87,_x88,_x89){return _sendInBlue_sendRecapToUserAfterPayment.apply(this,arguments);}function _sendInBlue_sendRecapToUserAfterPayment(){_sendInBlue_sendRecapToUserAfterPayment=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee61(email,sales,event){var newSales,paid,total;return _regeneratorRuntime.wrap(function _callee61$(_context61){while(1){switch(_context61.prev=_context61.next){case 0:newSales=[];paid=0;total=0;sales.forEach(function(sale){refSellers.doc(sale.sellerID).get().then(function(doc){var seller=doc.data();var newSale=_objectSpread(_objectSpread({},sale),{},{name:seller.companyName});newSales=[].concat(_toConsumableArray(newSales),[newSale]);total=total+sale.total;paid=paid+sale.paid;});});sendSmtpEmail={to:[{email:email}],params:{sales:newSales,event:event,paid:paid,total:total},templateId:10,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");},function(error){console.error(error);});case 6:case\"end\":return _context61.stop();}}},_callee61);}));return _sendInBlue_sendRecapToUserAfterPayment.apply(this,arguments);}function sendInBlue_sendNewSaleToSeller(_x90,_x91,_x92){return _sendInBlue_sendNewSaleToSeller.apply(this,arguments);}function _sendInBlue_sendNewSaleToSeller(){_sendInBlue_sendNewSaleToSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee62(email,services,event){return _regeneratorRuntime.wrap(function _callee62$(_context62){while(1){switch(_context62.prev=_context62.next){case 0:sendSmtpEmail={to:[{email:email}],params:{services:services,event:event},templateId:12,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");},function(error){console.error(error);});case 2:case\"end\":return _context62.stop();}}},_callee62);}));return _sendInBlue_sendNewSaleToSeller.apply(this,arguments);}function sendInBlue_sendNotificationToSellerOfReview(_x93,_x94){return _sendInBlue_sendNotificationToSellerOfReview.apply(this,arguments);}function _sendInBlue_sendNotificationToSellerOfReview(){_sendInBlue_sendNotificationToSellerOfReview=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee63(email,name){return _regeneratorRuntime.wrap(function _callee63$(_context63){while(1){switch(_context63.prev=_context63.next){case 0:sendSmtpEmail={to:[{email:email}],params:{name:name},templateId:4,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");},function(error){console.error(error);});case 2:case\"end\":return _context63.stop();}}},_callee63);}));return _sendInBlue_sendNotificationToSellerOfReview.apply(this,arguments);}function sendInBlue_sendNotificationToUserOfSaleStatus(_x95,_x96,_x97){return _sendInBlue_sendNotificationToUserOfSaleStatus.apply(this,arguments);}function _sendInBlue_sendNotificationToUserOfSaleStatus(){_sendInBlue_sendNotificationToUserOfSaleStatus=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee64(user,prestName,sale){return _regeneratorRuntime.wrap(function _callee64$(_context64){while(1){switch(_context64.prev=_context64.next){case 0:sendSmtpEmail={to:[{email:user.email}],params:{prestName:prestName,userName:user.firstName,services:sale.choosedServices},templateId:sale.status===\"rejected\"?8:sale.status===\"validated\"&&9,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");},function(error){console.error(error);});case 2:case\"end\":return _context64.stop();}}},_callee64);}));return _sendInBlue_sendNotificationToUserOfSaleStatus.apply(this,arguments);}function getTotalAmountDueToSeller(_x98){return _getTotalAmountDueToSeller.apply(this,arguments);}function _getTotalAmountDueToSeller(){_getTotalAmountDueToSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee65(sellerId){var req,salesOfSeller,validSales,prices,finalAmount;return _regeneratorRuntime.wrap(function _callee65$(_context65){while(1){switch(_context65.prev=_context65.next){case 0:_context65.next=2;return refSales.where(\"sellerID\",\"==\",sellerId!==undefined?sellerId:auth.currentUser.uid).get();case 2:req=_context65.sent;salesOfSeller=[];req.forEach(function(doc){salesOfSeller=[].concat(_toConsumableArray(salesOfSeller),[doc.data()]);});validSales=salesOfSeller.filter(function(sale){return sale.total===sale.paid&&sale.status===\"validated\";});// à mettre en passed je pense\nprices=validSales.map(function(sale){return sale.price;});finalAmount=0;prices.forEach(function(price){finalAmount=finalAmount+price;});return _context65.abrupt(\"return\",finalAmount);case 10:case\"end\":return _context65.stop();}}},_callee65);}));return _getTotalAmountDueToSeller.apply(this,arguments);}function sendInBlue_sendPaymentRequestToAdmin(_x99){return _sendInBlue_sendPaymentRequestToAdmin.apply(this,arguments);}function _sendInBlue_sendPaymentRequestToAdmin(){_sendInBlue_sendPaymentRequestToAdmin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee66(sellerId){var amount;return _regeneratorRuntime.wrap(function _callee66$(_context66){while(1){switch(_context66.prev=_context66.next){case 0:_context66.next=2;return getTotalAmountDueToSeller(sellerId);case 2:amount=_context66.sent;sendSmtpEmail={to:[{email:process.env.REACT_APP_ADMIN_EMAIL}],params:{sellerId:sellerId,amount:amount},templateId:16,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");},function(error){console.error(error);});case 5:case\"end\":return _context66.stop();}}},_callee66);}));return _sendInBlue_sendPaymentRequestToAdmin.apply(this,arguments);}function sendInBlue_sendBillRequestToAdmin(_x100,_x101){return _sendInBlue_sendBillRequestToAdmin.apply(this,arguments);}function _sendInBlue_sendBillRequestToAdmin(){_sendInBlue_sendBillRequestToAdmin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee67(transactionID,sellerID){return _regeneratorRuntime.wrap(function _callee67$(_context67){while(1){switch(_context67.prev=_context67.next){case 0:sendSmtpEmail={to:[{email:process.env.REACT_APP_ADMIN_EMAIL}],params:{sellerId:sellerID,transactionId:transactionID},templateId:17,headers:{\"X-Mailin-custom\":\"Content-Type:application/json|custom_header_2:custom_value_2\"}};return _context67.abrupt(\"return\",apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");return true;},function(error){console.error(error);return false;}));case 2:case\"end\":return _context67.stop();}}},_callee67);}));return _sendInBlue_sendBillRequestToAdmin.apply(this,arguments);}function sendInBlue_addContactToNewsletter(_x102){return _sendInBlue_addContactToNewsletter.apply(this,arguments);}function _sendInBlue_addContactToNewsletter(){_sendInBlue_addContactToNewsletter=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee68(email){return _regeneratorRuntime.wrap(function _callee68$(_context68){while(1){switch(_context68.prev=_context68.next){case 0:createContact={email:email,listIds:[5]};return _context68.abrupt(\"return\",apiInstance.createContact(createContact).then(function(data){return true;},function(error){console.log(error);return false;}));case 2:case\"end\":return _context68.stop();}}},_callee68);}));return _sendInBlue_addContactToNewsletter.apply(this,arguments);}function sendInBlue_sendInvitations(_x103,_x104,_x105,_x106){return _sendInBlue_sendInvitations.apply(this,arguments);}function _sendInBlue_sendInvitations(){_sendInBlue_sendInvitations=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee69(emails,message,user,event){var emailsArray,emailsArrayWithList,eventDate,startAt,endAt,creneaux;return _regeneratorRuntime.wrap(function _callee69$(_context69){while(1){switch(_context69.prev=_context69.next){case 0:emailsArray=[];emailsArrayWithList=[];emails.forEach(function(email){var newEntry={email:email};var newEntryList={email:email,listIds:[6],attributes:{EVENT_DATE:new Date(event.date)}};emailsArray=[].concat(_toConsumableArray(emailsArray),[newEntry]);emailsArrayWithList=[].concat(_toConsumableArray(emailsArrayWithList),[newEntryList]);});eventDate=formateToDateWithFullWords(event.date);startAt=formatLabelTimePicker(event.startAt);endAt=formatLabelTimePicker(event.endAt);creneaux=startAt+\" et \"+endAt;sendSmtpEmail={to:emailsArray,params:{prenom:user.displayName,message:message,nomEvent:event.name,adresse:event.place,invites:event.people,date:eventDate,creneaux:creneaux},templateId:7,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};return _context69.abrupt(\"return\",apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){return true;},function(error){return false;}));case 9:case\"end\":return _context69.stop();}}},_callee69);}));return _sendInBlue_sendInvitations.apply(this,arguments);}function getWishList(_x107){return _getWishList.apply(this,arguments);}function _getWishList(){_getWishList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee70(userID){var req,res;return _regeneratorRuntime.wrap(function _callee70$(_context70){while(1){switch(_context70.prev=_context70.next){case 0:_context70.next=2;return refUsers.doc(userID).get();case 2:req=_context70.sent;res=req.data();return _context70.abrupt(\"return\",res.wishlist||[]);case 5:case\"end\":return _context70.stop();}}},_callee70);}));return _getWishList.apply(this,arguments);}function deleteItemFromWishList(_x108){return _deleteItemFromWishList.apply(this,arguments);}function _deleteItemFromWishList(){_deleteItemFromWishList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee71(sellerID){var newWishList;return _regeneratorRuntime.wrap(function _callee71$(_context71){while(1){switch(_context71.prev=_context71.next){case 0:_context71.next=2;return getWishList(auth.currentUser.uid);case 2:newWishList=_context71.sent;newWishList=newWishList.filter(function(item){return item!==sellerID;});_context71.next=6;return refUsers.doc(auth.currentUser.uid).update({wishlist:newWishList});case 6:return _context71.abrupt(\"return\",newWishList);case 7:case\"end\":return _context71.stop();}}},_callee71);}));return _deleteItemFromWishList.apply(this,arguments);}function addItemToWishListOfUser(_x109){return _addItemToWishListOfUser.apply(this,arguments);}function _addItemToWishListOfUser(){_addItemToWishListOfUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee72(sellerID){var newWishList;return _regeneratorRuntime.wrap(function _callee72$(_context72){while(1){switch(_context72.prev=_context72.next){case 0:_context72.next=2;return getWishList(auth.currentUser.uid);case 2:newWishList=_context72.sent;newWishList=[].concat(_toConsumableArray(newWishList),[sellerID]);refUsers.doc(auth.currentUser.uid).update({wishlist:newWishList});return _context72.abrupt(\"return\");case 6:case\"end\":return _context72.stop();}}},_callee72);}));return _addItemToWishListOfUser.apply(this,arguments);}function getWishListCountOfSeller(_x110){return _getWishListCountOfSeller.apply(this,arguments);}function _getWishListCountOfSeller(){_getWishListCountOfSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee73(sellerID){var users;return _regeneratorRuntime.wrap(function _callee73$(_context73){while(1){switch(_context73.prev=_context73.next){case 0:_context73.next=2;return refUsers.where(\"wishlist\",\"array-contains\",sellerID).get();case 2:users=_context73.sent;return _context73.abrupt(\"return\",users.docs.length);case 4:case\"end\":return _context73.stop();}}},_callee73);}));return _getWishListCountOfSeller.apply(this,arguments);}function isSellerInWishListOfUser(_x111){return _isSellerInWishListOfUser.apply(this,arguments);}function _isSellerInWishListOfUser(){_isSellerInWishListOfUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee74(id){var currentWishList,isSellerInList;return _regeneratorRuntime.wrap(function _callee74$(_context74){while(1){switch(_context74.prev=_context74.next){case 0:_context74.next=2;return getWishList(auth.currentUser.uid);case 2:currentWishList=_context74.sent;isSellerInList=currentWishList.filter(function(item){return item===id;});return _context74.abrupt(\"return\",isSellerInList.length>0?true:false);case 5:case\"end\":return _context74.stop();}}},_callee74);}));return _isSellerInWishListOfUser.apply(this,arguments);}function getEmailOfSellerWithUid(_x112){return _getEmailOfSellerWithUid.apply(this,arguments);}function _getEmailOfSellerWithUid(){_getEmailOfSellerWithUid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee75(sellerID){var query,result;return _regeneratorRuntime.wrap(function _callee75$(_context75){while(1){switch(_context75.prev=_context75.next){case 0:_context75.next=2;return refSellers.doc(sellerID).get();case 2:query=_context75.sent;result=query.data();return _context75.abrupt(\"return\",result.email);case 5:case\"end\":return _context75.stop();}}},_callee75);}));return _getEmailOfSellerWithUid.apply(this,arguments);}function sendInBlue_sendToParrainAboutNewReferral(_x113){return _sendInBlue_sendToParrainAboutNewReferral.apply(this,arguments);}function _sendInBlue_sendToParrainAboutNewReferral(){_sendInBlue_sendToParrainAboutNewReferral=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee76(referralCode){var query,result,email;return _regeneratorRuntime.wrap(function _callee76$(_context76){while(1){switch(_context76.prev=_context76.next){case 0:_context76.next=2;return refSellers.where(\"referralToken\",\"==\",referralCode).get();case 2:query=_context76.sent;result=query[0].data();email=result.email;// Puis envoyer à ce seller le mail de new referral\nsendSmtpEmail={to:[{email:email}],params:{name:\"a\"},templateId:14,headers:{\"X-Mailin-custom\":\"custom_header_1:custom_value_1|custom_header_2:custom_value_2\"}};apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(function(data){console.log(\"API called successfully. Returned data: \");},function(error){console.error(error);});case 7:case\"end\":return _context76.stop();}}},_callee76);}));return _sendInBlue_sendToParrainAboutNewReferral.apply(this,arguments);}function checkoutStart(price){var saleToken=Date.now().toString().substr(0,9)+Math.random().toString().substr(2,9);refEvents.doc(event.id).update({saleToken:saleToken});createStripeCheckout({price:price,eventId:event.id,saleToken:saleToken}).then(function(response){var sessionId=response.data.id;stripe.redirectToCheckout({sessionId:sessionId});}).catch(function(error){return console.log(error);});}function checkoutSubscription(){var saleToken=Date.now().toString().substr(0,9)+Math.random().toString().substr(2,9);refSellers.doc(seller.uid).update({saleToken:saleToken});createStripeSubscribe({sellerID:seller.uid,saleToken:saleToken}).then(function(response){var sessionId=response.data.id;stripe.redirectToCheckout({sessionId:sessionId});}).catch(function(error){return console.log(error);});}function getSaleTokenOfEventFromDb(){return _getSaleTokenOfEventFromDb.apply(this,arguments);}function _getSaleTokenOfEventFromDb(){_getSaleTokenOfEventFromDb=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee77(){var req,res;return _regeneratorRuntime.wrap(function _callee77$(_context77){while(1){switch(_context77.prev=_context77.next){case 0:_context77.next=2;return refEvents.doc(event.id).get();case 2:req=_context77.sent;res=req.data();return _context77.abrupt(\"return\",res.saleToken);case 5:case\"end\":return _context77.stop();}}},_callee77);}));return _getSaleTokenOfEventFromDb.apply(this,arguments);}function checkoutCheck(_x114){return _checkoutCheck.apply(this,arguments);}function _checkoutCheck(){_checkoutCheck=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee78(session_id){return _regeneratorRuntime.wrap(function _callee78$(_context78){while(1){switch(_context78.prev=_context78.next){case 0:return _context78.abrupt(\"return\",checkStripeReturn({session_id:session_id}).then(function(result){return{status:result.data.payment_status,amount:result.data.amount_total,id:result.data.payment_intent||result.data.subscription};}));case 1:case\"end\":return _context78.stop();}}},_callee78);}));return _checkoutCheck.apply(this,arguments);}function addFoodTypeToSeller(_x115){return _addFoodTypeToSeller.apply(this,arguments);}function _addFoodTypeToSeller(){_addFoodTypeToSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee79(type){var newSeller,newFoodTypes;return _regeneratorRuntime.wrap(function _callee79$(_context79){while(1){switch(_context79.prev=_context79.next){case 0:if(!(type===\"Aucun\")){_context79.next=2;break;}return _context79.abrupt(\"return\");case 2:newSeller=_objectSpread({},seller);newFoodTypes=[];if(seller.foodTypes===undefined){newFoodTypes.push(type);}else{newFoodTypes=seller.foodTypes;newFoodTypes.push(type);}newSeller[\"foodTypes\"]=newFoodTypes;_context79.next=8;return refSellers.doc(auth.currentUser.uid).update({foodTypes:newFoodTypes});case 8:setSeller(newSeller);case 9:case\"end\":return _context79.stop();}}},_callee79);}));return _addFoodTypeToSeller.apply(this,arguments);}function deleteFoodTypeToSeller(_x116){return _deleteFoodTypeToSeller.apply(this,arguments);}function _deleteFoodTypeToSeller(){_deleteFoodTypeToSeller=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee80(serviceID){var req,data,type,newSeller,newFoodTypes,indexes;return _regeneratorRuntime.wrap(function _callee80$(_context80){while(1){switch(_context80.prev=_context80.next){case 0:_context80.next=2;return refSellers.doc(auth.currentUser.uid).collection(\"services\").doc(serviceID).get();case 2:req=_context80.sent;data=req.data();type=data.foodType;if(!(type===\"Aucun\")){_context80.next=7;break;}return _context80.abrupt(\"return\");case 7:newSeller=_objectSpread({},seller);newFoodTypes=[];if(!(seller.foodTypes===undefined)){_context80.next=13;break;}return _context80.abrupt(\"return\");case 13:newFoodTypes=seller.foodTypes;indexes=seller.foodTypes.map(function(item,index){return item===type?index:\"\";}).filter(String);if(!(indexes[0]===-1)){_context80.next=19;break;}return _context80.abrupt(\"return\");case 19:if(newFoodTypes.length>1){newFoodTypes.splice(indexes[0],1);}else newFoodTypes=[];case 20:newSeller[\"foodTypes\"]=newFoodTypes;_context80.next=23;return refSellers.doc(auth.currentUser.uid).update({foodTypes:newFoodTypes});case 23:setSeller(newSeller);case 24:case\"end\":return _context80.stop();}}},_callee80);}));return _deleteFoodTypeToSeller.apply(this,arguments);}return/*#__PURE__*/_jsx(UserContext.Provider,{value:{login:login,subscribe:subscribe,sellerSubscribe:sellerSubscribe,logout:logout,user:user,seller:seller,event:event,setUser:setUser,setSeller:setSeller,addEvent:addEvent,addToCard:addToCard,getServiceQuantityInCard:getServiceQuantityInCard,loadingButtonAddToCard:loadingButtonAddToCard,setLoadingButtonAddToCard:setLoadingButtonAddToCard,setCurrentStepProcess:setCurrentStepProcess,currentStepProcess:currentStepProcess,formatLabelTimePicker:formatLabelTimePicker,getAuthUserFromHisEmail:getAuthUserFromHisEmail,updateUserEmail:updateUserEmail,updateQuantityService:updateQuantityService,signInWithGoogle:signInWithGoogle,getCurrentUserProfil:getCurrentUserProfil,verifyLogin:verifyLogin,updateCurrentUserProfil:updateCurrentUserProfil,addSellerDescription:addSellerDescription,setImageSellerDB:setImageSellerDB,addSellerServices:addSellerServices,addOneSellerService:addOneSellerService,getServicesOfCurrentSellerFromDB:getServicesOfCurrentSellerFromDB,addSellerDocuments:addSellerDocuments,getSellerDocumentsFromDB:getSellerDocumentsFromDB,setSellerStatus:setSellerStatus,updateSellerDocumentsStatus:updateSellerDocumentsStatus,getSellersInDbWithUids:getSellersInDbWithUids,deleteOldSellerPicture:deleteOldSellerPicture,addSalesInDB:addSalesInDB,updateEventStatus:updateEventStatus,getSalesOfEventIdFromDB:getSalesOfEventIdFromDB,clearEvent:clearEvent,getSalesOfSellerIdFromDB:getSalesOfSellerIdFromDB,getEventOfSaleFromDB:getEventOfSaleFromDB,formateToDate:formateToDate,formateToDateWithWords:formateToDateWithWords,updateSaleStatusInDB:updateSaleStatusInDB,updateSaleNote:updateSaleNote,addViewsOfSeller:addViewsOfSeller,getViewsOfSeller:getViewsOfSeller,isSellerAllowedToModifyAndDeleteService:isSellerAllowedToModifyAndDeleteService,deleteServiceOfSeller:deleteServiceOfSeller,updateSellerProfil:updateSellerProfil,getSellerReferralCountFromDB:getSellerReferralCountFromDB,getEventFromUid:getEventFromUid,getReviewsOfSellerUid:getReviewsOfSellerUid,addReviewOfSellerUid:addReviewOfSellerUid,sendInBlue_sendNotificationToSellerOfReview:sendInBlue_sendNotificationToSellerOfReview,sendInBlue_addContactToNewsletter:sendInBlue_addContactToNewsletter,sendInBlue_sendInvitations:sendInBlue_sendInvitations,sendInBlue_sendRecapToUserAfterPayment:sendInBlue_sendRecapToUserAfterPayment,sendInBlue_sendNewSaleToSeller:sendInBlue_sendNewSaleToSeller,sendInBlue_sendToParrainAboutNewReferral:sendInBlue_sendToParrainAboutNewReferral,sendInBlue_sendPaymentRequestToAdmin:sendInBlue_sendPaymentRequestToAdmin,getWishList:getWishList,deleteItemFromWishList:deleteItemFromWishList,addItemToWishListOfUser:addItemToWishListOfUser,isSellerInWishListOfUser:isSellerInWishListOfUser,getEmailOfSellerWithUid:getEmailOfSellerWithUid,checkoutStart:checkoutStart,getSaleTokenOfEventFromDb:getSaleTokenOfEventFromDb,checkoutCheck:checkoutCheck,getTotalAmountDueToSeller:getTotalAmountDueToSeller,homeSellersDisplay:homeSellersDisplay,setHomeSellersDisplay:setHomeSellersDisplay,getWishListCountOfSeller:getWishListCountOfSeller,getSellerPosition:getSellerPosition,getSellersCount:getSellersCount,sendInBlue_sendBillRequestToAdmin:sendInBlue_sendBillRequestToAdmin,addFoodTypeToSeller:addFoodTypeToSeller,deleteFoodTypeToSeller:deleteFoodTypeToSeller,isCardWidgetOpen:isCardWidgetOpen,setIsCardWidgetOpen:setIsCardWidgetOpen,checkoutSubscription:checkoutSubscription,refSellers:refSellers},children:!loading&&children});};","map":{"version":3,"sources":["/Users/bonnieclyde/Desktop/Copie de Nivid (1)/src/context/userContext.js"],"names":["React","createContext","useState","useEffect","useContext","firebase","useFirebase","publicIp","Stripe","functions","inputAdornmentClasses","SibApiV3Sdk","require","defaultClient","ApiClient","instance","myAPIKey","process","env","REACT_APP_SENDINBLUE_APIKEY","apiKey","authentications","partnerKey","apiInstance","ContactsApi","createContact","CreateContact","apiInstanceSend","TransactionalEmailsApi","sendSmtpEmail","SendSmtpEmail","UserContext","useAuth","UserProvider","children","firebaseContext","auth","provider","storage","firestore","datePlusYear","Date","setFullYear","getFullYear","initialEvent","name","date","startAt","endAt","people","placeSize","place","latLng","budget","budgetLeft","status","id","choosedServices","initialSeller","companyName","adress","siret","website","firstName","lastName","phone","description","category","subcategory","image_path","user","setUser","seller","setSeller","event","setEvent","loading","setLoading","currentStepProcess","setCurrentStepProcess","loadingButtonAddToCard","setLoadingButtonAddToCard","refUsers","collection","refEvents","refSellers","refSales","homeSellersDisplay","setHomeSellersDisplay","isCardWidgetOpen","setIsCardWidgetOpen","createStripeCheckout","httpsCallable","createStripeSubscribe","stripe","window","checkStripeReturn","onAuthStateChanged","data","handleAuthChanged","isThisUserSeller","uid","isSeller","isThisUserUser","isUser","getSellerDataFromDB","sellerData","getServicesOfCurrentSellerFromDB","sellerServices","services","emailVerified","getEvent","eventData","getChoosedServices","doc","get","query","result","exists","where","docs","length","item","forEach","toMillis","addEvent","myEvent","createEvent","myNewEvent","updateEvent","req","res","identifier","email","updateContact","attributes","NOTIF_DATE","EVENTID","then","error","console","add","docRef","getServices","delete","update","getBudgetLeft","totalPrice","variations","filter","vari","variation","price","quantity","push","queryPrice","neWObject","login","password","signInWithEmailAndPassword","verifyLogin","subscribe","tel","gender","birthDate","createUserWithEmailAndPassword","userData","updateProfile","displayName","set","catch","log","sendEmailVerification","sendInBlue_addContactSubscribe","code","sellerSubscribe","referral","referralToken","now","toString","substr","Math","random","updateSellerAfterReferralNewSeller","sendInBlue_sendToParrainAboutNewReferral","newSellerUid","docSeller","undefined","newSeller","logout","signOut","signInWithGoogle","signInWithPopup","credential","token","accessToken","currentUser","addToCard","sellerID","newEvent","refCurrentService","refService","service","find","itemCopy","newService","getServiceQuantityInCard","servicefiltered","count","updateQuantityService","serviceID","parseInt","formatLabelTimePicker","secs","minutes","floor","hours","slice","getAuthUserFromHisEmail","sendPasswordResetEmail","updateUserEmail","updateEmail","getCurrentUserProfil","updateCurrentUserProfil","setImageSellerDB","url","addSellerDescription","imgURL","addSellerServices","addOneSellerService","newResult","addSellerDocuments","documents","getSellerDocumentsFromDB","setSellerStatus","sellerId","updateSellerDocumentsStatus","newDocumentsArray","getSellersInDbWithUids","ids","sellers","deleteOldSellerPicture","tokens","type","imageRef","ref","child","addSalesInDB","sales","map","sale","getSalesOfEventIdFromDB","eventId","salesOfEvent","getSalesOfSellerIdFromDB","salesOfSeller","updateEventStatus","clearEvent","getEventOfSaleFromDB","reqServices","formateToDate","timestamp","year","getUTCFullYear","month","getMonth","day","getDate","formateToDateWithWords","seconds","formateToDateWithFullWords","updateSaleStatusInDB","saleID","saleUID","userID","req2","sendInBlue_sendNotificationToUserOfSaleStatus","updateSaleNote","note","dateTodayMinusByDay","setHours","getHours","addViewsOfSeller","v4","visitorIP","reqViews","recentViews","view","ip","getViewsOfSeller","isSellerAllowedToModifyAndDeleteService","sellerSales","isAllowed","deleteServiceOfSeller","updateSellerProfil","getSellerReferralCountFromDB","newArray","finalArray","getEventFromUid","getReviewsOfSellerUid","reviews","addReviewOfSellerUid","sellerUID","eventID","comment","eventDate","setTotalNoteOfSeller","reqReviews","reviewsCount","totalNote","sellerNote","toFixed","getSellerPosition","reqSellers","sellersWithNote","sort","a","b","index","findIndex","getSellersCount","listIds","PRENOM","NOM","UID","sendInBlue_sendRecapToUserAfterPayment","newSales","paid","total","newSale","to","params","templateId","headers","sendTransacEmail","sendInBlue_sendNewSaleToSeller","sendInBlue_sendNotificationToSellerOfReview","prestName","userName","getTotalAmountDueToSeller","validSales","prices","finalAmount","sendInBlue_sendPaymentRequestToAdmin","amount","REACT_APP_ADMIN_EMAIL","sendInBlue_sendBillRequestToAdmin","transactionID","transactionId","sendInBlue_addContactToNewsletter","sendInBlue_sendInvitations","emails","message","emailsArray","emailsArrayWithList","newEntry","newEntryList","EVENT_DATE","creneaux","prenom","nomEvent","adresse","invites","getWishList","wishlist","deleteItemFromWishList","newWishList","addItemToWishListOfUser","getWishListCountOfSeller","users","isSellerInWishListOfUser","currentWishList","isSellerInList","getEmailOfSellerWithUid","referralCode","checkoutStart","saleToken","response","sessionId","redirectToCheckout","checkoutSubscription","getSaleTokenOfEventFromDb","checkoutCheck","session_id","payment_status","amount_total","payment_intent","subscription","addFoodTypeToSeller","newFoodTypes","foodTypes","deleteFoodTypeToSeller","foodType","indexes","String","splice"],"mappings":"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","sourcesContent":["import React, { createContext, useState, useEffect, useContext } from \"react\";\r\nimport firebase from \"firebase/app\";\r\nimport { useFirebase } from \"../assets/base-context\";\r\nimport publicIp from \"public-ip\";\r\n\r\nimport Stripe from \"stripe\";\r\nimport functions from \"firebase/firebase-functions\";\r\nimport { inputAdornmentClasses } from \"@mui/material\";\r\n\r\nvar SibApiV3Sdk = require(\"sib-api-v3-sdk\");\r\n\r\nvar defaultClient = SibApiV3Sdk.ApiClient.instance;\r\n\r\nlet myAPIKey = process.env.REACT_APP_SENDINBLUE_APIKEY;\r\nvar apiKey = defaultClient.authentications[\"api-key\"];\r\napiKey.apiKey = myAPIKey;\r\n\r\nvar partnerKey = defaultClient.authentications[\"partner-key\"];\r\npartnerKey.apiKey = process.env.REACT_APP_SENDINBLUE_APIKEY;\r\n\r\nvar apiInstance = new SibApiV3Sdk.ContactsApi();\r\nvar createContact = new SibApiV3Sdk.CreateContact();\r\n\r\nvar apiInstanceSend = new SibApiV3Sdk.TransactionalEmailsApi();\r\nvar sendSmtpEmail = new SibApiV3Sdk.SendSmtpEmail();\r\n\r\n// Ce fichier comporte toutes les fonctions d'appels et de traitement bdd, et du context global.\r\n// Il englobe l'app dans App.js\r\n\r\nexport const UserContext = createContext();\r\n\r\nexport function useAuth() {\r\n  return useContext(UserContext);\r\n}\r\n\r\nexport const UserProvider = ({ children }) => {\r\n  const firebaseContext = useFirebase();\r\n  const auth = firebaseContext.auth();\r\n  const provider = firebaseContext.provider();\r\n  const storage = firebaseContext.storage();\r\n  const firestore = firebaseContext.firestore();\r\n\r\n  let datePlusYear = new Date();\r\n  datePlusYear.setFullYear(datePlusYear.getFullYear() + 1);\r\n\r\n  const initialEvent = {\r\n    name: \"\",\r\n    date: datePlusYear,\r\n    startAt: 0,\r\n    endAt: 86360,\r\n    people: 50,\r\n    placeSize: 250,\r\n    place: \"\",\r\n    latLng: [],\r\n    budget: 50,\r\n    budgetLeft: 0,\r\n    status: null,\r\n    id: null,\r\n    choosedServices: [],\r\n  };\r\n\r\n  const initialSeller = {\r\n    companyName: \"\",\r\n    adress: \"\",\r\n    siret: \"\",\r\n    website: \"\",\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    phone: \"\",\r\n    description: \"\",\r\n    category: \"\",\r\n    subcategory: \"\",\r\n    image_path: \"\",\r\n  };\r\n\r\n  const [user, setUser] = useState();\r\n  const [seller, setSeller] = useState(initialSeller);\r\n  const [event, setEvent] = useState(initialEvent);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [currentStepProcess, setCurrentStepProcess] = useState(0);\r\n  const [loadingButtonAddToCard, setLoadingButtonAddToCard] = useState(true);\r\n\r\n  const refUsers = firestore.collection(\"users\");\r\n  const refEvents = firestore.collection(\"events\");\r\n  const refSellers = firestore.collection(\"sellers\");\r\n  const refSales = firestore.collection(\"sales\");\r\n\r\n  const [homeSellersDisplay, setHomeSellersDisplay] = useState([]);\r\n\r\n  const [isCardWidgetOpen, setIsCardWidgetOpen] = useState(false);\r\n\r\n  const createStripeCheckout = user\r\n    ? firebase.functions().httpsCallable(\"createStripeCheckout\")\r\n    : null;\r\n  const createStripeSubscribe = firebase\r\n    .functions()\r\n    .httpsCallable(\"createStripeSubscribe\");\r\n  const stripe =\r\n    user || seller\r\n      ? window.Stripe(\r\n          \"pk_test_51InLbZBwyEuW61Pj3yTYQlp31JobhK9vIKh32GColDUhXcdtzaKhWF5mVRDa9SGw7HujSuEDPCwvh40GEuo6uJxA00iqmaUXQp\"\r\n        )\r\n      : null;\r\n\r\n  const checkStripeReturn =\r\n    user || seller\r\n      ? firebase.functions().httpsCallable(\"checkStripeReturn\")\r\n      : null;\r\n\r\n  useEffect(() => {\r\n    auth.onAuthStateChanged((data) => {\r\n      return handleAuthChanged(data);\r\n    });\r\n  }, []);\r\n\r\n  async function handleAuthChanged(data) {\r\n    if (data) {\r\n      const isSeller = await isThisUserSeller(data.uid);\r\n      const isUser = await isThisUserUser(data.uid);\r\n      if (isSeller && !isUser) {\r\n        const sellerData = await getSellerDataFromDB(data.uid);\r\n        const sellerServices = await getServicesOfCurrentSellerFromDB();\r\n        setSeller({\r\n          ...initialSeller,\r\n          ...data,\r\n          ...sellerData,\r\n          services: sellerServices,\r\n        });\r\n        setUser();\r\n        setLoading(false);\r\n      } else if (isUser && !isSeller) {\r\n        if (data.emailVerified === false) {\r\n          setUser();\r\n          setSeller();\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        setUser(data);\r\n        setSeller();\r\n        const eventData = await getEvent(data.uid);\r\n        eventData && eventData !== null\r\n          ? await getChoosedServices(eventData)\r\n          : setEvent(initialEvent);\r\n        setLoading(false);\r\n      } else if (isSeller && isUser) {\r\n        const sellerData = await getSellerDataFromDB(data.uid);\r\n        setSeller({ ...initialSeller, ...data, ...sellerData });\r\n        setUser(data);\r\n        const eventData = await getEvent(data.uid);\r\n        eventData && eventData !== null\r\n          ? await getChoosedServices(eventData)\r\n          : setEvent(initialEvent);\r\n        setLoading(false);\r\n      }\r\n    } else {\r\n      setSeller();\r\n      setUser();\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function getSellerDataFromDB(id) {\r\n    const query = await refSellers.doc(id).get();\r\n    const result = query.data();\r\n    return result;\r\n  }\r\n\r\n  async function isThisUserSeller(id) {\r\n    const doc = await refSellers.doc(id).get();\r\n    if (doc.exists) return true;\r\n    return false;\r\n  }\r\n\r\n  async function isThisUserUser(id) {\r\n    const doc = await refUsers.doc(id).get();\r\n    if (doc.exists) return true;\r\n    return false;\r\n  }\r\n\r\n  async function getEvent(uid) {\r\n    const getEvent = await refEvents.where(\"user\", \"==\", uid).get();\r\n    if (getEvent.docs.length > 0) {\r\n      let item = {};\r\n      getEvent.docs.forEach((doc) => {\r\n        const data = doc.data();\r\n        if (data.status && data.status !== \"passed\") {\r\n          item = { ...data };\r\n          item.date = data.date.toMillis();\r\n          item.id = doc.id;\r\n        }\r\n      });\r\n      return item && item.status && item.status !== \"passed\" ? item : null;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async function addEvent(item) {\r\n    const myEvent = { ...item };\r\n    delete myEvent.id;\r\n    let myNewEvent;\r\n\r\n    if (item.status !== \"creating\") {\r\n      myNewEvent = await createEvent(myEvent);\r\n    }\r\n\r\n    if (item.status === \"creating\") {\r\n      // event existant\r\n      myNewEvent = await updateEvent(item, myEvent);\r\n    }\r\n    await getChoosedServices(myNewEvent);\r\n  }\r\n\r\n  async function createEvent(myEvent) {\r\n    const req = await refUsers.doc(myEvent.user).get();\r\n    const res = req.data();\r\n    var identifier = res.email;\r\n\r\n    var updateContact = {\r\n      attributes: {\r\n        NOTIF_DATE: new Date(myEvent.date),\r\n        EVENTID: event.id,\r\n      },\r\n    };\r\n\r\n    apiInstance.updateContact(identifier, updateContact).then(\r\n      () => {},\r\n      (error) => {\r\n        console.error(error);\r\n      }\r\n    );\r\n\r\n    myEvent.status = \"creating\";\r\n    const docRef = await refEvents.add({\r\n      ...myEvent,\r\n      date: new Date(myEvent.date),\r\n    });\r\n    myEvent.id = docRef.id;\r\n    return myEvent;\r\n  }\r\n\r\n  async function updateEvent(item, myEvent) {\r\n    if (item.place !== event.place) {\r\n      const getServices = await refEvents\r\n        .doc(item.id)\r\n        .collection(\"services\")\r\n        .get();\r\n      getServices.docs.forEach(async (doc) => {\r\n        await refEvents\r\n          .doc(item.id)\r\n          .collection(\"services\")\r\n          .doc(doc.id)\r\n          .delete();\r\n      });\r\n    }\r\n\r\n    await refEvents.doc(item.id).update({\r\n      ...myEvent,\r\n      date: new Date(myEvent.date),\r\n    });\r\n    myEvent.id = item.id;\r\n    return myEvent;\r\n  }\r\n\r\n  async function getBudgetLeft(budget, choosedServices) {\r\n    let totalPrice = 0;\r\n    choosedServices.forEach((item) => {\r\n      if (item.variations && item.variations.length > 0) {\r\n        totalPrice +=\r\n          item.variations.filter((vari) => vari.name === item.variation)[0]\r\n            .price * item.quantity;\r\n      } else totalPrice += item.price * item.quantity;\r\n    });\r\n    const result = budget - totalPrice;\r\n    return result;\r\n  }\r\n\r\n  async function getChoosedServices(item) {\r\n    let choosedServices = [];\r\n    const services = await refEvents.doc(item.id).collection(\"services\").get();\r\n    services.forEach((doc) => {\r\n      choosedServices.push({ ...doc.data(), uid: doc.id });\r\n    });\r\n    const queryPrice = await getBudgetLeft(item.budget, choosedServices);\r\n    const neWObject = {\r\n      ...item,\r\n      budgetLeft: queryPrice,\r\n      choosedServices: choosedServices,\r\n    };\r\n    return setEvent(neWObject);\r\n  }\r\n\r\n  async function login(email, password) {\r\n    return await auth\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then((data) => {\r\n        if (data.user.emailVerified === false) {\r\n          setSeller();\r\n          setUser();\r\n          return false;\r\n        }\r\n        setUser(data.user);\r\n        return true;\r\n      });\r\n  }\r\n\r\n  async function verifyLogin(email, password) {\r\n    const data = await auth.signInWithEmailAndPassword(email, password);\r\n    return data;\r\n  }\r\n\r\n  async function subscribe(\r\n    email,\r\n    password,\r\n    firstName,\r\n    name,\r\n    tel,\r\n    gender,\r\n    birthDate\r\n  ) {\r\n    return auth\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then(async (userData) => {\r\n        await userData.user.updateProfile({\r\n          displayName: firstName,\r\n        });\r\n        await refUsers\r\n          .doc(userData.user.uid)\r\n          .set({\r\n            firstName: firstName,\r\n            name: name,\r\n            tel: tel,\r\n            gender: gender,\r\n            birthDate: birthDate,\r\n            email: email,\r\n          })\r\n          .catch((error) => {\r\n            return console.log(error);\r\n          });\r\n        userData.user.sendEmailVerification();\r\n        setUser();\r\n        setSeller();\r\n        sendInBlue_addContactSubscribe(email, firstName);\r\n        return true;\r\n      })\r\n      .catch((error) => {\r\n        return error.code;\r\n      });\r\n  }\r\n\r\n  async function sellerSubscribe(\r\n    companyName,\r\n    adress,\r\n    siret,\r\n    website,\r\n    firstName,\r\n    lastName,\r\n    email,\r\n    phone,\r\n    password,\r\n    latLng,\r\n    referral\r\n  ) {\r\n    const referralToken =\r\n      Date.now().toString().substr(0, 5) +\r\n      Math.random().toString().substr(2, 7);\r\n    return auth\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then(async (userData) => {\r\n        await userData.user.updateProfile({\r\n          displayName: firstName,\r\n        });\r\n        await refSellers\r\n          .doc(userData.user.uid)\r\n          .set({\r\n            companyName: companyName,\r\n            adress: adress,\r\n            latLng: latLng,\r\n            siret: siret,\r\n            website: website,\r\n            firstName: firstName,\r\n            lastName: lastName,\r\n            phone: phone,\r\n            email: email,\r\n            image_path: \"\",\r\n            status: \"subscribing\",\r\n            referralToken: referralToken,\r\n            referral: referral,\r\n          })\r\n          .catch((error) => {\r\n            return console.log(error);\r\n          });\r\n        if (referral.length === 12) {\r\n          await updateSellerAfterReferralNewSeller(referral, userData.user.uid);\r\n          sendInBlue_sendToParrainAboutNewReferral(referral);\r\n        }\r\n        sendInBlue_addContactSubscribe(\r\n          email,\r\n          firstName,\r\n          lastName,\r\n          userData.user.uid\r\n        );\r\n        setUser();\r\n        setSeller({\r\n          companyName: companyName,\r\n          adress: adress,\r\n          latLng: latLng,\r\n          siret: siret,\r\n          website: website,\r\n          firstName: firstName,\r\n          lastName: lastName,\r\n          phone: phone,\r\n          email: email,\r\n          image_path: \"\",\r\n          status: \"subscribing\",\r\n          referralToken: referralToken,\r\n          referral: referral,\r\n          uid: userData.user.uid\r\n        });\r\n        userData.user.sendEmailVerification();\r\n        return true;\r\n      })\r\n      .catch((error) => {\r\n        return error.code;\r\n      });\r\n  }\r\n\r\n  async function updateSellerAfterReferralNewSeller(referral, newSellerUid) {\r\n    const docs = await refSellers.where(\"referralToken\", \"==\", referral).get();\r\n    let docSeller = {};\r\n    docs.forEach((doc) => {\r\n      docSeller = { ...doc.data(), uid: doc.id };\r\n    });\r\n    if (\r\n      docSeller.uid !== undefined &&\r\n      docSeller.uid !== null &&\r\n      docSeller.uid.length > 10\r\n    ) {\r\n      refSellers\r\n        .doc(docSeller.uid)\r\n        .collection(\"referral\")\r\n        .add({\r\n          newSeller: newSellerUid,\r\n          date: Date.now(),\r\n        })\r\n        .catch((error) => {\r\n          return console.log(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  function logout() {\r\n    return auth.signOut();\r\n  }\r\n\r\n  async function signInWithGoogle() {\r\n    const result = await auth.signInWithPopup(provider);\r\n    /** @type {firebase.auth.OAuthCredential} */\r\n    var credential = result.credential;\r\n\r\n    // This gives you a Google Access Token. You can use it to access the Google API.\r\n    var token = credential.accessToken;\r\n    // The signed-in user info.\r\n    var user = result.user;\r\n    var doc = await refUsers.doc(user.uid).get();\r\n    if (doc.exists) {\r\n      setUser(auth.currentUser);\r\n    } else {\r\n      await refUsers.doc(user.uid).set({\r\n        firstName: user.displayName,\r\n        email: user.email,\r\n      });\r\n      setUser(auth.currentUser);\r\n    }\r\n  }\r\n\r\n  // Ajouter un service au panier ( BBD et state )\r\n  async function addToCard(sellerID, item, quantity) {\r\n    // Checkons si ce service est deja present dans la liste de cette event\r\n    const newEvent = { ...event };\r\n\r\n    const refCurrentService = refEvents.doc(event.id).collection(\"services\");\r\n\r\n    const doc = await refCurrentService\r\n      .where(\"id\", \"==\", item.id)\r\n      .where(\"variation\", \"==\", item.variation)\r\n      .get();\r\n    const refService = doc.exists && doc.data();\r\n\r\n    // Si le service existe dans les service séléctionnés pour cet event, on actualise juste en renseignant la nouvelle quantity ( BBD et state )\r\n    if (doc.docs.length > 0) {\r\n      await refCurrentService\r\n        .doc(doc.docs[0].id)\r\n        .update({ quantity: quantity });\r\n      //Ici on chope le service concerné dans le state, puis on le modifie pour ajouter la quantity, et on actualise le state\r\n      const services = [...event.choosedServices];\r\n      const service = services.find(\r\n        (service) =>\r\n          service.variation === item.variation && service.id === item.id\r\n      );\r\n      service.quantity = quantity;\r\n      newEvent.choosedServices = services;\r\n      getChoosedServices(newEvent);\r\n      setLoadingButtonAddToCard(false);\r\n    }\r\n    // Mais si le service n'existe pas, on l'ajoute completement ( BBD et state )\r\n    else {\r\n      const itemCopy = { ...item };\r\n      itemCopy.quantity = quantity;\r\n      const newService = [];\r\n      await refCurrentService.add(itemCopy);\r\n      newService.push(item);\r\n      newEvent.choosedServices.push(newService[0]);\r\n      getChoosedServices(newEvent);\r\n      setLoadingButtonAddToCard(false);\r\n    }\r\n    setIsCardWidgetOpen(true);\r\n  }\r\n\r\n  function getServiceQuantityInCard(id) {\r\n    const services = [...event.choosedServices];\r\n    const servicefiltered = services.filter((service) => service.id === id);\r\n    let count = 0;\r\n    if (servicefiltered.length > 1)\r\n      servicefiltered.forEach((service) => (count += service.quantity));\r\n    else if (servicefiltered.length > 0) count += servicefiltered[0].quantity;\r\n    return count;\r\n  }\r\n\r\n  async function updateQuantityService(serviceID, quantity) {\r\n    if (quantity === undefined) return;\r\n    quantity = parseInt(quantity);\r\n\r\n    if (quantity !== 0) {\r\n      await refEvents\r\n        .doc(event.id)\r\n        .collection(\"services\")\r\n        .doc(serviceID)\r\n        .update({ quantity: quantity });\r\n    } else {\r\n      await refEvents\r\n        .doc(event.id)\r\n        .collection(\"services\")\r\n        .doc(serviceID)\r\n        .delete();\r\n    }\r\n\r\n    const eventData = await getEvent(auth.currentUser.uid);\r\n    await getChoosedServices(eventData);\r\n    setLoading(false);\r\n    return;\r\n  }\r\n\r\n  function formatLabelTimePicker(secs) {\r\n    if (secs === 86400) secs = 86360;\r\n    var minutes = Math.floor(secs / 60);\r\n    var hours = Math.floor(minutes / 60);\r\n    minutes = minutes % 60;\r\n    return `${hours}:${(\"0\" + minutes).slice(-2)}`;\r\n  }\r\n\r\n  async function getAuthUserFromHisEmail(email) {\r\n    return auth\r\n      .sendPasswordResetEmail(email)\r\n      .then(() => {\r\n        return true;\r\n      })\r\n      .catch(function (error) {\r\n        if (error.code === \"auth/invalid-email\") {\r\n          return \"invalid\";\r\n        } else if (error.code === \"auth/user-not-found\") {\r\n          return \"notexist\";\r\n        }\r\n      });\r\n  }\r\n\r\n  async function updateUserEmail(email) {\r\n    var user = auth.currentUser;\r\n    await user.updateEmail(email);\r\n    await refUsers.doc(user.uid).update({ email: email });\r\n    await user.sendEmailVerification();\r\n    return true;\r\n  }\r\n\r\n  async function getCurrentUserProfil() {\r\n    var uid = auth.currentUser.uid;\r\n    const doc = await refUsers.doc(uid).get();\r\n    return doc.exists ? doc.data() : null;\r\n  }\r\n\r\n  async function updateCurrentUserProfil(data) {\r\n    var uid = auth.currentUser.uid;\r\n    refUsers.doc(uid).update(data);\r\n    user.updateProfile({\r\n      displayName: data.firstName,\r\n    });\r\n  }\r\n\r\n  async function setImageSellerDB(url, token) {\r\n    await refSellers.doc(auth.currentUser.uid).update({\r\n      image_path: { url: url, token: token },\r\n    });\r\n  }\r\n\r\n  async function addSellerDescription(data, imgURL) {\r\n    await refSellers.doc(auth.currentUser.uid).update({\r\n      description: data.description,\r\n      category: data.category,\r\n      subcategory: data.subcategory,\r\n    });\r\n    setSeller({\r\n      ...seller,\r\n      description: data.description,\r\n      category: data.category,\r\n      subcategory: data.subcategory,\r\n      image_path: imgURL !== null && imgURL,\r\n    });\r\n  }\r\n\r\n  async function addSellerServices(services) {\r\n    setSeller({ ...seller, services: services });\r\n    services.forEach(async (service) => {\r\n      if (service.id.length > 2) {\r\n        return await refSellers\r\n          .doc(auth.currentUser.uid)\r\n          .collection(\"services\")\r\n          .doc(service.id)\r\n          .update(service);\r\n      }\r\n      return await refSellers\r\n        .doc(auth.currentUser.uid)\r\n        .collection(\"services\")\r\n        .add(service);\r\n    });\r\n  }\r\n\r\n  async function addOneSellerService(service) {\r\n    if (service.id.length > 2) {\r\n      return await refSellers\r\n        .doc(auth.currentUser.uid)\r\n        .collection(\"services\")\r\n        .doc(service.id)\r\n        .update(service);\r\n    }\r\n    const docRef = await refSellers\r\n      .doc(auth.currentUser.uid)\r\n      .collection(\"services\")\r\n      .add(service);\r\n    return docRef.id;\r\n  }\r\n\r\n  async function getServicesOfCurrentSellerFromDB() {\r\n    const services = await refSellers\r\n      .doc(auth.currentUser.uid)\r\n      .collection(\"services\")\r\n      .get();\r\n    var result = [];\r\n    services.docs.forEach((doc) => {\r\n      const newResult = { ...doc.data(), id: doc.id };\r\n      result.push(newResult);\r\n    });\r\n    return result;\r\n  }\r\n\r\n  async function addSellerDocuments(documents) {\r\n    return await refSellers.doc(auth.currentUser.uid).update({\r\n      documents: documents,\r\n    });\r\n  }\r\n\r\n  async function getSellerDocumentsFromDB() {\r\n    const query = await refSellers.doc(auth.currentUser.uid).get();\r\n    const doc = query.data();\r\n    const result = doc.documents && doc.documents;\r\n    if (result === undefined) return null;\r\n    return result;\r\n  }\r\n\r\n  async function setSellerStatus(sellerId, status) {\r\n    await refSellers.doc(sellerId).update({\r\n      status: status,\r\n    });\r\n    return setSeller({ ...seller, status: status });\r\n  }\r\n\r\n  async function updateSellerDocumentsStatus(sellerId, newDocumentsArray) {\r\n    await refSellers.doc(sellerId).update({\r\n      documents: newDocumentsArray,\r\n    });\r\n\r\n    newDocumentsArray.status === \"rejected\" &&\r\n      (await refSellers.doc(sellerId).update({\r\n        status: \"subscribing\",\r\n      }));\r\n  }\r\n\r\n  async function getSellersInDbWithUids(ids) {\r\n    let sellers = [];\r\n    for (const id in ids) {\r\n      const req = await refSellers.doc(ids[id]).get();\r\n      let result = req.data();\r\n      result.uid = req.id;\r\n      sellers = [...sellers, result];\r\n      if (sellers.length === ids.length) {\r\n        return sellers;\r\n      }\r\n    }\r\n  }\r\n\r\n  // TODO ICi on a la fonction pour delete la photo de profil qu'on ecrase en a remplaceant, faudra faire la meme avec les autres endroits du site avec uploda de picture\r\n  async function deleteOldSellerPicture(tokens, type) {\r\n    tokens.forEach((token) => {\r\n      var imageRef =\r\n        type && type === \"services\"\r\n          ? storage.ref(\"services\").child(token)\r\n          : storage.ref(\"sellers\").child(token);\r\n      imageRef.delete().catch((error) => console.log(error));\r\n    });\r\n  }\r\n\r\n  async function addSalesInDB(sales) {\r\n    return sales.map(async (sale) => await refSales.add(sale));\r\n  }\r\n\r\n  async function getSalesOfEventIdFromDB(eventId) {\r\n    const req = await refSales.where(\"eventID\", \"==\", eventId).get();\r\n    let salesOfEvent = [];\r\n    req.forEach((doc) => salesOfEvent.push(doc.data()));\r\n    return salesOfEvent;\r\n  }\r\n\r\n  async function getSalesOfSellerIdFromDB(sellerId) {\r\n    const req = await refSales.where(\"sellerID\", \"==\", sellerId).get();\r\n    let salesOfSeller = [];\r\n    req.forEach((doc) => salesOfSeller.push(doc.data()));\r\n    return salesOfSeller;\r\n  }\r\n\r\n  async function updateEventStatus(status) {\r\n    await refEvents.doc(event.id).update({ status: status });\r\n    return setEvent({ ...event, status: status });\r\n  }\r\n\r\n  async function clearEvent() {\r\n    setEvent(initialEvent);\r\n  }\r\n\r\n  async function getEventOfSaleFromDB(eventId) {\r\n    const req = await refEvents.doc(eventId).get();\r\n    let newEvent = req.data();\r\n    newEvent.choosedServices = [];\r\n\r\n    const reqServices = await refEvents\r\n      .doc(eventId)\r\n      .collection(\"services\")\r\n      .get();\r\n    reqServices.forEach((doc) => {\r\n      newEvent.choosedServices = [...newEvent.choosedServices, doc.data()];\r\n    });\r\n    return newEvent;\r\n  }\r\n\r\n  function formateToDate(timestamp) {\r\n    const date = new Date(timestamp);\r\n    const year = date.getUTCFullYear();\r\n    const month = date.getMonth() + 1;\r\n    const day = date.getDate();\r\n    return `${day}/${month < 10 ? \"0\" : \"\"}${month}/${year}`;\r\n  }\r\n\r\n  function formateToDateWithWords(timestamp) {\r\n    const date = new Date(\r\n      timestamp.seconds ? timestamp.seconds * 1000 : timestamp\r\n    );\r\n    const year = date.getUTCFullYear();\r\n    let month = date.getMonth() + 1;\r\n    const day = date.getDate();\r\n    month =\r\n      month === 1\r\n        ? \"janv\"\r\n        : month === 2\r\n        ? \"févr\"\r\n        : month === 3\r\n        ? \"mars\"\r\n        : month === 4\r\n        ? \"avril\"\r\n        : month === 5\r\n        ? \"mai\"\r\n        : month === 6\r\n        ? \"juin\"\r\n        : month === 7\r\n        ? \"juil\"\r\n        : month === 8\r\n        ? \"aout\"\r\n        : month === 9\r\n        ? \"sept\"\r\n        : month === 10\r\n        ? \"oct\"\r\n        : month === 11\r\n        ? \"nov\"\r\n        : month === 12 && \"déc\";\r\n    return `${day} ${month} ${year}`;\r\n  }\r\n\r\n  function formateToDateWithFullWords(timestamp) {\r\n    const date = new Date(timestamp);\r\n    const year = date.getUTCFullYear();\r\n    let month = date.getMonth() + 1;\r\n    const day = date.getDate();\r\n    month =\r\n      month === 1\r\n        ? \"janvier\"\r\n        : month === 2\r\n        ? \"février\"\r\n        : month === 3\r\n        ? \"mars\"\r\n        : month === 4\r\n        ? \"avril\"\r\n        : month === 5\r\n        ? \"mai\"\r\n        : month === 6\r\n        ? \"juin\"\r\n        : month === 7\r\n        ? \"juillet\"\r\n        : month === 8\r\n        ? \"aout\"\r\n        : month === 9\r\n        ? \"septembre\"\r\n        : month === 10\r\n        ? \"octobre\"\r\n        : month === 11\r\n        ? \"novembre\"\r\n        : month === 12 && \"décembre\";\r\n    return `${day} ${month} ${year}`;\r\n  }\r\n\r\n  async function updateSaleStatusInDB(saleID, sellerID, status) {\r\n    const req = await refSales\r\n      .where(\"sellerID\", \"==\", sellerID)\r\n      .where(\"id\", \"==\", saleID)\r\n      .get();\r\n    let saleUID;\r\n    let userID;\r\n    let sale;\r\n    req.forEach((doc) => {\r\n      sale = doc.data();\r\n      saleUID = doc.id;\r\n      userID = sale.userID;\r\n    });\r\n    const req2 = await refUsers.doc(userID).get();\r\n    const user = req2.data();\r\n    await refSales.doc(saleUID).update({ status });\r\n    sendInBlue_sendNotificationToUserOfSaleStatus(\r\n      user,\r\n      seller.companyName,\r\n      sale\r\n    );\r\n  }\r\n\r\n  async function updateSaleNote(saleID, note) {\r\n    const req = await refSales\r\n      .where(\"sellerID\", \"==\", auth.currentUser.uid)\r\n      .where(\"id\", \"==\", saleID)\r\n      .get();\r\n    let saleUID;\r\n    req.forEach((doc) => (saleUID = doc.id));\r\n    await refSales.doc(saleUID).update({ note });\r\n    return;\r\n  }\r\n\r\n  function dateTodayMinusByDay(day) {\r\n    const date = new Date();\r\n    date.setHours(date.getHours() - 24 * day);\r\n    return date;\r\n  }\r\n\r\n  async function addViewsOfSeller(sellerID) {\r\n    const visitorIP = await publicIp.v4();\r\n    const reqViews = await refSellers.doc(sellerID).collection(\"views\").get();\r\n\r\n    let recentViews = [];\r\n\r\n    reqViews.forEach(async (doc) => {\r\n      const view = doc.data();\r\n      if (\r\n        view.ip === visitorIP &&\r\n        view.date.seconds * 1000 > dateTodayMinusByDay(1)\r\n      ) {\r\n        recentViews = [...recentViews, view];\r\n      }\r\n    });\r\n    if (recentViews.length === 0) {\r\n      await refSellers\r\n        .doc(sellerID)\r\n        .collection(\"views\")\r\n        .add({\r\n          date: new Date(Date.now()),\r\n          ip: visitorIP,\r\n        });\r\n    }\r\n  }\r\n\r\n  async function getViewsOfSeller(sellerID) {\r\n    const reqViews = await refSellers.doc(sellerID).collection(\"views\").get();\r\n    let res = [];\r\n    reqViews.forEach((doc) => res.push(doc.data()));\r\n    return res;\r\n  }\r\n\r\n  async function isSellerAllowedToModifyAndDeleteService(serviceID) {\r\n    const req = await refSales\r\n      .where(\"sellerID\", \"==\", auth.currentUser.uid)\r\n      .get();\r\n    let sellerSales = [];\r\n    req.forEach((doc) => sellerSales.push(doc.data()));\r\n\r\n    let isAllowed = true;\r\n    sellerSales.forEach((sale) => {\r\n      if (sale.status !== \"passed\" && sale.status !== \"rejected\") {\r\n        sale.choosedServices.forEach((service) => {\r\n          if (service.id === serviceID) isAllowed = false;\r\n        });\r\n      }\r\n    });\r\n    return isAllowed;\r\n  }\r\n\r\n  async function deleteServiceOfSeller(serviceID) {\r\n    return await refSellers\r\n      .doc(auth.currentUser.uid)\r\n      .collection(\"services\")\r\n      .doc(serviceID)\r\n      .delete();\r\n  }\r\n\r\n  async function updateSellerProfil(data) {\r\n    await auth.currentUser.updateProfile({\r\n      displayName: data.firstName,\r\n    });\r\n    await refSellers.doc(auth.currentUser.uid).update({\r\n      companyName: data.companyName,\r\n      website: data.website,\r\n      firstName: data.firstName,\r\n      lastName: data.lastName,\r\n      phone: data.phone,\r\n    });\r\n    return setSeller({\r\n      ...seller,\r\n      companyName: data.companyName,\r\n      website: data.website,\r\n      firstName: data.firstName,\r\n      lastName: data.lastName,\r\n      phone: data.phone,\r\n    });\r\n  }\r\n\r\n  async function getSellerReferralCountFromDB() {\r\n    const res = await refSellers\r\n      .doc(auth.currentUser.uid)\r\n      .collection(\"referral\")\r\n      .get();\r\n    let newArray = [];\r\n    res.forEach((doc) => newArray.push(doc.data()));\r\n\r\n    let finalArray = [];\r\n    for (const item of newArray) {\r\n      const req = await refSellers.doc(item.newSeller).get();\r\n      const res = req.data();\r\n      if (res.status === \"opened\") finalArray = [...finalArray, res];\r\n    }\r\n    return finalArray.length;\r\n  }\r\n\r\n  async function getEventFromUid(uid) {\r\n    const req = await refEvents.doc(uid).get();\r\n    return req.data();\r\n  }\r\n\r\n  async function getReviewsOfSellerUid(uid) {\r\n    const req = await refSellers.doc(uid).collection(\"reviews\").get();\r\n    let reviews = [];\r\n    req.forEach((doc) => reviews.push(doc.data()));\r\n    return reviews;\r\n  }\r\n\r\n  async function addReviewOfSellerUid(sellerUID, eventID, note, comment, name) {\r\n    return await refSellers\r\n      .doc(sellerUID)\r\n      .collection(\"reviews\")\r\n      .add({\r\n        eventID: eventID,\r\n        note: note,\r\n        comment: comment,\r\n        name: name,\r\n        date: new Date(),\r\n        eventDate: event.date,\r\n      })\r\n      .then((res) => {\r\n        setTotalNoteOfSeller(sellerUID);\r\n        return true;\r\n      })\r\n      .catch((error) => console.log(error));\r\n  }\r\n\r\n  async function setTotalNoteOfSeller(sellerUID) {\r\n    const reqReviews = await refSellers\r\n      .doc(sellerUID)\r\n      .collection(\"reviews\")\r\n      .get();\r\n    const reviewsCount = reqReviews.docs.length;\r\n    let totalNote = 0;\r\n    reqReviews.forEach((doc) => {\r\n      const data = doc.data();\r\n      totalNote += data.note;\r\n    });\r\n    let sellerNote = totalNote / reviewsCount;\r\n    sellerNote = sellerNote.toFixed();\r\n    await refSellers.doc(sellerUID).update({\r\n      note: sellerNote,\r\n    });\r\n    return true;\r\n  }\r\n\r\n  async function getSellerPosition(sellerUID) {\r\n    const reqSellers = await refSellers.get();\r\n    let sellersWithNote = [];\r\n    reqSellers.forEach((doc) => {\r\n      const data = doc.data();\r\n      if (data.note === undefined) return;\r\n      const seller = { note: data.note, id: doc.id };\r\n      sellersWithNote.push(seller);\r\n    });\r\n\r\n    sellersWithNote.sort((a, b) => {\r\n      if (a.note > b.note) return -1;\r\n      if (a.note < b.note) return 1;\r\n      return 0;\r\n    });\r\n    const index = sellersWithNote.findIndex((item) => item.id === sellerUID);\r\n    return index + 1;\r\n  }\r\n\r\n  async function getSellersCount() {\r\n    const req = await refSellers.get();\r\n    return req.docs.length;\r\n  }\r\n\r\n  async function sendInBlue_addContactSubscribe(\r\n    email,\r\n    firstName,\r\n    lastName,\r\n    uid\r\n  ) {\r\n    createContact = {\r\n      email: email,\r\n      listIds: [4],\r\n      attributes: {\r\n        PRENOM: firstName,\r\n        NOM: lastName && lastName,\r\n        UID: uid ? uid : 0,\r\n      },\r\n    };\r\n\r\n    apiInstance.createContact(createContact).then(\r\n      function (data) {\r\n        console.log(\"API called successfully.\");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_sendRecapToUserAfterPayment(email, sales, event) {\r\n    let newSales = [];\r\n    let paid = 0;\r\n    let total = 0;\r\n    sales.forEach((sale) => {\r\n      refSellers\r\n        .doc(sale.sellerID)\r\n        .get()\r\n        .then((doc) => {\r\n          const seller = doc.data();\r\n          const newSale = { ...sale, name: seller.companyName };\r\n          newSales = [...newSales, newSale];\r\n\r\n          total = total + sale.total;\r\n          paid = paid + sale.paid;\r\n        });\r\n    });\r\n\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: email,\r\n        },\r\n      ],\r\n      params: {\r\n        sales: newSales,\r\n        event: event,\r\n        paid: paid,\r\n        total: total,\r\n      },\r\n      templateId: 10,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_sendNewSaleToSeller(email, services, event) {\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: email,\r\n        },\r\n      ],\r\n      params: {\r\n        services: services,\r\n        event: event,\r\n      },\r\n      templateId: 12,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_sendNotificationToSellerOfReview(email, name) {\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: email,\r\n        },\r\n      ],\r\n      params: {\r\n        name: name,\r\n      },\r\n      templateId: 4,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_sendNotificationToUserOfSaleStatus(\r\n    user,\r\n    prestName,\r\n    sale\r\n  ) {\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: user.email,\r\n        },\r\n      ],\r\n      params: {\r\n        prestName: prestName,\r\n        userName: user.firstName,\r\n        services: sale.choosedServices,\r\n      },\r\n      templateId:\r\n        sale.status === \"rejected\" ? 8 : sale.status === \"validated\" && 9,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async function getTotalAmountDueToSeller(sellerId) {\r\n    const req = await refSales\r\n      .where(\r\n        \"sellerID\",\r\n        \"==\",\r\n        sellerId !== undefined ? sellerId : auth.currentUser.uid\r\n      )\r\n      .get();\r\n    let salesOfSeller = [];\r\n    req.forEach((doc) => {\r\n      salesOfSeller = [...salesOfSeller, doc.data()];\r\n    });\r\n    const validSales = salesOfSeller.filter(\r\n      (sale) => sale.total === sale.paid && sale.status === \"validated\"\r\n    ); // à mettre en passed je pense\r\n    const prices = validSales.map((sale) => sale.price);\r\n    let finalAmount = 0;\r\n    prices.forEach((price) => {\r\n      finalAmount = finalAmount + price;\r\n    });\r\n    return finalAmount;\r\n  }\r\n\r\n  async function sendInBlue_sendPaymentRequestToAdmin(sellerId) {\r\n    const amount = await getTotalAmountDueToSeller(sellerId);\r\n\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: process.env.REACT_APP_ADMIN_EMAIL,\r\n        },\r\n      ],\r\n      params: {\r\n        sellerId: sellerId,\r\n        amount: amount,\r\n      },\r\n      templateId: 16,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_sendBillRequestToAdmin(transactionID, sellerID) {\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: process.env.REACT_APP_ADMIN_EMAIL,\r\n        },\r\n      ],\r\n      params: {\r\n        sellerId: sellerID,\r\n        transactionId: transactionID,\r\n      },\r\n      templateId: 17,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"Content-Type:application/json|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    return apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n        return true;\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n        return false;\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_addContactToNewsletter(email) {\r\n    createContact = {\r\n      email: email,\r\n      listIds: [5],\r\n    };\r\n\r\n    return apiInstance.createContact(createContact).then(\r\n      function (data) {\r\n        return true;\r\n      },\r\n      function (error) {\r\n        console.log(error);\r\n        return false;\r\n      }\r\n    );\r\n  }\r\n\r\n  async function sendInBlue_sendInvitations(emails, message, user, event) {\r\n    let emailsArray = [];\r\n    let emailsArrayWithList = [];\r\n    emails.forEach((email) => {\r\n      const newEntry = { email: email };\r\n      const newEntryList = {\r\n        email: email,\r\n        listIds: [6],\r\n        attributes: {\r\n          EVENT_DATE: new Date(event.date),\r\n        },\r\n      };\r\n      emailsArray = [...emailsArray, newEntry];\r\n      emailsArrayWithList = [...emailsArrayWithList, newEntryList];\r\n    });\r\n\r\n    const eventDate = formateToDateWithFullWords(event.date);\r\n    const startAt = formatLabelTimePicker(event.startAt);\r\n    const endAt = formatLabelTimePicker(event.endAt);\r\n    const creneaux = startAt + \" et \" + endAt;\r\n\r\n    sendSmtpEmail = {\r\n      to: emailsArray,\r\n      params: {\r\n        prenom: user.displayName,\r\n        message: message,\r\n        nomEvent: event.name,\r\n        adresse: event.place,\r\n        invites: event.people,\r\n        date: eventDate,\r\n        creneaux: creneaux,\r\n      },\r\n      templateId: 7,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    return apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        return true;\r\n      },\r\n      function (error) {\r\n        return false;\r\n      }\r\n    );\r\n  }\r\n\r\n  async function getWishList(userID) {\r\n    const req = await refUsers.doc(userID).get();\r\n    const res = req.data();\r\n    return res.wishlist || [];\r\n  }\r\n\r\n  async function deleteItemFromWishList(sellerID) {\r\n    let newWishList = await getWishList(auth.currentUser.uid);\r\n    newWishList = newWishList.filter((item) => item !== sellerID);\r\n    await refUsers.doc(auth.currentUser.uid).update({\r\n      wishlist: newWishList,\r\n    });\r\n    return newWishList;\r\n  }\r\n\r\n  async function addItemToWishListOfUser(sellerID) {\r\n    let newWishList = await getWishList(auth.currentUser.uid);\r\n    newWishList = [...newWishList, sellerID];\r\n    refUsers.doc(auth.currentUser.uid).update({\r\n      wishlist: newWishList,\r\n    });\r\n    return;\r\n  }\r\n\r\n  async function getWishListCountOfSeller(sellerID) {\r\n    const users = await refUsers\r\n      .where(\"wishlist\", \"array-contains\", sellerID)\r\n      .get();\r\n    return users.docs.length;\r\n  }\r\n\r\n  async function isSellerInWishListOfUser(id) {\r\n    const currentWishList = await getWishList(auth.currentUser.uid);\r\n    const isSellerInList = currentWishList.filter((item) => item === id);\r\n\r\n    return isSellerInList.length > 0 ? true : false;\r\n  }\r\n\r\n  async function getEmailOfSellerWithUid(sellerID) {\r\n    const query = await refSellers.doc(sellerID).get();\r\n    const result = query.data();\r\n    return result.email;\r\n  }\r\n\r\n  async function sendInBlue_sendToParrainAboutNewReferral(referralCode) {\r\n    // Aller choper en bdd le seller correspondant au referral code\r\n    const query = await refSellers\r\n      .where(\"referralToken\", \"==\", referralCode)\r\n      .get();\r\n    const result = query[0].data();\r\n    const email = result.email;\r\n\r\n    // Puis envoyer à ce seller le mail de new referral\r\n    sendSmtpEmail = {\r\n      to: [\r\n        {\r\n          email: email,\r\n        },\r\n      ],\r\n      params: {\r\n        name: \"a\",\r\n      },\r\n      templateId: 14,\r\n      headers: {\r\n        \"X-Mailin-custom\":\r\n          \"custom_header_1:custom_value_1|custom_header_2:custom_value_2\",\r\n      },\r\n    };\r\n\r\n    apiInstanceSend.sendTransacEmail(sendSmtpEmail).then(\r\n      function (data) {\r\n        console.log(\"API called successfully. Returned data: \");\r\n      },\r\n      function (error) {\r\n        console.error(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  function checkoutStart(price) {\r\n    const saleToken =\r\n      Date.now().toString().substr(0, 9) +\r\n      Math.random().toString().substr(2, 9);\r\n    refEvents.doc(event.id).update({\r\n      saleToken: saleToken,\r\n    });\r\n    createStripeCheckout({\r\n      price: price,\r\n      eventId: event.id,\r\n      saleToken: saleToken,\r\n    })\r\n      .then((response) => {\r\n        const sessionId = response.data.id;\r\n        stripe.redirectToCheckout({ sessionId: sessionId });\r\n      })\r\n      .catch((error) => console.log(error));\r\n  }\r\n\r\n  function checkoutSubscription() {\r\n    const saleToken =\r\n      Date.now().toString().substr(0, 9) +\r\n      Math.random().toString().substr(2, 9);\r\n    refSellers.doc(seller.uid).update({\r\n      saleToken: saleToken,\r\n    });\r\n    createStripeSubscribe({\r\n      sellerID: seller.uid,\r\n      saleToken: saleToken,\r\n    })\r\n      .then((response) => {\r\n        const sessionId = response.data.id;\r\n        stripe.redirectToCheckout({ sessionId: sessionId });\r\n      })\r\n      .catch((error) => console.log(error));\r\n  }\r\n\r\n  async function getSaleTokenOfEventFromDb() {\r\n    const req = await refEvents.doc(event.id).get();\r\n    const res = req.data();\r\n    return res.saleToken;\r\n  }\r\n\r\n  async function checkoutCheck(session_id) {\r\n    return checkStripeReturn({ session_id: session_id }).then((result) => {\r\n      return {\r\n        status: result.data.payment_status,\r\n        amount: result.data.amount_total,\r\n        id: result.data.payment_intent || result.data.subscription,\r\n      };\r\n    });\r\n  }\r\n\r\n  async function addFoodTypeToSeller(type) {\r\n    if (type === \"Aucun\") return;\r\n    let newSeller = { ...seller };\r\n    let newFoodTypes = [];\r\n    if (seller.foodTypes === undefined) {\r\n      newFoodTypes.push(type);\r\n    } else {\r\n      newFoodTypes = seller.foodTypes;\r\n      newFoodTypes.push(type);\r\n    }\r\n    newSeller[\"foodTypes\"] = newFoodTypes;\r\n    await refSellers.doc(auth.currentUser.uid).update({\r\n      foodTypes: newFoodTypes,\r\n    });\r\n    setSeller(newSeller);\r\n  }\r\n\r\n  async function deleteFoodTypeToSeller(serviceID) {\r\n    const req = await refSellers\r\n      .doc(auth.currentUser.uid)\r\n      .collection(\"services\")\r\n      .doc(serviceID)\r\n      .get();\r\n    const data = req.data();\r\n    const type = data.foodType;\r\n\r\n    if (type === \"Aucun\") return;\r\n    let newSeller = { ...seller };\r\n    let newFoodTypes = [];\r\n    if (seller.foodTypes === undefined) return;\r\n    else {\r\n      newFoodTypes = seller.foodTypes;\r\n      let indexes = seller.foodTypes\r\n        .map((item, index) => (item === type ? index : \"\"))\r\n        .filter(String);\r\n      if (indexes[0] === -1) return;\r\n      else if (newFoodTypes.length > 1) {\r\n        newFoodTypes.splice(indexes[0], 1);\r\n      } else newFoodTypes = [];\r\n\r\n      newSeller[\"foodTypes\"] = newFoodTypes;\r\n      await refSellers.doc(auth.currentUser.uid).update({\r\n        foodTypes: newFoodTypes,\r\n      });\r\n      setSeller(newSeller);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <UserContext.Provider\r\n      value={{\r\n        login,\r\n        subscribe,\r\n        sellerSubscribe,\r\n        logout,\r\n        user,\r\n        seller,\r\n        event,\r\n        setUser,\r\n        setSeller,\r\n        addEvent,\r\n        addToCard,\r\n        getServiceQuantityInCard,\r\n        loadingButtonAddToCard,\r\n        setLoadingButtonAddToCard,\r\n        setCurrentStepProcess,\r\n        currentStepProcess,\r\n        formatLabelTimePicker,\r\n        getAuthUserFromHisEmail,\r\n        updateUserEmail,\r\n        updateQuantityService,\r\n        signInWithGoogle,\r\n        getCurrentUserProfil,\r\n        verifyLogin,\r\n        updateCurrentUserProfil,\r\n        addSellerDescription,\r\n        setImageSellerDB,\r\n        addSellerServices,\r\n        addOneSellerService,\r\n        getServicesOfCurrentSellerFromDB,\r\n        addSellerDocuments,\r\n        getSellerDocumentsFromDB,\r\n        setSellerStatus,\r\n        updateSellerDocumentsStatus,\r\n        getSellersInDbWithUids,\r\n        deleteOldSellerPicture,\r\n        addSalesInDB,\r\n        updateEventStatus,\r\n        getSalesOfEventIdFromDB,\r\n        clearEvent,\r\n        getSalesOfSellerIdFromDB,\r\n        getEventOfSaleFromDB,\r\n        formateToDate,\r\n        formateToDateWithWords,\r\n        updateSaleStatusInDB,\r\n        updateSaleNote,\r\n        addViewsOfSeller,\r\n        getViewsOfSeller,\r\n        isSellerAllowedToModifyAndDeleteService,\r\n        deleteServiceOfSeller,\r\n        updateSellerProfil,\r\n        getSellerReferralCountFromDB,\r\n        getEventFromUid,\r\n        getReviewsOfSellerUid,\r\n        addReviewOfSellerUid,\r\n        sendInBlue_sendNotificationToSellerOfReview,\r\n        sendInBlue_addContactToNewsletter,\r\n        sendInBlue_sendInvitations,\r\n        sendInBlue_sendRecapToUserAfterPayment,\r\n        sendInBlue_sendNewSaleToSeller,\r\n        sendInBlue_sendToParrainAboutNewReferral,\r\n        sendInBlue_sendPaymentRequestToAdmin,\r\n        getWishList,\r\n        deleteItemFromWishList,\r\n        addItemToWishListOfUser,\r\n        isSellerInWishListOfUser,\r\n        getEmailOfSellerWithUid,\r\n        checkoutStart,\r\n        getSaleTokenOfEventFromDb,\r\n        checkoutCheck,\r\n        getTotalAmountDueToSeller,\r\n        homeSellersDisplay,\r\n        setHomeSellersDisplay,\r\n        getWishListCountOfSeller,\r\n        getSellerPosition,\r\n        getSellersCount,\r\n        sendInBlue_sendBillRequestToAdmin,\r\n        addFoodTypeToSeller,\r\n        deleteFoodTypeToSeller,\r\n        isCardWidgetOpen,\r\n        setIsCardWidgetOpen,\r\n        checkoutSubscription,\r\n        refSellers,\r\n      }}\r\n    >\r\n      {!loading && children}\r\n    </UserContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}