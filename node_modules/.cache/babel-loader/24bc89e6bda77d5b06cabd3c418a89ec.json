{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bc/Desktop/New Nivid/Leo-Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bc/Desktop/New Nivid/Leo-Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/bc/Desktop/New Nivid/Leo-Project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import{useAuth}from\"../context/userContext\";// context\nimport{useDetectClickOutside}from\"react-detect-click-outside\";import{useHistory}from\"react-router-dom\";import{CSSTransition}from\"react-transition-group\";import ModalYesNo from\"./utilities/ModalYesNo\";import imgshooping from\"../images/shopping-bag.svg\";var CartWidget=function CartWidget(props){var isMobile=props.isMobile;var history=useHistory();var _useAuth=useAuth(),event=_useAuth.event,updateQuantityService=_useAuth.updateQuantityService,isCardWidgetOpen=_useAuth.isCardWidgetOpen,setIsCardWidgetOpen=_useAuth.setIsCardWidgetOpen;// context\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),choosedServices=_useState2[0],setChoosedServices=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),totalPrice=_useState4[0],setTotalPrice=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isModalOpened=_useState6[0],setIsModalOpened=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),currentServiceID=_useState8[0],setCurrentServiceID=_useState8[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:getChoosedServices().then(function(){getTotalPrice();});case 1:case\"end\":return _context.stop();}}},_callee);})));function handleDeleteClick(_x){return _handleDeleteClick.apply(this,arguments);}function _handleDeleteClick(){_handleDeleteClick=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setCurrentServiceID(id);setIsModalOpened(true);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _handleDeleteClick.apply(this,arguments);}function handleModalYesNoReturn(_x2){return _handleModalYesNoReturn.apply(this,arguments);}function _handleModalYesNoReturn(){_handleModalYesNoReturn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(val){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setIsModalOpened(false);if(!(val===\"no\")){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:handleDeleteService(currentServiceID);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return _handleModalYesNoReturn.apply(this,arguments);}function handleClickIcon(){return _handleClickIcon.apply(this,arguments);}function _handleClickIcon(){_handleClickIcon=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(isMobile){_context4.next=10;break;}if(!(isCardWidgetOpen===false)){_context4.next=7;break;}setIsCardWidgetOpen(true);_context4.next=5;return getChoosedServices().then(function(){getTotalPrice();});case 5:_context4.next=8;break;case 7:setIsCardWidgetOpen(false);case 8:_context4.next=11;break;case 10:history.push(\"/creer-mon-evenement/etape-3/panier\");case 11:case\"end\":return _context4.stop();}}},_callee4);}));return _handleClickIcon.apply(this,arguments);}function getChoosedServices(){return _getChoosedServices.apply(this,arguments);}function _getChoosedServices(){_getChoosedServices=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setChoosedServices(event.choosedServices);case 1:case\"end\":return _context5.stop();}}},_callee5);}));return _getChoosedServices.apply(this,arguments);}function getTotalPrice(){var total=0;choosedServices.forEach(function(service){var price=service.price;if(service.variations&&service.variations.length>0){price=service.variations.filter(function(vari){return vari.name===service.variation;})[0].price;}total+=price*service.quantity;});total=Number.parseFloat(total).toFixed(2);setTotalPrice(total);}function handleDeleteService(id){updateQuantityService(id,0);}function handleButtonRecap(){setIsCardWidgetOpen(false);history.push(\"/creer-mon-evenement/etape-3/panier\");}var ref=useDetectClickOutside({onTriggered:function onTriggered(){return setIsCardWidgetOpen(false);}});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{ref:ref,className:isMobile?\"CartWidgetContainer mobile\":\"CartWidgetContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return handleClickIcon();},className:isCardWidgetOpen?\"CartIconContainer active\":\"CartIconContainer\",children:[/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:imgshooping}),/*#__PURE__*/_jsx(\"span\",{children:choosedServices!==undefined&&choosedServices.length})]}),isCardWidgetOpen&&!isMobile&&/*#__PURE__*/_jsxs(\"div\",{className:\"wrapperContainer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"wrapperItemList\",children:choosedServices.map(function(service){return/*#__PURE__*/_jsxs(\"div\",{className:\"cartWrapperItem\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"imgCartWrapperItemContainer\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:service.images&&service.images[0].url})}),/*#__PURE__*/_jsxs(\"div\",{className:\"contentCartWrapperItemContainer\",children:[/*#__PURE__*/_jsx(\"span\",{children:service.variations&&service.variations.length>0?service.variations.filter(function(vari){return vari.name===service.variation;})[0].price+\"€\":service.price+\"€\"}),/*#__PURE__*/_jsx(\"p\",{children:service.name}),/*#__PURE__*/_jsx(\"p\",{children:service.variation}),/*#__PURE__*/_jsxs(\"p\",{children:[\"x \",service.quantity]}),/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return handleDeleteClick(service.uid);},className:\"deleteButtonCartWrapper\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:\"/images/trashRed.png\"})})]})]});})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cartWrapperBottom\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cartWrapperBottomTotalContainer\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Total: \",totalPrice,\"\\u20AC\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"cartWrapperBottomButtonContainer\",children:/*#__PURE__*/_jsx(\"button\",{disabled:choosedServices.length<1&&\"disabled\",onClick:function onClick(){return handleButtonRecap();},children:\"Voir panier\"})})]})]})]}),/*#__PURE__*/_jsx(CSSTransition,{in:isModalOpened,timeout:5000,classNames:\"pageTransition\",unmountOnExit:true,children:/*#__PURE__*/_jsx(ModalYesNo,{callback:function callback(val){return handleModalYesNoReturn(val);},value:\"\"})})]});};export default CartWidget;","map":{"version":3,"sources":["/Users/bc/Desktop/New Nivid/Leo-Project/src/components/CartWidget.js"],"names":["React","useEffect","useState","useAuth","useDetectClickOutside","useHistory","CSSTransition","ModalYesNo","CartWidget","props","isMobile","history","event","updateQuantityService","isCardWidgetOpen","setIsCardWidgetOpen","choosedServices","setChoosedServices","totalPrice","setTotalPrice","isModalOpened","setIsModalOpened","currentServiceID","setCurrentServiceID","getChoosedServices","then","getTotalPrice","handleDeleteClick","id","handleModalYesNoReturn","val","handleDeleteService","handleClickIcon","push","total","forEach","service","price","variations","length","filter","vari","name","variation","quantity","Number","parseFloat","toFixed","handleButtonRecap","ref","onTriggered","imgshooping","undefined","map","images","url","uid"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useAuth } from \"../context/userContext\"; // context\nimport { useDetectClickOutside } from \"react-detect-click-outside\";\nimport { useHistory } from \"react-router-dom\";\nimport { CSSTransition } from \"react-transition-group\";\nimport ModalYesNo from \"./utilities/ModalYesNo\";\nimport imgshooping from \"../images/shopping-bag.svg\";\n\nconst CartWidget = (props) => {\n  const isMobile = props.isMobile;\n  const history = useHistory();\n  const {\n    event,\n    updateQuantityService,\n    isCardWidgetOpen,\n    setIsCardWidgetOpen,\n  } = useAuth(); // context\n\n  const [choosedServices, setChoosedServices] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [isModalOpened, setIsModalOpened] = useState(false);\n  const [currentServiceID, setCurrentServiceID] = useState(\"\");\n\n  useEffect(async () => {\n    getChoosedServices().then(() => {\n      getTotalPrice();\n    });\n  });\n\n  async function handleDeleteClick(id) {\n    setCurrentServiceID(id);\n    setIsModalOpened(true);\n  }\n\n  async function handleModalYesNoReturn(val) {\n    setIsModalOpened(false);\n    if (val === \"no\") return;\n\n    handleDeleteService(currentServiceID);\n  }\n\n  async function handleClickIcon() {\n    if (!isMobile) {\n      if (isCardWidgetOpen === false) {\n        setIsCardWidgetOpen(true);\n        await getChoosedServices().then(() => {\n          getTotalPrice();\n        });\n      } else setIsCardWidgetOpen(false);\n    } else history.push(\"/creer-mon-evenement/etape-3/panier\");\n  }\n\n  async function getChoosedServices() {\n    setChoosedServices(event.choosedServices);\n  }\n\n  function getTotalPrice() {\n    let total = 0;\n    choosedServices.forEach((service) => {\n      let price = service.price;\n      if (service.variations && service.variations.length > 0) {\n        price = service.variations.filter(\n          (vari) => vari.name === service.variation\n        )[0].price;\n      }\n      total += price * service.quantity;\n    });\n    total = Number.parseFloat(total).toFixed(2);\n    setTotalPrice(total);\n  }\n\n  function handleDeleteService(id) {\n    updateQuantityService(id, 0);\n  }\n\n  function handleButtonRecap() {\n    setIsCardWidgetOpen(false);\n    history.push(\"/creer-mon-evenement/etape-3/panier\");\n  }\n\n  const ref = useDetectClickOutside({\n    onTriggered: () => setIsCardWidgetOpen(false),\n  });\n\n  return (\n    <>\n      <div\n        ref={ref}\n        className={\n          isMobile ? \"CartWidgetContainer mobile\" : \"CartWidgetContainer\"\n        }\n      >\n        <div\n          onClick={() => handleClickIcon()}\n          className={\n            isCardWidgetOpen ? \"CartIconContainer active\" : \"CartIconContainer\"\n          }\n        >\n          <img alt=\"\" src={imgshooping} />\n          <span>{choosedServices !== undefined && choosedServices.length}</span>\n        </div>\n        {isCardWidgetOpen && !isMobile && (\n          <div className=\"wrapperContainer\">\n            <div className=\"wrapperItemList\">\n              {choosedServices.map((service) => {\n                return (\n                  <div className=\"cartWrapperItem\">\n                    <div className=\"imgCartWrapperItemContainer\">\n                      <img\n                        alt=\"\"\n                        src={service.images && service.images[0].url}\n                      />\n                    </div>\n                    <div className=\"contentCartWrapperItemContainer\">\n                      <span>\n                        {service.variations && service.variations.length > 0\n                          ? service.variations.filter(\n                              (vari) => vari.name === service.variation\n                            )[0].price + \"€\"\n                          : service.price + \"€\"}\n                      </span>\n                      <p>{service.name}</p>\n                      <p>{service.variation}</p>\n                      <p>x {service.quantity}</p>\n                      <div\n                        onClick={() => handleDeleteClick(service.uid)}\n                        className=\"deleteButtonCartWrapper\"\n                      >\n                        <img alt=\"\" src=\"/images/trashRed.png\" />\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n\n            <div className=\"cartWrapperBottom\">\n              <div className=\"cartWrapperBottomTotalContainer\">\n                <p>Total: {totalPrice}€</p>\n              </div>\n              <div className=\"cartWrapperBottomButtonContainer\">\n                <button\n                  disabled={choosedServices.length < 1 && \"disabled\"}\n                  onClick={() => handleButtonRecap()}\n                >\n                  Voir panier\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n      <CSSTransition\n        in={isModalOpened}\n        timeout={5000}\n        classNames=\"pageTransition\"\n        unmountOnExit\n      >\n        <ModalYesNo callback={(val) => handleModalYesNoReturn(val)} value=\"\" />\n      </CSSTransition>\n    </>\n  );\n};\n\nexport default CartWidget;\n"]},"metadata":{},"sourceType":"module"}