{"ast":null,"code":"import _regeneratorRuntime from\"F:/My Project/Leo/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"F:/My Project/Leo/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"F:/My Project/Leo/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"F:/My Project/Leo/Nivid/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import{useFirebase}from\"../assets/base-context\";import ServiceDescription from\"../components/ServiceDescription\";import{useAuth}from\"../context/userContext\";// context\nimport{useParams}from\"react-router-dom\";import StickerBudgetLeft from\"../components/StickerBudgetLeft\";import{ButtonSmall}from\"../components/utilities/Buttons\";import Image from\"../components/utilities/Image\";import Loader from\"../components/Loader.js\";import{CSSTransition}from\"react-transition-group\";var SellerDetailProcess=function SellerDetailProcess(){var firebaseContext=useFirebase();var firestore=firebaseContext.firestore();var _useState=useState(),_useState2=_slicedToArray(_useState,2),details=_useState2[0],setDetails=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isWishList=_useState6[0],setIsWishList=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),currentPageOffer=_useState8[0],setCurrentPageOffer=_useState8[1];var _useState9=useState(window.innerWidth),_useState10=_slicedToArray(_useState9,2),windowsWidth=_useState10[0],setWindowsWidth=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),selectedService=_useState12[0],setSelectedService=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isSelectedServiceOpen=_useState14[0],setIsSelectedServiceOpen=_useState14[1];var _useAuth=useAuth(),addToCard=_useAuth.addToCard,setCurrentStepProcess=_useAuth.setCurrentStepProcess,addViewsOfSeller=_useAuth.addViewsOfSeller,addItemToWishListOfUser=_useAuth.addItemToWishListOfUser,isSellerInWishListOfUser=_useAuth.isSellerInWishListOfUser,setIsCardWidgetOpen=_useAuth.setIsCardWidgetOpen;// context\nvar _useParams=useParams(),sellerId=_useParams.sellerId;var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),animationLoaderDone=_useState16[0],setAnimationLoaderDone=_useState16[1];var refSellers=firestore.collection(\"sellers\");var isMobile=function isMobile(){return windowsWidth>1100?false:true;};var handleResize=function handleResize(width){return setWindowsWidth(width);};useEffect(function(){window.addEventListener(\"resize\",function(e){return handleResize(window.innerWidth);});setCurrentStepProcess(21);function getSellerDetailsFromDB(){refSellers.doc(sellerId).get().then(function(queryDetails){getSellerServicesFromDB(queryDetails.data());});}getSellerDetailsFromDB();addViewsOfSeller(sellerId);isSellerInWishListOfUser(sellerId).then(function(res){if(res===true)setIsWishList(true);});},[]);function getSellerServicesFromDB(_x){return _getSellerServicesFromDB.apply(this,arguments);}function _getSellerServicesFromDB(){_getSellerServicesFromDB=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var servicesArray,detailsArray,results;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:servicesArray=[];detailsArray=data;_context.next=4;return refSellers.doc(sellerId).collection(\"services\").get();case 4:results=_context.sent;results.forEach(function(doc){var newData=doc.data();if(newData.variations&&newData.variations.length>0)newData.price=newData.variations[0].price;servicesArray.push(_objectSpread(_objectSpread({},newData),{},{sellerId:sellerId,id:doc.id}));});detailsArray.services=servicesArray;setDetails(detailsArray);setLoading(false);case 9:case\"end\":return _context.stop();}}},_callee);}));return _getSellerServicesFromDB.apply(this,arguments);}function handlePaginationItem(val){var count=details.services.length;// 5 pour exemple\nvar maxPage=Math.ceil(count-windowsWidth/380);// 4\nif(val<=maxPage&&val>=0&&count-maxPage>=1)setCurrentPageOffer(val);}function handleServiceClicked(item){if(selectedService!==undefined&&item.id===selectedService.id)setIsSelectedServiceOpen(!isSelectedServiceOpen);else{setSelectedService(item);setIsSelectedServiceOpen(true);}}var handleCloseService=function handleCloseService(){return setIsSelectedServiceOpen(false);};function isButtonDisabled(val){var count=details.services.length;// 5 pour exemple\nvar maxPage=Math.ceil(count-windowsWidth/380);// 4\nreturn val<=maxPage&&val>=0&&count-maxPage>=1?null:\"disabled\";}function handleAddToCard(quantity,variation,note){var sellerID=sellerId;var item=_objectSpread({},selectedService);item.variation=variation;item.note=note;addToCard(sellerID,item,quantity);window.scrollTo(0,0);}function handleAddToWishList(_x2){return _handleAddToWishList.apply(this,arguments);}function _handleAddToWishList(){_handleAddToWishList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return addItemToWishListOfUser(id);case 2:setIsWishList(true);return _context2.abrupt(\"return\");case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _handleAddToWishList.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CSSTransition,{in:loading||!animationLoaderDone,timeout:300,classNames:\"pageTransition\",unmountOnExit:true,children:/*#__PURE__*/_jsx(\"div\",{className:\"pageTransition\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sellersDetailsContainer\",children:/*#__PURE__*/_jsx(Loader,{callBack:function callBack(){return setAnimationLoaderDone(true);}})})})}),/*#__PURE__*/_jsx(CSSTransition,{in:!loading&&animationLoaderDone,timeout:300,classNames:\"pageTransition\",unmountOnExit:true,children:!loading&&/*#__PURE__*/_jsx(\"div\",{className:\"pageTransition\",children:/*#__PURE__*/_jsxs(\"div\",{className:!isMobile()?\"sellersDetailsContainer\":\"sellersDetailsContainer mobile\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sellersDetailsHeader\",children:[!isMobile()&&/*#__PURE__*/_jsx(\"div\",{className:\"stickerBudgetLeft stickerBudgetDetailsHeader\",children:/*#__PURE__*/_jsx(StickerBudgetLeft,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"sellersHeaderImgContainer\",children:/*#__PURE__*/_jsx(Image,{url:details.image_path.url})}),/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:details.name}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(Image,{url:\"/images/orange_marker.png\"}),details.adress]}),isWishList?/*#__PURE__*/_jsx(\"span\",{children:\"Ajout\\xE9 \\xE0 votre WishList\"}):/*#__PURE__*/_jsx(ButtonSmall,{onClick:function onClick(){return handleAddToWishList(sellerId);},color:\"pink\",value:\"ajouter \\xE0 ma wishlist\",marginTop:\"20px\",icon:\"/images/heart.svg\"})]}),isMobile()&&/*#__PURE__*/_jsx(\"div\",{className:\"separatorServiceDetail\"}),/*#__PURE__*/_jsxs(\"div\",{className:!isMobile()?\"sellerDetailsServicesContainer\":\"sellerDetailsServicesContainer mobile\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"Offres du prestataire\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"offersListButtonContainer detailsServicesButtonContainer\",children:[/*#__PURE__*/_jsx(ButtonSmall,{onClick:function onClick(){return handlePaginationItem(currentPageOffer-1);},color:\"grey\",value:\"Pr\\xE9c\\xE9dent\",marginRight:\"20px\",disabled:isButtonDisabled(currentPageOffer-1)}),/*#__PURE__*/_jsx(ButtonSmall,{onClick:function onClick(){return handlePaginationItem(currentPageOffer+1);},color:\"grey\",value:\"Suivant\",disabled:isButtonDisabled(currentPageOffer+1)})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:-(currentPageOffer*380)},className:\"detailsServiceItemContainer\",children:Object.entries(details.services).map(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],item=_ref2[1];return/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){return handleServiceClicked(item);},className:selectedService!==undefined?selectedService.id!==item.id?\"notActive detailsServiceItem\":\"active detailsServiceItem\":\"detailsServiceItem\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"serviceItem\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"imgDetailsServiceItem\",children:/*#__PURE__*/_jsx(Image,{url:item.images[0].url})}),/*#__PURE__*/_jsxs(\"div\",{className:\"contentDetailsServiceItem\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:item.name}),/*#__PURE__*/_jsxs(\"p\",{children:[item.price,\"\\u20AC\"]}),/*#__PURE__*/_jsx(\"span\",{children:\"+ en savoir plus\"})]})]}),isMobile()&&/*#__PURE__*/_jsx(ServiceDescription,{handleCloseService:handleCloseService,isMobile:isMobile(),display:selectedService.id===item.id&&isSelectedServiceOpen?true:false,handleAddToCard:handleAddToCard,item:selectedService})]},key);})})]}),/*#__PURE__*/_jsx(\"div\",{children:!isMobile()&&/*#__PURE__*/_jsx(ServiceDescription,{handleCloseService:handleCloseService,handleAddToCard:handleAddToCard,item:selectedService,display:isSelectedServiceOpen})})]})})})]});};export default SellerDetailProcess;","map":{"version":3,"sources":["F:/My Project/Leo/Nivid/src/pages/SellerDetailProcess.js"],"names":["React","useEffect","useState","useFirebase","ServiceDescription","useAuth","useParams","StickerBudgetLeft","ButtonSmall","Image","Loader","CSSTransition","SellerDetailProcess","firebaseContext","firestore","details","setDetails","loading","setLoading","isWishList","setIsWishList","currentPageOffer","setCurrentPageOffer","window","innerWidth","windowsWidth","setWindowsWidth","selectedService","setSelectedService","isSelectedServiceOpen","setIsSelectedServiceOpen","addToCard","setCurrentStepProcess","addViewsOfSeller","addItemToWishListOfUser","isSellerInWishListOfUser","setIsCardWidgetOpen","sellerId","animationLoaderDone","setAnimationLoaderDone","refSellers","collection","isMobile","handleResize","width","addEventListener","e","getSellerDetailsFromDB","doc","get","then","queryDetails","getSellerServicesFromDB","data","res","servicesArray","detailsArray","results","forEach","newData","variations","length","price","push","id","services","handlePaginationItem","val","count","maxPage","Math","ceil","handleServiceClicked","item","undefined","handleCloseService","isButtonDisabled","handleAddToCard","quantity","variation","note","sellerID","scrollTo","handleAddToWishList","image_path","url","name","adress","marginLeft","Object","entries","map","key","images"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useFirebase } from \"../assets/base-context\";\r\nimport ServiceDescription from \"../components/ServiceDescription\";\r\nimport { useAuth } from \"../context/userContext\"; // context\r\nimport { useParams } from \"react-router-dom\";\r\nimport StickerBudgetLeft from \"../components/StickerBudgetLeft\";\r\n\r\nimport { ButtonSmall } from \"../components/utilities/Buttons\";\r\nimport Image from \"../components/utilities/Image\";\r\nimport Loader from \"../components/Loader.js\";\r\n\r\nimport { CSSTransition } from \"react-transition-group\";\r\n\r\nconst SellerDetailProcess = () => {\r\n  const firebaseContext = useFirebase();\r\n  const firestore = firebaseContext.firestore();\r\n\r\n  const [details, setDetails] = useState();\r\n  const [loading, setLoading] = useState(true);\r\n  const [isWishList, setIsWishList] = useState(false);\r\n  const [currentPageOffer, setCurrentPageOffer] = useState(0);\r\n  const [windowsWidth, setWindowsWidth] = useState(window.innerWidth);\r\n  const [selectedService, setSelectedService] = useState({});\r\n  const [isSelectedServiceOpen, setIsSelectedServiceOpen] = useState(false);\r\n\r\n  const {\r\n    addToCard,\r\n    setCurrentStepProcess,\r\n    addViewsOfSeller,\r\n    addItemToWishListOfUser,\r\n    isSellerInWishListOfUser,\r\n    setIsCardWidgetOpen,\r\n  } = useAuth(); // context\r\n  const { sellerId } = useParams();\r\n\r\n  const [animationLoaderDone, setAnimationLoaderDone] = useState(false);\r\n\r\n  const refSellers = firestore.collection(\"sellers\");\r\n\r\n  const isMobile = () => (windowsWidth > 1100 ? false : true);\r\n  const handleResize = (width) => setWindowsWidth(width);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", (e) => handleResize(window.innerWidth));\r\n    setCurrentStepProcess(21);\r\n\r\n    function getSellerDetailsFromDB() {\r\n      refSellers\r\n        .doc(sellerId)\r\n        .get()\r\n        .then((queryDetails) => {\r\n          getSellerServicesFromDB(queryDetails.data());\r\n        });\r\n    }\r\n\r\n    getSellerDetailsFromDB();\r\n    addViewsOfSeller(sellerId);\r\n\r\n    isSellerInWishListOfUser(sellerId).then((res) => {\r\n      if (res === true) setIsWishList(true);\r\n    });\r\n  }, []);\r\n\r\n  async function getSellerServicesFromDB(data) {\r\n    const servicesArray = [];\r\n    const detailsArray = data;\r\n    const results = await refSellers.doc(sellerId).collection(\"services\").get();\r\n    results.forEach((doc) => {\r\n      const newData = doc.data();\r\n      if (newData.variations && newData.variations.length > 0)\r\n        newData.price = newData.variations[0].price;\r\n      servicesArray.push({ ...newData, sellerId: sellerId, id: doc.id });\r\n    });\r\n    detailsArray.services = servicesArray;\r\n    setDetails(detailsArray);\r\n    setLoading(false);\r\n  }\r\n\r\n  function handlePaginationItem(val) {\r\n    const count = details.services.length; // 5 pour exemple\r\n    const maxPage = Math.ceil(count - windowsWidth / 380); // 4\r\n    if (val <= maxPage && val >= 0 && count - maxPage >= 1)\r\n      setCurrentPageOffer(val);\r\n  }\r\n\r\n  function handleServiceClicked(item) {\r\n    if (selectedService !== undefined && item.id === selectedService.id)\r\n      setIsSelectedServiceOpen(!isSelectedServiceOpen);\r\n    else {\r\n      setSelectedService(item);\r\n      setIsSelectedServiceOpen(true);\r\n    }\r\n  }\r\n\r\n\r\n  const handleCloseService = () => setIsSelectedServiceOpen(false)\r\n\r\n  function isButtonDisabled(val) {\r\n    const count = details.services.length; // 5 pour exemple\r\n    const maxPage = Math.ceil(count - windowsWidth / 380); // 4\r\n    return (val <= maxPage && val >= 0 && count - maxPage >= 1) ? null : \"disabled\"\r\n  }\r\n\r\n  function handleAddToCard(quantity, variation, note) {\r\n    const sellerID = sellerId;\r\n    let item = { ...selectedService };\r\n    item.variation = variation;\r\n    item.note = note;\r\n    addToCard(sellerID, item, quantity);\r\n    window.scrollTo(0, 0);\r\n  }\r\n\r\n  async function handleAddToWishList(id) {\r\n    await addItemToWishListOfUser(id);\r\n    setIsWishList(true);\r\n    return;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <CSSTransition\r\n        in={loading || !animationLoaderDone}\r\n        timeout={300}\r\n        classNames=\"pageTransition\"\r\n        unmountOnExit\r\n      >\r\n        <div className=\"pageTransition\">\r\n          <div className=\"sellersDetailsContainer\">\r\n            <Loader callBack={() => setAnimationLoaderDone(true)} />\r\n          </div>\r\n        </div>\r\n      </CSSTransition>\r\n\r\n      <CSSTransition\r\n        in={!loading && animationLoaderDone}\r\n        timeout={300}\r\n        classNames=\"pageTransition\"\r\n        unmountOnExit\r\n      >\r\n        {!loading && (\r\n          <div className=\"pageTransition\">\r\n            <div\r\n              className={\r\n                !isMobile()\r\n                  ? \"sellersDetailsContainer\"\r\n                  : \"sellersDetailsContainer mobile\"\r\n              }\r\n            >\r\n              <div className=\"sellersDetailsHeader\">\r\n                {!isMobile() && (\r\n                  <div className=\"stickerBudgetLeft stickerBudgetDetailsHeader\">\r\n                    <StickerBudgetLeft />\r\n                  </div>\r\n                )}\r\n                <div className=\"sellersHeaderImgContainer\">\r\n                  <Image url={details.image_path.url} />\r\n                </div>\r\n                <p className=\"title\">{details.name}</p>\r\n                <p>\r\n                  <Image url={\"/images/orange_marker.png\"} />\r\n                  {details.adress}\r\n                </p>\r\n                {isWishList ? (\r\n                  <span>Ajouté à votre WishList</span>\r\n                ) : (\r\n                  <ButtonSmall\r\n                    onClick={() => handleAddToWishList(sellerId)}\r\n                    color=\"pink\"\r\n                    value=\"ajouter à ma wishlist\"\r\n                    marginTop=\"20px\"\r\n                    icon=\"/images/heart.svg\"\r\n                  />\r\n                )}\r\n              </div>\r\n              {isMobile() && <div className=\"separatorServiceDetail\"></div>}\r\n              <div\r\n                className={\r\n                  !isMobile()\r\n                    ? \"sellerDetailsServicesContainer\"\r\n                    : \"sellerDetailsServicesContainer mobile\"\r\n                }\r\n              >\r\n                <p className=\"title\">Offres du prestataire</p>\r\n                <div className=\"offersListButtonContainer detailsServicesButtonContainer\">\r\n                  <ButtonSmall\r\n                    onClick={() => handlePaginationItem(currentPageOffer - 1)}\r\n                    color=\"grey\"\r\n                    value=\"Précédent\"\r\n                    marginRight=\"20px\"\r\n                    disabled={isButtonDisabled(currentPageOffer - 1)}\r\n                  />\r\n                  <ButtonSmall\r\n                    onClick={() => handlePaginationItem(currentPageOffer + 1)}\r\n                    color=\"grey\"\r\n                    value=\"Suivant\"\r\n                    disabled={isButtonDisabled(currentPageOffer + 1)}\r\n                  />\r\n                </div>\r\n                <div\r\n                  style={{ marginLeft: -(currentPageOffer * 380) }}\r\n                  className=\"detailsServiceItemContainer\"\r\n                >\r\n                  {Object.entries(details.services).map(([key, item]) => {\r\n                    return (\r\n                      <div\r\n                        onClick={() => handleServiceClicked(item)}\r\n                        className={\r\n                          selectedService !== undefined\r\n                            ? selectedService.id !== item.id\r\n                              ? \"notActive detailsServiceItem\"\r\n                              : \"active detailsServiceItem\"\r\n                            : \"detailsServiceItem\"\r\n                        }\r\n                        key={key}\r\n                      >\r\n                        <div className=\"serviceItem\">\r\n                          <div className=\"imgDetailsServiceItem\">\r\n                            <Image url={item.images[0].url} />\r\n                          </div>\r\n                          <div className=\"contentDetailsServiceItem\">\r\n                            <p className=\"title\">{item.name}</p>\r\n                            <p>{item.price}€</p>\r\n                            <span>+ en savoir plus</span>\r\n                          </div>\r\n                        </div>\r\n                        {isMobile() && (\r\n                          <ServiceDescription\r\n                            handleCloseService={handleCloseService}\r\n                            isMobile={isMobile()}\r\n                            display={\r\n                              selectedService.id === item.id &&\r\n                              isSelectedServiceOpen\r\n                                ? true\r\n                                : false\r\n                            }\r\n                            handleAddToCard={handleAddToCard}\r\n                            item={selectedService}\r\n                          />\r\n                        )}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                {!isMobile() && (\r\n                  <ServiceDescription\r\n                    handleCloseService={handleCloseService}\r\n                    handleAddToCard={handleAddToCard}\r\n                    item={selectedService}\r\n                    display={isSelectedServiceOpen}\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </CSSTransition>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SellerDetailProcess;\r\n"]},"metadata":{},"sourceType":"module"}