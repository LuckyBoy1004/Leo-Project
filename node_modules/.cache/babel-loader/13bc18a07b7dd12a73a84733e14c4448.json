{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Home\\\\Desktop\\\\Boulot\\\\Nivid\\\\src\\\\pages\\\\Prest_Step1.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport \"../styles/Prest_.css\";\nimport { useHistory } from 'react-router-dom';\nimport { useAuth } from \"../context/userContext\"; // context\n\nimport { ButtonSmall, ButtonLarge } from '../components/utilities/Buttons';\nimport Layout from '../components/utilities/Layout';\nimport Title from '../components/utilities/Title';\nimport SubTitle from '../components/utilities/SubTitle';\nimport { items } from '../components/servicesData';\nimport { useFirebase } from \"../assets/base-context\";\nimport ReactLoading from 'react-loading';\nimport { CSSTransition } from 'react-transition-group';\nimport { useParams } from 'react-router-dom';\n\nconst Prest_Step1 = () => {\n  _s();\n\n  const firebaseContext = useFirebase();\n  const storage = firebaseContext.storage();\n  const [error, setError] = useState({\n    type: \"\",\n    message: \"\"\n  });\n  const [buttonLoading, setButtonLoading] = useState(false);\n  const [isMounted, setIsMounted] = useState(false);\n  const session_id = new URLSearchParams(search).get('session_id');\n  const initialSellerDetails = {\n    description: \"\",\n    category: \"\",\n    subcategory: \"\",\n    image_path: \"\"\n  };\n  const initialPictures = {\n    name: \"\",\n    url: \"\",\n    lastModified: 0,\n    size: 0,\n    type: \"\",\n    webkitRelativePath: \"\"\n  };\n  const [sellerDetails, setSellerDetails] = useState(initialSellerDetails);\n  const [pictures, setPictures] = useState(initialPictures);\n  const {\n    setCurrentStepProcess,\n    setImageSellerDB,\n    addSellerDescription,\n    seller,\n    deleteOldSellerPicture,\n    checkoutCheck\n  } = useAuth(); // context\n\n  const history = useHistory();\n  seller.status !== \"subscribing\" && history.push('/mon-compte-partenaire');\n  setCurrentStepProcess(1);\n  useEffect(() => {\n    setSellerDetails({\n      description: seller.description,\n      category: seller.category,\n      subcategory: seller.subcategory,\n      image_path: seller.image_path\n    });\n    return setIsMounted(true);\n  }, []);\n  useEffect(() => {\n    console.log(session_id);\n    checkoutCheck(session_id).then(res => {\n      console.log(res); // return res.status === \"paid\" ? createSales(res.amount, res.id) : history.push('/dashboard')\n    });\n  }, []);\n\n  function handleCategoryChange(category, subcategory) {\n    if (category !== sellerDetails.category) {\n      setSellerDetails({ ...sellerDetails,\n        category: category,\n        subcategory: subcategory\n      });\n    }\n  }\n\n  function handleSubCategoryChange(key) {\n    if (key !== sellerDetails.subcategory) {\n      setSellerDetails({ ...sellerDetails,\n        subcategory: key\n      });\n    }\n  }\n\n  function handleChange(e) {\n    const type = e.target.files[0].type;\n    const size = e.target.files[0].size;\n\n    if (type !== \"image/png\" && type !== \"image/jpeg\" && type !== \"image/jpg\") {\n      setError({\n        type: \"imageType\",\n        message: \"Votre fichier n'est ni une image jpeg, jpg ou PNG.\"\n      });\n    } else if (size > 2000000) {\n      setError({\n        type: \"imageSize\",\n        message: \"Votre image fait plus de 2Mo.\"\n      });\n    } else {\n      setPictures(e.target.files[0]);\n      setSellerDetails({ ...sellerDetails,\n        image_path: {\n          url: URL.createObjectURL(e.target.files[0])\n        }\n      });\n      setError({\n        type: \"\",\n        message: \"\"\n      });\n    }\n  }\n\n  async function isFormValid() {\n    if (sellerDetails.description.length > 350) {\n      if (sellerDetails.category.length > 1 && sellerDetails.subcategory.length > 1) {\n        if (pictures.name && pictures.name.length > 0 || (sellerDetails.image_path && sellerDetails.image_path.url.length) > 0) {\n          return true;\n        } else {\n          setButtonLoading(false);\n          setError({\n            type: \"noImage\",\n            message: \"Vous devez ajouter une image.\"\n          });\n        }\n      } else {\n        setButtonLoading(false);\n        setError({\n          type: \"noCategory\",\n          message: \"Vous devez séléctionner votre secteur d'activité.\"\n        });\n      }\n    } else {\n      setButtonLoading(false);\n      setError({\n        type: \"description\",\n        message: \"Votre description doit faire au moins 350 caractères.\"\n      });\n    }\n  }\n\n  async function handleSendForm() {\n    setButtonLoading(true);\n    setError({\n      type: \"\",\n      message: \"\"\n    });\n    const valid = await isFormValid();\n\n    if (valid === true) {\n      let tokenAndUrl = {\n        url: \"\",\n        token: \"\"\n      }; // Si la photo est une nouvelle\n\n      if (pictures.name.length > 0) {\n        const token = Math.random().toString(36).substr(2, 19);\n        const url = await handleUploadFile(token);\n        await setImageSellerDB(url, token);\n        tokenAndUrl = {\n          url: url,\n          token: token\n        };\n        seller.image_path.url && deleteOldSellerPicture([seller.image_path.token]);\n      } else {\n        tokenAndUrl = sellerDetails.image_path; // Photo non changée\n      }\n\n      addSellerDescription(sellerDetails, tokenAndUrl).then(() => {\n        setPictures(initialPictures);\n        setSellerDetails({ ...sellerDetails,\n          image_path: tokenAndUrl\n        });\n        setButtonLoading(false);\n        history.push('/mon-compte-partenaire/process/services');\n      });\n    } else {\n      return;\n    }\n  }\n\n  async function handleUploadFile(token) {\n    return new Promise((resolve, reject) => {\n      const upload = storage.ref(`sellers/${token}`).put(pictures);\n      upload.on(\"state_changed\", snapshot => {}, error => {\n        console.log(error);\n      }, () => {\n        storage.ref(\"sellers\").child(token).getDownloadURL().then(url => {\n          resolve(url);\n        }).catch(error => {\n          console.error(error);\n          reject(error);\n        });\n      });\n    });\n  }\n\n  console.log(sellerDetails);\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: /*#__PURE__*/_jsxDEV(CSSTransition, {\n      in: isMounted,\n      timeout: 300,\n      classNames: \"pageTransition\",\n      unmountOnExit: true,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(SubTitle, {\n          value: \"Dites-nous en plus sur votre activit\\xE9\",\n          type: \"big\",\n          font: \"roboto-medium\",\n          align: \"left\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step1-Section1\",\n          children: [/*#__PURE__*/_jsxDEV(Title, {\n            value: \"Description de votre prestation\",\n            type: \"h2\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"D\\xE9crivez en d\\xE9tail votre entreprise : aussi bien les services que les produits propos\\xE9s afin de renseigner au mieux vos futurs clients. Notre \\xE9quipe de journalistes r\\xE9visera votre texte afin d'optimiser votre vitrine et vous permettre d'attirer le plus grand nombre de clients. Merci de ne pas inclure de page web, courrier \\xE9lectronique, num\\xE9ro de t\\xE9l\\xE9phone et autres coordonn\\xE9es de contact.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"textAreaContainer\",\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: sellerDetails.description,\n              onChange: e => setSellerDetails({ ...sellerDetails,\n                description: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: sellerDetails.description.length > 349 && \"valid\",\n              children: [sellerDetails.description.length, \"/350\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step1-Section2\",\n          children: [/*#__PURE__*/_jsxDEV(Title, {\n            value: \"S\\xE9lectionnez votre secteur d'activit\\xE9\",\n            type: \"h2\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"headerEtape2 Prest-category\",\n            children: [(sellerDetails.category === \"decorations\" || sellerDetails.category.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: sellerDetails.category === \"decorations\" ? \"category active\" : \"category\",\n              onClick: () => handleCategoryChange(\"decorations\", \"fleuristes\"),\n              children: /*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"D\\xE9corations\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 33\n            }, this), (sellerDetails.category === \"ambiance\" || sellerDetails.category.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: sellerDetails.category === \"ambiance\" ? \"category active\" : \"category\",\n              onClick: () => handleCategoryChange(\"ambiance\", \"spectacle\"),\n              children: /*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"Ambiance/Activit\\xE9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 33\n            }, this), (sellerDetails.category === \"nourriture\" || sellerDetails.category.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: sellerDetails.category === \"nourriture\" ? \"category active\" : \"category\",\n              onClick: () => handleCategoryChange(\"nourriture\", \"service\"),\n              children: /*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"Nourriture et boisson\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 33\n            }, this), sellerDetails.category.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"category button\",\n              children: /*#__PURE__*/_jsxDEV(\"h1\", {\n                onClick: () => setSellerDetails({ ...sellerDetails,\n                  category: \"\",\n                  subcategory: \"\"\n                }),\n                children: \"Modifier ma s\\xE9lection\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subHeaderEtape2 Prest-subCategory\",\n            children: sellerDetails.category.length > 1 && Object.entries(items[sellerDetails.category]).map(([key, item]) => {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: sellerDetails.subcategory === key ? \"subMenuItem active\" : \"subMenuItem\",\n                onClick: () => handleSubCategoryChange(key),\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  alt: \"\",\n                  src: item.icon\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: key\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 45\n                }, this)]\n              }, key, true, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 41\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step1-Section3\",\n          children: [/*#__PURE__*/_jsxDEV(Title, {\n            value: \"Photo principale\",\n            type: \"h2\",\n            font: \"roboto-medium\",\n            align: \"left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 25\n          }, this), (error.type === \"imageSize\" || error.type === \"imageType\") && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"errorMessage\",\n            children: error.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 88\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"De votre boutique ou bien de votre stand, quelque chose de repr\\xE9sentatif !\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"fileInputContainer\",\n            children: [sellerDetails.image_path.length === 0 && seller.image_path.length === 0 && /*#__PURE__*/_jsxDEV(\"label\", {\n              for: \"file\",\n              className: \"label-file\",\n              children: \"+\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              accept: \"image/jpeg, image/jpg, image/png\",\n              id: \"file\",\n              className: \"input-file\",\n              type: \"file\",\n              onChange: e => handleChange(e)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              alt: \"\",\n              src: sellerDetails.image_path.url || seller.image_path.url\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"fileInputRight\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"2Mo max.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Type de fichiers accept\\xE9s : jpeg, jpg, PNG\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(ButtonSmall, {\n                onClick: () => document.getElementById('file').click(),\n                color: sellerDetails.image_path.length === 0 ? \"grey\" : \"blue\",\n                value: sellerDetails.image_path.length === 0 ? \"Choisir une image\" : \"Changer d'image\",\n                marginTop: \"10px\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Prest-Step1-Section4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Attention: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 32\n              }, this), \"Merci de bien v\\xE9rifier toutes vos informations, celles-ci seront modifiables seulement si votre dossier est en attente de validation.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(ButtonLarge, {\n              onClick: () => handleSendForm(),\n              color: \"orange\",\n              value: buttonLoading ? /*#__PURE__*/_jsxDEV(ReactLoading, {\n                className: \"loadingSpinnerButton\",\n                type: \"spin\",\n                color: \"white\",\n                height: 23,\n                width: 23\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 312,\n                columnNumber: 56\n              }, this) : \"Passer à l'étape suivante\",\n              width: \"400px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 21\n        }, this), error.message.length > 1 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"PrestErrorMessage\",\n          children: error.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 50\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Prest_Step1, \"SKnbiEV61EL9OJ2JYH7oeUlfB1I=\", false, function () {\n  return [useFirebase, useAuth, useHistory];\n});\n\n_c = Prest_Step1;\nexport default Prest_Step1;\n\nvar _c;\n\n$RefreshReg$(_c, \"Prest_Step1\");","map":{"version":3,"sources":["C:/Users/Home/Desktop/Boulot/Nivid/src/pages/Prest_Step1.js"],"names":["React","useState","useEffect","useHistory","useAuth","ButtonSmall","ButtonLarge","Layout","Title","SubTitle","items","useFirebase","ReactLoading","CSSTransition","useParams","Prest_Step1","firebaseContext","storage","error","setError","type","message","buttonLoading","setButtonLoading","isMounted","setIsMounted","session_id","URLSearchParams","search","get","initialSellerDetails","description","category","subcategory","image_path","initialPictures","name","url","lastModified","size","webkitRelativePath","sellerDetails","setSellerDetails","pictures","setPictures","setCurrentStepProcess","setImageSellerDB","addSellerDescription","seller","deleteOldSellerPicture","checkoutCheck","history","status","push","console","log","then","res","handleCategoryChange","handleSubCategoryChange","key","handleChange","e","target","files","URL","createObjectURL","isFormValid","length","handleSendForm","valid","tokenAndUrl","token","Math","random","toString","substr","handleUploadFile","Promise","resolve","reject","upload","ref","put","on","snapshot","child","getDownloadURL","catch","value","Object","entries","map","item","icon","document","getElementById","click"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"../styles/Prest_.css\"\r\nimport { useHistory } from 'react-router-dom'\r\nimport { useAuth } from \"../context/userContext\"; // context\r\n\r\nimport { ButtonSmall, ButtonLarge } from '../components/utilities/Buttons'\r\nimport Layout from '../components/utilities/Layout'\r\nimport Title from '../components/utilities/Title'\r\nimport SubTitle from '../components/utilities/SubTitle'\r\nimport { items } from '../components/servicesData'\r\nimport { useFirebase } from \"../assets/base-context\";\r\nimport ReactLoading from 'react-loading';\r\nimport { CSSTransition } from 'react-transition-group'\r\nimport { useParams } from 'react-router-dom'\r\n\r\n\r\nconst Prest_Step1 = () => {\r\n    \r\n    const firebaseContext = useFirebase()\r\n    const storage = firebaseContext.storage()\r\n\r\n    const [error, setError] = useState({ type: \"\", message: \"\" });\r\n    const [buttonLoading, setButtonLoading] = useState(false)\r\n\r\n    const [isMounted, setIsMounted] = useState(false);\r\n\r\n\r\n    const session_id = new URLSearchParams(search).get('session_id')\r\n\r\n    const initialSellerDetails = {\r\n        description: \"\",\r\n        category: \"\",\r\n        subcategory: \"\",\r\n        image_path: \"\",\r\n    }\r\n\r\n    const initialPictures = {\r\n        name: \"\",\r\n        url: \"\",\r\n        lastModified: 0,\r\n        size: 0,\r\n        type: \"\",\r\n        webkitRelativePath: \"\"\r\n    }\r\n\r\n    const [sellerDetails, setSellerDetails] = useState(initialSellerDetails)\r\n\r\n    const [pictures, setPictures] = useState(initialPictures)\r\n\r\n    const { setCurrentStepProcess, setImageSellerDB, addSellerDescription, seller, deleteOldSellerPicture, checkoutCheck } = useAuth() // context\r\n    const history = useHistory()\r\n\r\n    seller.status !== \"subscribing\" && history.push('/mon-compte-partenaire')\r\n\r\n    setCurrentStepProcess(1)\r\n\r\n    useEffect(() => {\r\n        setSellerDetails({\r\n            description: seller.description,\r\n            category: seller.category,\r\n            subcategory: seller.subcategory,\r\n            image_path: seller.image_path,\r\n        })\r\n        return setIsMounted(true)\r\n    }, [])\r\n    \r\n    useEffect(() => {\r\n        console.log(session_id)\r\n        checkoutCheck(session_id)\r\n            .then(res => {\r\n                console.log(res)\r\n                // return res.status === \"paid\" ? createSales(res.amount, res.id) : history.push('/dashboard')\r\n            })\r\n    }, [])\r\n\r\n    function handleCategoryChange(category, subcategory) {\r\n        if (category !== sellerDetails.category) {\r\n            setSellerDetails({ ...sellerDetails, category: category, subcategory: subcategory })\r\n        }\r\n    }\r\n\r\n    function handleSubCategoryChange(key) {\r\n        if (key !== sellerDetails.subcategory) {\r\n            setSellerDetails({ ...sellerDetails, subcategory: key })\r\n        }\r\n    }\r\n\r\n    function handleChange(e) {\r\n        const type = e.target.files[0].type\r\n        const size = e.target.files[0].size\r\n        if (type !== \"image/png\" && type !== \"image/jpeg\" && type !== \"image/jpg\") {\r\n            setError({ type: \"imageType\", message: \"Votre fichier n'est ni une image jpeg, jpg ou PNG.\" })\r\n        }\r\n        else if (size > 2000000) {\r\n            setError({ type: \"imageSize\", message: \"Votre image fait plus de 2Mo.\" })\r\n        }\r\n        else {\r\n            setPictures(e.target.files[0])\r\n            setSellerDetails({ ...sellerDetails, image_path: { url: URL.createObjectURL(e.target.files[0]) } })\r\n            setError({ type: \"\", message: \"\" })\r\n        }\r\n    }\r\n\r\n    async function isFormValid() {\r\n        if (sellerDetails.description.length > 350) {\r\n            if (sellerDetails.category.length > 1 && sellerDetails.subcategory.length > 1) {\r\n                if ((pictures.name && pictures.name.length > 0) || (sellerDetails.image_path && sellerDetails.image_path.url.length) > 0) {\r\n                    return true\r\n                }\r\n                else {\r\n                    setButtonLoading(false)\r\n                    setError({ type: \"noImage\", message: \"Vous devez ajouter une image.\" })\r\n                }\r\n            }\r\n            else {\r\n                setButtonLoading(false)\r\n                setError({ type: \"noCategory\", message: \"Vous devez séléctionner votre secteur d'activité.\" })\r\n            }\r\n        }\r\n        else {\r\n            setButtonLoading(false)\r\n            setError({ type: \"description\", message: \"Votre description doit faire au moins 350 caractères.\" })\r\n        }\r\n    }\r\n\r\n    async function handleSendForm() {\r\n        setButtonLoading(true)\r\n        setError({ type: \"\", message: \"\" })\r\n        const valid = await isFormValid()\r\n        if (valid === true) {\r\n            let tokenAndUrl = { url: \"\", token: \"\" }\r\n\r\n            // Si la photo est une nouvelle\r\n            if (pictures.name.length > 0) {\r\n                const token = Math.random().toString(36).substr(2, 19)\r\n                const url = await handleUploadFile(token)\r\n                await setImageSellerDB(url, token)\r\n                tokenAndUrl = { url: url, token: token }\r\n                seller.image_path.url && deleteOldSellerPicture([seller.image_path.token])\r\n            } else {\r\n                tokenAndUrl = sellerDetails.image_path // Photo non changée\r\n            }\r\n\r\n            addSellerDescription(sellerDetails, tokenAndUrl).then(() => {\r\n                setPictures(initialPictures)\r\n                setSellerDetails({ ...sellerDetails, image_path: tokenAndUrl })\r\n                setButtonLoading(false)\r\n                history.push('/mon-compte-partenaire/process/services')\r\n            })\r\n        }\r\n        else {\r\n            return\r\n        }\r\n    }\r\n\r\n    async function handleUploadFile(token) {\r\n        return new Promise((resolve, reject) => {\r\n            const upload = storage.ref(`sellers/${token}`).put(pictures)\r\n            upload.on(\r\n                \"state_changed\", snapshot => { },\r\n                error => {\r\n                    console.log(error)\r\n                }, () => {\r\n                    storage\r\n                        .ref(\"sellers\")\r\n                        .child(token)\r\n                        .getDownloadURL()\r\n                        .then(url => {\r\n                            resolve(url);\r\n                        })\r\n                        .catch(error => {\r\n                            console.error(error)\r\n                            reject(error);\r\n                        })\r\n                }\r\n            )\r\n        })\r\n    }\r\n\r\n    console.log(sellerDetails)\r\n\r\n    return (\r\n        <Layout>\r\n            <CSSTransition\r\n                in={isMounted}\r\n                timeout={300}\r\n                classNames=\"pageTransition\"\r\n                unmountOnExit\r\n            >\r\n                <div>\r\n                    <SubTitle value=\"Dites-nous en plus sur votre activité\" type=\"big\" font=\"roboto-medium\" align=\"left\" />\r\n\r\n                    <div className=\"Prest-Step1-Section1\">\r\n                        <Title value=\"Description de votre prestation\" type=\"h2\" font=\"roboto-medium\" align=\"left\" />\r\n                        <p>Décrivez en détail votre entreprise : aussi bien les services que les produits proposés afin de renseigner au mieux vos futurs clients. Notre équipe de journalistes révisera votre texte afin d'optimiser votre vitrine et vous permettre d'attirer le plus grand nombre de clients. Merci de ne pas inclure de page web, courrier électronique, numéro de téléphone et autres coordonnées de contact.</p>\r\n                        <div className=\"textAreaContainer\">\r\n                            <textarea\r\n                                value={sellerDetails.description}\r\n                                onChange={(e) => setSellerDetails({ ...sellerDetails, description: e.target.value })}\r\n                            >\r\n\r\n                            </textarea>\r\n                            <span className={sellerDetails.description.length > 349 && \"valid\"}>{sellerDetails.description.length}/350</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"Prest-Step1-Section2\">\r\n                        <Title value=\"Sélectionnez votre secteur d'activité\" type=\"h2\" font=\"roboto-medium\" align=\"left\" />\r\n\r\n                        <div className=\"headerEtape2 Prest-category\">\r\n                            {\r\n                                (sellerDetails.category === \"decorations\" || sellerDetails.category.length === 0) &&\r\n                                <div\r\n                                    className={sellerDetails.category === \"decorations\" ? \"category active\" : \"category\"}\r\n                                    onClick={() => handleCategoryChange(\"decorations\", \"fleuristes\")}\r\n                                >\r\n                                    <h1>Décorations</h1>\r\n                                </div>\r\n                            }\r\n\r\n                            {\r\n                                (sellerDetails.category === \"ambiance\" || sellerDetails.category.length === 0) &&\r\n                                <div\r\n                                    className={sellerDetails.category === \"ambiance\" ? \"category active\" : \"category\"}\r\n                                    onClick={() => handleCategoryChange(\"ambiance\", \"spectacle\")}\r\n                                >\r\n                                    <h1>Ambiance/Activité</h1>\r\n                                </div>\r\n                            }\r\n\r\n                            {\r\n                                (sellerDetails.category === \"nourriture\" || sellerDetails.category.length === 0) &&\r\n                                <div\r\n                                    className={sellerDetails.category === \"nourriture\" ? \"category active\" : \"category\"}\r\n                                    onClick={() => handleCategoryChange(\"nourriture\", \"service\")}\r\n                                >\r\n                                    <h1>Nourriture et boisson</h1>\r\n                                </div>\r\n                            }\r\n\r\n                            {/* {\r\n                                (sellerDetails.category === \"service\" || sellerDetails.category.length === 0) &&\r\n                                <div\r\n                                    className={sellerDetails.category === \"service\" ? \"category active\" : \"category\"}\r\n                                    onClick={() => handleCategoryChange(\"service\", \"serveurs\")}\r\n                                >\r\n                                    <h1>Service sur place</h1>\r\n                                </div>\r\n                            } */}\r\n\r\n                            {\r\n                                sellerDetails.category.length > 0 &&\r\n                                <div className=\"category button\">\r\n                                    <h1\r\n                                        onClick={() => setSellerDetails({ ...sellerDetails, category: \"\", subcategory: \"\" })}\r\n                                    >\r\n                                        Modifier ma sélection\r\n                                    </h1>\r\n                                </div>\r\n                            }\r\n                        </div>\r\n\r\n                        <div className=\"subHeaderEtape2 Prest-subCategory\">\r\n                            {\r\n                                sellerDetails.category.length > 1 &&\r\n                                Object.entries(items[sellerDetails.category]).map(([key, item]) => {\r\n                                    return (\r\n                                        <div key={key} className={sellerDetails.subcategory === key ? \"subMenuItem active\" : \"subMenuItem\"} onClick={() => handleSubCategoryChange(key)}>\r\n                                            <img alt=\"\" src={item.icon} />\r\n                                            <p>{key}</p>\r\n                                        </div>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"Prest-Step1-Section3\">\r\n                        <Title value=\"Photo principale\" type=\"h2\" font=\"roboto-medium\" align=\"left\" />\r\n\r\n                        {(error.type === \"imageSize\" || error.type === \"imageType\") && <p className=\"errorMessage\">{error.message}</p>}\r\n\r\n                        <p>De votre boutique ou bien de votre stand, quelque chose de représentatif !</p>\r\n                        <div className=\"fileInputContainer\">\r\n                            {\r\n                                (sellerDetails.image_path.length === 0 && seller.image_path.length === 0) &&\r\n                                <label for=\"file\" className=\"label-file\">+</label>\r\n                            }\r\n                            <input accept=\"image/jpeg, image/jpg, image/png\" id=\"file\" className=\"input-file\" type=\"file\" onChange={(e) => handleChange(e)} />\r\n                            <img alt=\"\" src={sellerDetails.image_path.url || seller.image_path.url} />\r\n                            <div className=\"fileInputRight\">\r\n                                <p>2Mo max.</p>\r\n                                <p>Type de fichiers acceptés : jpeg, jpg, PNG</p>\r\n                                <ButtonSmall\r\n                                    onClick={() => document.getElementById('file').click()}\r\n                                    color={sellerDetails.image_path.length === 0 ? \"grey\" : \"blue\"}\r\n                                    value={sellerDetails.image_path.length === 0 ? \"Choisir une image\" : \"Changer d'image\"}\r\n                                    marginTop=\"10px\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"Prest-Step1-Section4\">\r\n                        <div>\r\n                            <p><span>Attention: </span>Merci de bien vérifier toutes vos informations, celles-ci seront modifiables seulement si votre dossier est en attente de validation.</p>\r\n                        </div>\r\n                        <div>\r\n                            <ButtonLarge\r\n                                onClick={() => handleSendForm()}\r\n                                color=\"orange\"\r\n                                value={buttonLoading ? <ReactLoading className=\"loadingSpinnerButton\" type=\"spin\" color=\"white\" height={23} width={23} /> : \"Passer à l'étape suivante\"}\r\n                                width=\"400px\"\r\n\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {error.message.length > 1 && <p className=\"PrestErrorMessage\">{error.message}</p>}\r\n                </div>\r\n            </CSSTransition>\r\n        </Layout>\r\n    )\r\n}\r\nexport default Prest_Step1;\r\n"]},"metadata":{},"sourceType":"module"}